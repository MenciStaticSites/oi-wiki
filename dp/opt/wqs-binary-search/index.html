<!doctype html><html class=no-js lang=zh-Hans><meta charset=utf-8><meta content=on http-equiv=x-dns-prefetch-control><link href=//oi-wiki.org rel=dns-prefetch><link href=//search.oi-wiki.org rel=dns-prefetch><link href=//api.github.com rel=dns-prefetch><link href=//www.google-analytics.com rel=dns-prefetch><meta content="width=device-width,initial-scale=1" name=viewport><meta content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛" name=description><meta content="OI Wiki Team" name=author><link href=https://oi-wiki.org/dp/opt/wqs-binary-search/ rel=canonical><link href=../slope-trick/ rel=prev><link href=../state/ rel=next><link href=../../../favicon.ico rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.6.15" name=generator><title>WQS 二分 - OI Wiki</title><link href=../../../assets/stylesheets/main.bd3167ff.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}@font-face{font-family:Fira Sans;font-style:normal;font-weight:300;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:italic;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot);src:local(Fira Sans),local(FiraSans-Italic),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans)format("svg")}@font-face{font-family:Fira Sans;font-style:normal;font-weight:700;src:url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot);src:local(Fira Sans),local(FiraSans-Normal),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans)format("svg")}@font-face{font-family:Fira Mono;font-style:normal;font-weight:regular;src:url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot);src:local(Fira Mono),local(FiraMono-Normal),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix)format("embedded-opentype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2)format("woff2"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff)format("woff"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf)format("truetype"),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono)format("svg")}</style><link href="../../../_static/css/extra.css?v=16" rel=stylesheet><link href="../../../assets/stylesheets/oiwiki-feedback-sys-frontend.css?v=202763fcae134a48bc639c9f3cde9d46" rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-124485594-1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-124485594-1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-124485594-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><script src=../../../assets/javascripts/toggle-sidebar.js></script><link href="../../../assets/stylesheets/mathjax.css?hash=3a31866bdf290e9a18e5ef5ef2db1d148311a09bf988a148b62a9d18c5f05294" rel=stylesheet></head><body data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#引入> 跳转至 </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=页眉><a aria-label="OI Wiki" class="md-header__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OI Wiki </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> WQS 二分 </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" data-md-color-media="(prefers-color-scheme: light)" class=md-option data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg></label><input aria-label="Switch to light mode" data-md-color-media="(prefers-color-scheme: dark)" class=md-option data-md-color-accent=blue data-md-color-primary=blue data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg></label><nav aria-label=查找 class=md-search__options><button class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1 title=清空当前内容 type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>正在初始化搜索引擎</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=标签 class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../../..> 简介 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../contest/> 比赛相关 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../tools/> 工具软件 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../lang/> 语言基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../basic/> 算法基础 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../search/> 搜索 </a></li><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../> 动态规划 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../string/> 字符串 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../math/> 数学 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../ds/> 数据结构 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../graph/> 图论 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../geometry/> 计算几何 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../misc/> 杂项 </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../../topic/rmq/> 专题 </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OI Wiki" class="md-nav__button md-logo" title="OI Wiki" data-md-component=logo href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"></path></svg> </a> OI Wiki</label><div class=md-nav__source><a class=md-source data-md-component=source href=https://github.com/OI-wiki/OI-wiki target=_blank title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg></div> <div class=md-source__repository>OI-wiki/OI-wiki</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_1 type=checkbox> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0><span class=md-ellipsis> 简介 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_1_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> 简介</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../..> <span class=md-ellipsis> Getting Started </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/about/> <span class=md-ellipsis> 关于本项目 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/htc/> <span class=md-ellipsis> 如何参与 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/what-oi-wiki-is-not/> <span class=md-ellipsis> OI Wiki 不是什么 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/format/> <span class=md-ellipsis> 格式手册 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/symbol/> <span class=md-ellipsis> 数学符号表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/faq/> <span class=md-ellipsis> F.A.Q. </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/mirrors/> <span class=md-ellipsis> 镜像站列表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../intro/thanks/> <span class=md-ellipsis> 致谢 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0><span class=md-ellipsis> 比赛相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span> 比赛相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/> <span class=md-ellipsis> 比赛相关简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_2 type=checkbox> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0><span class=md-ellipsis> 赛事 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_2><span class="md-nav__icon md-icon"></span> 赛事</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/oi/> <span class=md-ellipsis> OI 赛事与赛制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/icpc/> <span class=md-ellipsis> ICPC/CCPC 赛事与赛制 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_3 type=checkbox> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0><span class=md-ellipsis> 题型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_3><span class="md-nav__icon md-icon"></span> 题型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/problems/> <span class=md-ellipsis> 题型概述 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/interaction/> <span class=md-ellipsis> 交互题 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/roadmap/> <span class=md-ellipsis> 学习路线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/resources/> <span class=md-ellipsis> 学习资源 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_2_6 type=checkbox> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0><span class=md-ellipsis> 技巧 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_6><span class="md-nav__icon md-icon"></span> 技巧</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../contest/io/> <span class=md-ellipsis> 读入、输出优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/dictionary/> <span class=md-ellipsis> 分段打表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-mistakes/> <span class=md-ellipsis> 常见错误 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/common-tricks/> <span class=md-ellipsis> 常见技巧 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../contest/problemsetting/> <span class=md-ellipsis> 出题 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0><span class=md-ellipsis> 工具软件 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> 工具软件</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/> <span class=md-ellipsis> 工具软件简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_2 type=checkbox> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0><span class=md-ellipsis> 代码编辑工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_2><span class="md-nav__icon md-icon"></span> 代码编辑工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vim/> <span class=md-ellipsis> Vim </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/emacs/> <span class=md-ellipsis> Emacs </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/vscode/> <span class=md-ellipsis> VS Code </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/atom/> <span class=md-ellipsis> Atom </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/eclipse/> <span class=md-ellipsis> Eclipse </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/npp/> <span class=md-ellipsis> Notepad++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/kate/> <span class=md-ellipsis> Kate </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/devcpp/> <span class=md-ellipsis> Dev-C++ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/clion/> <span class=md-ellipsis> CLion </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/geany/> <span class=md-ellipsis> Geany </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/xcode/> <span class=md-ellipsis> Xcode </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/guide/> <span class=md-ellipsis> GUIDE </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/sublime/> <span class=md-ellipsis> Sublime Text </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/cpeditor/> <span class=md-ellipsis> CP Editor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/editor/codeblocks/> <span class=md-ellipsis> Code::Blocks </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_3 type=checkbox> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0><span class=md-ellipsis> 评测工具 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_3><span class="md-nav__icon md-icon"></span> 评测工具</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/> <span class=md-ellipsis> 评测工具简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/arbiter/> <span class=md-ellipsis> Arbiter </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/cena/> <span class=md-ellipsis> Cena </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/ccr-plus/> <span class=md-ellipsis> CCR Plus </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/judger/lemon/> <span class=md-ellipsis> Lemon </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/cmd/> <span class=md-ellipsis> 命令行 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compile-debug/> <span class=md-ellipsis> 命令行编译与调试 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/compiler/> <span class=md-ellipsis> 编译器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/wsl/> <span class=md-ellipsis> WSL (Windows 10) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/special-judge/> <span class=md-ellipsis> Special Judge </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_3_9 type=checkbox> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex=0><span class=md-ellipsis> Testlib </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_9><span class="md-nav__icon md-icon"></span> Testlib</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/> <span class=md-ellipsis> Testlib 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/general/> <span class=md-ellipsis> 通用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/generator/> <span class=md-ellipsis> Generator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/validator/> <span class=md-ellipsis> Validator </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/interactor/> <span class=md-ellipsis> Interactor </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/testlib/checker/> <span class=md-ellipsis> Checker </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/polygon/> <span class=md-ellipsis> Polygon </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/oj-tool/> <span class=md-ellipsis> OJ 工具 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/latex/> <span class=md-ellipsis> LaTeX 入门 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../tools/git/> <span class=md-ellipsis> Git </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0><span class=md-ellipsis> 语言基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span> 语言基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/> <span class=md-ellipsis> 语言基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2 type=checkbox> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0><span class=md-ellipsis> C++ 基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_2><span class="md-nav__icon md-icon"></span> C++ 基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/helloworld/> <span class=md-ellipsis> Hello, World! </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/basic/> <span class=md-ellipsis> C++ 语法基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/var/> <span class=md-ellipsis> 变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op/> <span class=md-ellipsis> 运算 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_5 type=checkbox> <label class=md-nav__link for=__nav_4_2_5 id=__nav_4_2_5_label tabindex=0><span class=md-ellipsis> 流程控制语句 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_5_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_5><span class="md-nav__icon md-icon"></span> 流程控制语句</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/branch/> <span class=md-ellipsis> 分支 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/loop/> <span class=md-ellipsis> 循环 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_2_6 type=checkbox> <label class=md-nav__link for=__nav_4_2_6 id=__nav_4_2_6_label tabindex=0><span class=md-ellipsis> 高级数据类型 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_2_6_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_2_6><span class="md-nav__icon md-icon"></span> 高级数据类型</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/array/> <span class=md-ellipsis> 数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/struct/> <span class=md-ellipsis> 结构体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/union/> <span class=md-ellipsis> 联合体 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pointer/> <span class=md-ellipsis> 指针 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/func/> <span class=md-ellipsis> 函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/file-op/> <span class=md-ellipsis> 文件操作 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3 type=checkbox> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0><span class=md-ellipsis> C++ 标准库 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_3><span class="md-nav__icon md-icon"></span> C++ 标准库</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/> <span class=md-ellipsis> C++ 标准库简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_3_2 type=checkbox> <label class=md-nav__link for=__nav_4_3_2 id=__nav_4_3_2_label tabindex=0><span class=md-ellipsis> STL 容器 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_3_2_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_3_2><span class="md-nav__icon md-icon"></span> STL 容器</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container/> <span class=md-ellipsis> STL 容器简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/iterator/> <span class=md-ellipsis> 迭代器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/sequence-container/> <span class=md-ellipsis> 序列式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/associative-container/> <span class=md-ellipsis> 关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/unordered-container/> <span class=md-ellipsis> 无序关联式容器 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/container-adapter/> <span class=md-ellipsis> 容器适配器 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/algorithm/> <span class=md-ellipsis> STL 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/bitset/> <span class=md-ellipsis> bitset </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/string/> <span class=md-ellipsis> string </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/csl/pair/> <span class=md-ellipsis> pair </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4 type=checkbox> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0><span class=md-ellipsis> C++ 进阶 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_4><span class="md-nav__icon md-icon"></span> C++ 进阶</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/class/> <span class=md-ellipsis> 类 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/namespace/> <span class=md-ellipsis> 命名空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/value-category/> <span class=md-ellipsis> 值类别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/op-overload/> <span class=md-ellipsis> 重载运算符 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/reference/> <span class=md-ellipsis> 引用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/const/> <span class=md-ellipsis> 常量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/new/> <span class=md-ellipsis> 新版 C++ 特性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/lambda/> <span class=md-ellipsis> Lambda 表达式 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_4_4_9 type=checkbox> <label class=md-nav__link for=__nav_4_4_9 id=__nav_4_4_9_label tabindex=0><span class=md-ellipsis> pb_ds </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_4_9_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_4_4_9><span class="md-nav__icon md-icon"></span> pb_ds</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/> <span class=md-ellipsis> pb_ds 简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/pq/> <span class=md-ellipsis> 堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pb-ds/tree/> <span class=md-ellipsis> 平衡树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/optimizations/> <span class=md-ellipsis> 编译优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/cpp-other-langs/> <span class=md-ellipsis> C++ 与其他常用语言的区别 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/pas-cpp/> <span class=md-ellipsis> Pascal 转 C++ 急救 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/python/> <span class=md-ellipsis> Python 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java/> <span class=md-ellipsis> Java 速成 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../lang/java-pro/> <span class=md-ellipsis> Java 进阶 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0><span class=md-ellipsis> 算法基础 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> 算法基础</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/> <span class=md-ellipsis> 算法基础简介 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_2 type=checkbox> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0><span class=md-ellipsis> 复杂度 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_2><span class="md-nav__icon md-icon"></span> 复杂度</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/complexity/> <span class=md-ellipsis> 复杂度简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/amortized-analysis/> <span class=md-ellipsis> 均摊复杂度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/enumerate/> <span class=md-ellipsis> 枚举 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/simulate/> <span class=md-ellipsis> 模拟 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/divide-and-conquer/> <span class=md-ellipsis> 递归 & 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/greedy/> <span class=md-ellipsis> 贪心 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_5_7 type=checkbox> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0><span class=md-ellipsis> 排序 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_5_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_5_7><span class="md-nav__icon md-icon"></span> 排序</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../basic/sort-intro/> <span class=md-ellipsis> 排序简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/selection-sort/> <span class=md-ellipsis> 选择排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bubble-sort/> <span class=md-ellipsis> 冒泡排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/insertion-sort/> <span class=md-ellipsis> 插入排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/counting-sort/> <span class=md-ellipsis> 计数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/radix-sort/> <span class=md-ellipsis> 基数排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/quick-sort/> <span class=md-ellipsis> 快速排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/merge-sort/> <span class=md-ellipsis> 归并排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/heap-sort/> <span class=md-ellipsis> 堆排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/bucket-sort/> <span class=md-ellipsis> 桶排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/shell-sort/> <span class=md-ellipsis> 希尔排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tournament-sort/> <span class=md-ellipsis> 锦标赛排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/tim-sort/> <span class=md-ellipsis> Tim 排序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/stl-sort/> <span class=md-ellipsis> 排序相关 STL </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/use-of-sort/> <span class=md-ellipsis> 排序应用 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/prefix-sum/> <span class=md-ellipsis> 前缀和 & 差分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary/> <span class=md-ellipsis> 二分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/binary-lifting/> <span class=md-ellipsis> 倍增 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../basic/construction/> <span class=md-ellipsis> 构造 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_6 type=checkbox> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0><span class=md-ellipsis> 搜索 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> 搜索</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../search/> <span class=md-ellipsis> 搜索部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dfs/> <span class=md-ellipsis> DFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bfs/> <span class=md-ellipsis> BFS（搜索） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/bidirectional/> <span class=md-ellipsis> 双向搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/heuristic/> <span class=md-ellipsis> 启发式搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/astar/> <span class=md-ellipsis> A* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/iterative/> <span class=md-ellipsis> 迭代加深搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/idastar/> <span class=md-ellipsis> IDA* </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/backtracking/> <span class=md-ellipsis> 回溯法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/dlx/> <span class=md-ellipsis> Dancing Links </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/alpha-beta/> <span class=md-ellipsis> Alpha–Beta 剪枝 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../search/opt/> <span class=md-ellipsis> 优化 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_7 type=checkbox> <label class=md-nav__link for=__nav_7 id=__nav_7_label><span class=md-ellipsis> 动态规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_7_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_7><span class="md-nav__icon md-icon"></span> 动态规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../> <span class=md-ellipsis> 动态规划部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../basic/> <span class=md-ellipsis> 动态规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../memo/> <span class=md-ellipsis> 记忆化搜索 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../knapsack/> <span class=md-ellipsis> 背包 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../interval/> <span class=md-ellipsis> 区间 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../dag/> <span class=md-ellipsis> DAG 上的 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../tree/> <span class=md-ellipsis> 树形 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../state/> <span class=md-ellipsis> 状压 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../number/> <span class=md-ellipsis> 数位 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../plug/> <span class=md-ellipsis> 插头 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../count/> <span class=md-ellipsis> 计数 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../dynamic/> <span class=md-ellipsis> 动态 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../probability/> <span class=md-ellipsis> 概率 DP </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../dp-of-dp/> <span class=md-ellipsis> DP 套 DP </span> </a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_7_15 type=checkbox> <label class=md-nav__link for=__nav_7_15 id=__nav_7_15_label tabindex=0><span class=md-ellipsis> DP 优化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_7_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_7_15><span class="md-nav__icon md-icon"></span> DP 优化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../dp-opt/> <span class=md-ellipsis> DP 优化简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../monotonous-queue-stack/> <span class=md-ellipsis> 单调队列/单调栈优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../slope/> <span class=md-ellipsis> 斜率优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../quadrangle/> <span class=md-ellipsis> 四边形不等式优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../slope-trick/> <span class=md-ellipsis> Slope Trick 优化 </span> </a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> WQS 二分 </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./> <span class=md-ellipsis> WQS 二分 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#传统方法> <span class=md-ellipsis> 传统方法 </span> </a> <nav aria-label=传统方法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#几何直观> <span class=md-ellipsis> 几何直观 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#共线情形的处理> <span class=md-ellipsis> 共线情形的处理 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#对偶方法> <span class=md-ellipsis> 对偶方法 </span> </a> <nav aria-label=对偶方法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#lagrange-对偶> <span class=md-ellipsis> Lagrange 对偶 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#凸共轭> <span class=md-ellipsis> 凸共轭 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#次梯度> <span class=md-ellipsis> 次梯度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#凸性证明> <span class=md-ellipsis> 凸性证明 </span> </a> <nav aria-label=凸性证明 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#归约为含参凸优化> <span class=md-ellipsis> 归约为含参凸优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#利用状态转移方程> <span class=md-ellipsis> 利用状态转移方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#四边形不等式> <span class=md-ellipsis> 四边形不等式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#交换论证> <span class=md-ellipsis> 交换论证 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#例题> <span class=md-ellipsis> 例题 </span> </a> <nav aria-label=例题 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#模板题目> <span class=md-ellipsis> 模板题目 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#区间分拆问题> <span class=md-ellipsis> 区间分拆问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#二维的限制条件> <span class=md-ellipsis> 二维的限制条件 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#更广泛的限制条件> <span class=md-ellipsis> 更广泛的限制条件 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../state/> <span class=md-ellipsis> 状态设计优化 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../misc/> <span class=md-ellipsis> 其它 DP 方法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8 type=checkbox> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0><span class=md-ellipsis> 字符串 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_8><span class="md-nav__icon md-icon"></span> 字符串</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/> <span class=md-ellipsis> 字符串部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/basic/> <span class=md-ellipsis> 字符串基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lib-func/> <span class=md-ellipsis> 标准库 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/match/> <span class=md-ellipsis> 字符串匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/hash/> <span class=md-ellipsis> 字符串哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/trie/> <span class=md-ellipsis> 字典树 (Trie) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/kmp/> <span class=md-ellipsis> 前缀函数与 KMP 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/bm/> <span class=md-ellipsis> Boyer–Moore 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/z-func/> <span class=md-ellipsis> Z 函数（扩展 KMP） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/ac-automaton/> <span class=md-ellipsis> AC 自动机 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_8_11 type=checkbox> <label class=md-nav__link for=__nav_8_11 id=__nav_8_11_label tabindex=0><span class=md-ellipsis> 后缀数组 (SA) </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_8_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_8_11><span class="md-nav__icon md-icon"></span> 后缀数组 (SA)</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../string/sa/> <span class=md-ellipsis> 后缀数组简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sa-optimal-inplace/> <span class=md-ellipsis> 最优原地后缀排序算法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../string/sam/> <span class=md-ellipsis> 后缀自动机 (SAM) </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-bst/> <span class=md-ellipsis> 后缀平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/general-sam/> <span class=md-ellipsis> 广义后缀自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/suffix-tree/> <span class=md-ellipsis> 后缀树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/manacher/> <span class=md-ellipsis> Manacher </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/pam/> <span class=md-ellipsis> 回文树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/seq-automaton/> <span class=md-ellipsis> 序列自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/minimal-string/> <span class=md-ellipsis> 最小表示法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/lyndon/> <span class=md-ellipsis> Lyndon 分解 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../string/main-lorentz/> <span class=md-ellipsis> Main–Lorentz 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9 type=checkbox> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0><span class=md-ellipsis> 数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_9><span class="md-nav__icon md-icon"></span> 数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/> <span class=md-ellipsis> 数学部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/base/> <span class=md-ellipsis> 进位制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/bit/> <span class=md-ellipsis> 位运算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/binary-set/> <span class=md-ellipsis> 二进制集合操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/balanced-ternary/> <span class=md-ellipsis> 平衡三进制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/bignum/> <span class=md-ellipsis> 高精度计算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/binary-exponentiation/> <span class=md-ellipsis> 快速幂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/permutation/> <span class=md-ellipsis> 置换和排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/coordinate/> <span class=md-ellipsis> 弧度制与坐标系 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/complex/> <span class=md-ellipsis> 复数 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_11 type=checkbox> <label class=md-nav__link for=__nav_9_11 id=__nav_9_11_label tabindex=0><span class=md-ellipsis> 数论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_11_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_11><span class="md-nav__icon md-icon"></span> 数论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/basic/> <span class=md-ellipsis> 数论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/mod-arithmetic/> <span class=md-ellipsis> 模算术简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/prime/> <span class=md-ellipsis> 素数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/gcd/> <span class=md-ellipsis> 最大公约数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/euler-totient/> <span class=md-ellipsis> 欧拉函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/sieve/> <span class=md-ellipsis> 筛法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/pollard-rho/> <span class=md-ellipsis> 分解质因数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/bezouts/> <span class=md-ellipsis> 裴蜀定理 & 一次不定方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/fermat/> <span class=md-ellipsis> 费马小定理 & 欧拉定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/inverse/> <span class=md-ellipsis> 模逆元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/linear-equation/> <span class=md-ellipsis> 线性同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/crt/> <span class=md-ellipsis> 中国剩余定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/lift-the-exponent/> <span class=md-ellipsis> 升幂引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/factorial/> <span class=md-ellipsis> 阶乘取模 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/lucas/> <span class=md-ellipsis> 卢卡斯定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/congruence-equation/> <span class=md-ellipsis> 同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/quad-residue/> <span class=md-ellipsis> 二次剩余 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/primitive-root/> <span class=md-ellipsis> 阶 & 原根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/discrete-logarithm/> <span class=md-ellipsis> 离散对数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/residue/> <span class=md-ellipsis> 高次剩余 & 单位根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/sqrt-decomposition/> <span class=md-ellipsis> 数论分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/dirichlet/> <span class=md-ellipsis> 狄利克雷卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/mobius/> <span class=md-ellipsis> 莫比乌斯反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/du/> <span class=md-ellipsis> 杜教筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/powerful-number/> <span class=md-ellipsis> Powerful Number 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/min-25/> <span class=md-ellipsis> Min_25 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/zhou/> <span class=md-ellipsis> 洲阁筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/euclidean/> <span class=md-ellipsis> 类欧几里德算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/meissel-lehmer/> <span class=md-ellipsis> Meissel–Lehmer 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/continued-fraction/> <span class=md-ellipsis> 连分数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/stern-brocot/> <span class=md-ellipsis> Stern–Brocot 树与 Farey 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/quadratic/> <span class=md-ellipsis> 二次域 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/number-theory/pell-equation/> <span class=md-ellipsis> Pell 方程 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_12 type=checkbox> <label class=md-nav__link for=__nav_9_12 id=__nav_9_12_label tabindex=0><span class=md-ellipsis> 多项式与生成函数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_12_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_12><span class="md-nav__icon md-icon"></span> 多项式与生成函数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/intro/> <span class=md-ellipsis> 多项式与生成函数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/fundamental/> <span class=md-ellipsis> 代数基本定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/fft/> <span class=md-ellipsis> 快速傅里叶变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/ntt/> <span class=md-ellipsis> 快速数论变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/fwt/> <span class=md-ellipsis> 快速沃尔什变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/czt/> <span class=md-ellipsis> Chirp Z 变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/newton/> <span class=md-ellipsis> 多项式牛顿迭代 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/multipoint-eval-interpolation/> <span class=md-ellipsis> 多项式多点求值|快速插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/elementary-func/> <span class=md-ellipsis> 多项式初等函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/linear-recurrence/> <span class=md-ellipsis> 常系数齐次线性递推 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/shift/> <span class=md-ellipsis> 多项式平移|连续点值平移 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/symbolic-method/> <span class=md-ellipsis> 符号化方法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/lagrange-inversion/> <span class=md-ellipsis> Lagrange 反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/comp-rev/> <span class=md-ellipsis> 形式幂级数复合|复合逆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/ogf/> <span class=md-ellipsis> 普通生成函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/poly/egf/> <span class=md-ellipsis> 指数生成函数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_13 type=checkbox> <label class=md-nav__link for=__nav_9_13 id=__nav_9_13_label tabindex=0><span class=md-ellipsis> 组合数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_13><span class="md-nav__icon md-icon"></span> 组合数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/combination/> <span class=md-ellipsis> 排列组合 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/drawer-principle/> <span class=md-ellipsis> 抽屉原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/inclusion-exclusion-principle/> <span class=md-ellipsis> 容斥原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/fibonacci/> <span class=md-ellipsis> 斐波那契数列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/derangement/> <span class=md-ellipsis> 错位排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/catalan/> <span class=md-ellipsis> 卡特兰数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/stirling/> <span class=md-ellipsis> 斯特林数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/bell/> <span class=md-ellipsis> 贝尔数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/bernoulli/> <span class=md-ellipsis> 伯努利数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/entringer/> <span class=md-ellipsis> Entringer Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/eulerian/> <span class=md-ellipsis> Eulerian Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/partition/> <span class=md-ellipsis> 分拆数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/vandermonde-convolution/> <span class=md-ellipsis> 范德蒙德卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/polya/> <span class=md-ellipsis> Pólya 计数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/combinatorics/graph-enumeration/> <span class=md-ellipsis> 图论计数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_14 type=checkbox> <label class=md-nav__link for=__nav_9_14 id=__nav_9_14_label tabindex=0><span class=md-ellipsis> 线性代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_14_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_14><span class="md-nav__icon md-icon"></span> 线性代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/> <span class=md-ellipsis> 线性代数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/vector/> <span class=md-ellipsis> 向量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/product/> <span class=md-ellipsis> 内积和外积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/matrix/> <span class=md-ellipsis> 矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/elementary-operations/> <span class=md-ellipsis> 初等变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/determinant/> <span class=md-ellipsis> 行列式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/vector-space/> <span class=md-ellipsis> 线性空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/basis/> <span class=md-ellipsis> 线性基 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/linear-mapping/> <span class=md-ellipsis> 线性映射 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/char-poly/> <span class=md-ellipsis> 特征多项式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/diagonalization/> <span class=md-ellipsis> 对角化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-algebra/jordan/> <span class=md-ellipsis> Jordan标准型 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_15 type=checkbox> <label class=md-nav__link for=__nav_9_15 id=__nav_9_15_label tabindex=0><span class=md-ellipsis> 线性规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_15><span class="md-nav__icon md-icon"></span> 线性规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/linear-programming/> <span class=md-ellipsis> 线性规划基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/simplex/> <span class=md-ellipsis> 单纯形法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_16 type=checkbox> <label class=md-nav__link for=__nav_9_16 id=__nav_9_16_label tabindex=0><span class=md-ellipsis> 抽象代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_16_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_16><span class="md-nav__icon md-icon"></span> 抽象代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/algebra/basic/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/algebra/group-theory/> <span class=md-ellipsis> 群论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/algebra/ring-theory/> <span class=md-ellipsis> 环论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/algebra/field-theory/> <span class=md-ellipsis> 域论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/algebra/schreier-sims/> <span class=md-ellipsis> Schreier–Sims 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_17 type=checkbox> <label class=md-nav__link for=__nav_9_17 id=__nav_9_17_label tabindex=0><span class=md-ellipsis> 概率论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_17><span class="md-nav__icon md-icon"></span> 概率论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/probability/basic-conception/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/probability/conditional-probability/> <span class=md-ellipsis> 条件概率与独立性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/probability/random-variable/> <span class=md-ellipsis> 随机变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/probability/exp-var/> <span class=md-ellipsis> 随机变量的数字特征 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/probability/concentration-inequality/> <span class=md-ellipsis> 概率不等式 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_18 type=checkbox> <label class=md-nav__link for=__nav_9_18 id=__nav_9_18_label tabindex=0><span class=md-ellipsis> 博弈论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_18><span class="md-nav__icon md-icon"></span> 博弈论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/game-theory/intro/> <span class=md-ellipsis> 博弈论简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/game-theory/impartial-game/> <span class=md-ellipsis> 公平组合游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/game-theory/zero-sum-game/> <span class=md-ellipsis> 零和游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/game-theory/partizan-game/> <span class=md-ellipsis> 非公平组合游戏 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_9_19 type=checkbox> <label class=md-nav__link for=__nav_9_19 id=__nav_9_19_label tabindex=0><span class=md-ellipsis> 数值算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_9_19_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_9_19><span class="md-nav__icon md-icon"></span> 数值算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../math/numerical/interp/> <span class=md-ellipsis> 插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/numerical/integral/> <span class=md-ellipsis> 数值积分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/numerical/gauss/> <span class=md-ellipsis> 高斯消元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/numerical/newton/> <span class=md-ellipsis> 牛顿迭代法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../math/order-theory/> <span class=md-ellipsis> 序理论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/young-tableau/> <span class=md-ellipsis> 杨氏矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/matroid/> <span class=md-ellipsis> 拟阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../math/berlekamp-massey/> <span class=md-ellipsis> Berlekamp–Massey 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10 type=checkbox> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0><span class=md-ellipsis> 数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_10><span class="md-nav__icon md-icon"></span> 数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/> <span class=md-ellipsis> 数据结构部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/stack/> <span class=md-ellipsis> 栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/queue/> <span class=md-ellipsis> 队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/linked-list/> <span class=md-ellipsis> 链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/hash/> <span class=md-ellipsis> 哈希表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_6 type=checkbox> <label class=md-nav__link for=__nav_10_6 id=__nav_10_6_label tabindex=0><span class=md-ellipsis> 并查集 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_6><span class="md-nav__icon md-icon"></span> 并查集</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu/> <span class=md-ellipsis> 并查集 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dsu-complexity/> <span class=md-ellipsis> 并查集复杂度 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_7 type=checkbox> <label class=md-nav__link for=__nav_10_7 id=__nav_10_7_label tabindex=0><span class=md-ellipsis> 堆 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_7_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_7><span class="md-nav__icon md-icon"></span> 堆</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/heap/> <span class=md-ellipsis> 堆简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/binary-heap/> <span class=md-ellipsis> 二叉堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pairing-heap/> <span class=md-ellipsis> 配对堆 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/leftist-tree/> <span class=md-ellipsis> 左偏树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_8 type=checkbox> <label class=md-nav__link for=__nav_10_8 id=__nav_10_8_label tabindex=0><span class=md-ellipsis> 块状数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_8_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_8><span class="md-nav__icon md-icon"></span> 块状数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/decompose/> <span class=md-ellipsis> 分块思想 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-array/> <span class=md-ellipsis> 块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/block-list/> <span class=md-ellipsis> 块状链表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/tree-decompose/> <span class=md-ellipsis> 树分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sqrt-tree/> <span class=md-ellipsis> Sqrt Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-stack/> <span class=md-ellipsis> 单调栈 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/monotonous-queue/> <span class=md-ellipsis> 单调队列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sparse-table/> <span class=md-ellipsis> ST 表 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/fenwick/> <span class=md-ellipsis> 树状数组 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_13 type=checkbox> <label class=md-nav__link for=__nav_10_13 id=__nav_10_13_label tabindex=0><span class=md-ellipsis> 线段树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_13><span class="md-nav__icon md-icon"></span> 线段树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg/> <span class=md-ellipsis> 线段树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-merge-split/> <span class=md-ellipsis> 线段树合并 & 分裂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/li-chao-tree/> <span class=md-ellipsis> 李超线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cat-tree/> <span class=md-ellipsis> 猫树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-beats/> <span class=md-ellipsis> 区间最值操作 & 区间历史最值 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/dividing/> <span class=md-ellipsis> 划分树 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_15 type=checkbox> <label class=md-nav__link for=__nav_10_15 id=__nav_10_15_label tabindex=0><span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_15><span class="md-nav__icon md-icon"></span> 二叉搜索树 & 平衡树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/bst/> <span class=md-ellipsis> 二叉搜索树 & 平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/treap/> <span class=md-ellipsis> Treap </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/splay/> <span class=md-ellipsis> Splay 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/wblt/> <span class=md-ellipsis> WBLT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sgt/> <span class=md-ellipsis> 替罪羊树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/cartesian-tree/> <span class=md-ellipsis> 笛卡尔树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/sbt/> <span class=md-ellipsis> Size Balanced Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/avl/> <span class=md-ellipsis> AVL 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/rbtree/> <span class=md-ellipsis> 红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/llrbt/> <span class=md-ellipsis> 左偏红黑树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/aa-tree/> <span class=md-ellipsis> AA 树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/skiplist/> <span class=md-ellipsis> 跳表 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_17 type=checkbox> <label class=md-nav__link for=__nav_10_17 id=__nav_10_17_label tabindex=0><span class=md-ellipsis> 可持久化数据结构 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_17><span class="md-nav__icon md-icon"></span> 可持久化数据结构</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent/> <span class=md-ellipsis> 可持久化数据结构简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-seg/> <span class=md-ellipsis> 可持久化线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-block-array/> <span class=md-ellipsis> 可持久化块状数组 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-balanced/> <span class=md-ellipsis> 可持久化平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-trie/> <span class=md-ellipsis> 可持久化字典树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/persistent-heap/> <span class=md-ellipsis> 可持久化可并堆 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_18 type=checkbox> <label class=md-nav__link for=__nav_10_18 id=__nav_10_18_label tabindex=0><span class=md-ellipsis> 树套树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_18><span class="md-nav__icon md-icon"></span> 树套树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-seg/> <span class=md-ellipsis> 线段树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-balanced/> <span class=md-ellipsis> 平衡树套线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/balanced-in-seg/> <span class=md-ellipsis> 线段树套平衡树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/seg-in-bit/> <span class=md-ellipsis> 树状数组套权值线段树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/bit-in-block-array/> <span class=md-ellipsis> 分块套树状数组 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/kdt/> <span class=md-ellipsis> K-D Tree </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_10_20 type=checkbox> <label class=md-nav__link for=__nav_10_20 id=__nav_10_20_label tabindex=0><span class=md-ellipsis> 动态树 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_10_20_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_10_20><span class="md-nav__icon md-icon"></span> 动态树</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../ds/lct/> <span class=md-ellipsis> Link Cut Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/global-bst/> <span class=md-ellipsis> 全局平衡二叉树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/ett/> <span class=md-ellipsis> Euler Tour Tree </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/top-tree/> <span class=md-ellipsis> Top Tree </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/divide-combine/> <span class=md-ellipsis> 析合树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/pq-tree/> <span class=md-ellipsis> PQ 树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/finger-tree/> <span class=md-ellipsis> 手指树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../ds/huffman-tree/> <span class=md-ellipsis> 霍夫曼树 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11 type=checkbox> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0><span class=md-ellipsis> 图论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_11><span class="md-nav__icon md-icon"></span> 图论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/> <span class=md-ellipsis> 图论部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/concept/> <span class=md-ellipsis> 图论相关概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/save/> <span class=md-ellipsis> 图的存储 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dfs/> <span class=md-ellipsis> DFS（图论） </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bfs/> <span class=md-ellipsis> BFS（图论） </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_6 type=checkbox> <label class=md-nav__link for=__nav_11_6 id=__nav_11_6_label tabindex=0><span class=md-ellipsis> 树上问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_6><span class="md-nav__icon md-icon"></span> 树上问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-basic/> <span class=md-ellipsis> 树基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-diameter/> <span class=md-ellipsis> 树的直径 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-center/> <span class=md-ellipsis> 树的中心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-centroid/> <span class=md-ellipsis> 树的重心 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lca/> <span class=md-ellipsis> 最近公共祖先 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hld/> <span class=md-ellipsis> 树链剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dsu-on-tree/> <span class=md-ellipsis> 树上启发式合并 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/virtual-tree/> <span class=md-ellipsis> 虚树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-divide/> <span class=md-ellipsis> 树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dynamic-tree-divide/> <span class=md-ellipsis> 动态树分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-ahu/> <span class=md-ellipsis> AHU 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-hash/> <span class=md-ellipsis> 树哈希 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/tree-random-walk/> <span class=md-ellipsis> 树上随机游走 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dag/> <span class=md-ellipsis> 有向无环图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/topo/> <span class=md-ellipsis> 拓扑排序 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_9 type=checkbox> <label class=md-nav__link for=__nav_11_9 id=__nav_11_9_label tabindex=0><span class=md-ellipsis> 最短路问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_9_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_9><span class="md-nav__icon md-icon"></span> 最短路问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/shortest-path/> <span class=md-ellipsis> 最短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/diff-constraints/> <span class=md-ellipsis> 差分约束 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/kth-path/> <span class=md-ellipsis> k 短路 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mod-shortest-path/> <span class=md-ellipsis> 同余最短路 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_10 type=checkbox> <label class=md-nav__link for=__nav_11_10 id=__nav_11_10_label tabindex=0><span class=md-ellipsis> 生成树问题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_10_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_10><span class="md-nav__icon md-icon"></span> 生成树问题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/mst/> <span class=md-ellipsis> 最小生成树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dmst/> <span class=md-ellipsis> 最小树形图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/mdst/> <span class=md-ellipsis> 最小直径生成树 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/steiner-tree/> <span class=md-ellipsis> 斯坦纳树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/node/> <span class=md-ellipsis> 拆点 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_13 type=checkbox> <label class=md-nav__link for=__nav_11_13 id=__nav_11_13_label tabindex=0><span class=md-ellipsis> 连通性相关 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_13><span class="md-nav__icon md-icon"></span> 连通性相关</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/scc/> <span class=md-ellipsis> 强连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bcc/> <span class=md-ellipsis> 双连通分量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/cut/> <span class=md-ellipsis> 割点和桥 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/block-forest/> <span class=md-ellipsis> 圆方树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/connectivity/> <span class=md-ellipsis> 点/边连通度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/rings-count/> <span class=md-ellipsis> 环计数问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/min-cycle/> <span class=md-ellipsis> 最小环 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/2-sat/> <span class=md-ellipsis> 2-SAT </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/euler/> <span class=md-ellipsis> 欧拉图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/hamilton/> <span class=md-ellipsis> 哈密顿图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/bi-graph/> <span class=md-ellipsis> 二分图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/planar/> <span class=md-ellipsis> 平面图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/chord/> <span class=md-ellipsis> 弦图 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/color/> <span class=md-ellipsis> 图的着色 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_23 type=checkbox> <label class=md-nav__link for=__nav_11_23 id=__nav_11_23_label tabindex=0><span class=md-ellipsis> 网络流 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_23_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_23><span class="md-nav__icon md-icon"></span> 网络流</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/> <span class=md-ellipsis> 网络流简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/max-flow/> <span class=md-ellipsis> 最大流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cut/> <span class=md-ellipsis> 最小割 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/min-cost/> <span class=md-ellipsis> 费用流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/flow/bound/> <span class=md-ellipsis> 上下界网络流 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/stoer-wagner/> <span class=md-ellipsis> Stoer–Wagner 算法 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_11_24 type=checkbox> <label class=md-nav__link for=__nav_11_24 id=__nav_11_24_label tabindex=0><span class=md-ellipsis> 图的匹配 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_11_24_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_11_24><span class="md-nav__icon md-icon"></span> 图的匹配</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/graph-match/> <span class=md-ellipsis> 图匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-match/> <span class=md-ellipsis> 二分图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/bigraph-weight-match/> <span class=md-ellipsis> 二分图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-match/> <span class=md-ellipsis> 一般图最大匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/general-weight-match/> <span class=md-ellipsis> 一般图最大权匹配 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-matching/stable-match/> <span class=md-ellipsis> 稳定匹配 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/prufer/> <span class=md-ellipsis> Prüfer 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/matrix-tree/> <span class=md-ellipsis> 矩阵树定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/lgv/> <span class=md-ellipsis> LGV 引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/max-clique/> <span class=md-ellipsis> 最大团搜索算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/dominator-tree/> <span class=md-ellipsis> 支配树 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../graph/graph-random-walk/> <span class=md-ellipsis> 图上随机游走 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_12 type=checkbox> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0><span class=md-ellipsis> 计算几何 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_12_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_12><span class="md-nav__icon md-icon"></span> 计算几何</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../geometry/> <span class=md-ellipsis> 计算几何部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/2d/> <span class=md-ellipsis> 二维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/3d/> <span class=md-ellipsis> 三维计算几何基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/distance/> <span class=md-ellipsis> 距离 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/pick/> <span class=md-ellipsis> Pick 定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/triangulation/> <span class=md-ellipsis> 三角剖分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/convex-hull/> <span class=md-ellipsis> 凸包 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/scanning/> <span class=md-ellipsis> 扫描线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/rotating-calipers/> <span class=md-ellipsis> 旋转卡壳 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/half-plane/> <span class=md-ellipsis> 半平面交 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/nearest-points/> <span class=md-ellipsis> 平面最近点对 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/random-incremental/> <span class=md-ellipsis> 随机增量法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/inverse/> <span class=md-ellipsis> 反演变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../geometry/misc/> <span class=md-ellipsis> 计算几何杂项 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13 type=checkbox> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0><span class=md-ellipsis> 杂项 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_13><span class="md-nav__icon md-icon"></span> 杂项</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/> <span class=md-ellipsis> 杂项简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/discrete/> <span class=md-ellipsis> 离散化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/two-pointer/> <span class=md-ellipsis> 双指针 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4 type=checkbox> <label class=md-nav__link for=__nav_13_4 id=__nav_13_4_label tabindex=0><span class=md-ellipsis> 离线算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_4><span class="md-nav__icon md-icon"></span> 离线算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/offline/> <span class=md-ellipsis> 离线算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cdq-divide/> <span class=md-ellipsis> CDQ 分治 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/parallel-binsearch/> <span class=md-ellipsis> 整体二分 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_4_4 type=checkbox> <label class=md-nav__link for=__nav_13_4_4 id=__nav_13_4_4_label tabindex=0><span class=md-ellipsis> 莫队算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_4_4_label class=md-nav data-md-level=3><label class=md-nav__title for=__nav_13_4_4><span class="md-nav__icon md-icon"></span> 莫队算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-intro/> <span class=md-ellipsis> 莫队算法简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo/> <span class=md-ellipsis> 普通莫队算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/modifiable-mo-algo/> <span class=md-ellipsis> 带修改莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-on-tree/> <span class=md-ellipsis> 树上莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rollback-mo-algo/> <span class=md-ellipsis> 回滚莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-2dimen/> <span class=md-ellipsis> 二维莫队 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-secondary-offline/> <span class=md-ellipsis> 莫队二次离线 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/mo-algo-with-bitset/> <span class=md-ellipsis> 莫队配合 bitset </span> </a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/frac-programming/> <span class=md-ellipsis> 分数规划 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_13_6 type=checkbox> <label class=md-nav__link for=__nav_13_6 id=__nav_13_6_label tabindex=0><span class=md-ellipsis> 随机化 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_13_6_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_13_6><span class="md-nav__icon md-icon"></span> 随机化</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../misc/random/> <span class=md-ellipsis> 随机函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/rand-technique/> <span class=md-ellipsis> 随机化技巧 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hill-climbing/> <span class=md-ellipsis> 爬山算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/simulated-annealing/> <span class=md-ellipsis> 模拟退火 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/hoverline/> <span class=md-ellipsis> 悬线法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/fsm/> <span class=md-ellipsis> 有限状态自动机 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/cc-basic/> <span class=md-ellipsis> 计算理论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/endianness/> <span class=md-ellipsis> 字节顺序 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/josephus/> <span class=md-ellipsis> 约瑟夫问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/gray-code/> <span class=md-ellipsis> 格雷码 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/expression/> <span class=md-ellipsis> 表达式求值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/job-order/> <span class=md-ellipsis> 在一台机器上规划任务 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/main-element/> <span class=md-ellipsis> 主元素问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/garsia-wachs/> <span class=md-ellipsis> Garsia–Wachs 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/15-puzzle/> <span class=md-ellipsis> 15-puzzle </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/kahan-summation/> <span class=md-ellipsis> Kahan 求和 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/odt/> <span class=md-ellipsis> 珂朵莉树/颜色段均摊 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../misc/space-optimization/> <span class=md-ellipsis> 空间优化简介 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle" id=__nav_14 type=checkbox> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0><span class=md-ellipsis> 专题 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_14_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_14><span class="md-nav__icon md-icon"></span> 专题</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../topic/rmq/> <span class=md-ellipsis> RMQ </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/dsu-app/> <span class=md-ellipsis> 并查集应用 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/bracket/> <span class=md-ellipsis> 括号序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../../topic/segment-tree-offline/> <span class=md-ellipsis> 线段树与离线询问 </span> </a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#引入> <span class=md-ellipsis> 引入 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#传统方法> <span class=md-ellipsis> 传统方法 </span> </a> <nav aria-label=传统方法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#几何直观> <span class=md-ellipsis> 几何直观 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#共线情形的处理> <span class=md-ellipsis> 共线情形的处理 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#对偶方法> <span class=md-ellipsis> 对偶方法 </span> </a> <nav aria-label=对偶方法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#lagrange-对偶> <span class=md-ellipsis> Lagrange 对偶 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#凸共轭> <span class=md-ellipsis> 凸共轭 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#次梯度> <span class=md-ellipsis> 次梯度 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#凸性证明> <span class=md-ellipsis> 凸性证明 </span> </a> <nav aria-label=凸性证明 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#归约为含参凸优化> <span class=md-ellipsis> 归约为含参凸优化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#利用状态转移方程> <span class=md-ellipsis> 利用状态转移方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#四边形不等式> <span class=md-ellipsis> 四边形不等式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#交换论证> <span class=md-ellipsis> 交换论证 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#例题> <span class=md-ellipsis> 例题 </span> </a> <nav aria-label=例题 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#模板题目> <span class=md-ellipsis> 模板题目 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#区间分拆问题> <span class=md-ellipsis> 区间分拆问题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#二维的限制条件> <span class=md-ellipsis> 二维的限制条件 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#更广泛的限制条件> <span class=md-ellipsis> 更广泛的限制条件 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#习题> <span class=md-ellipsis> 习题 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料与注释> <span class=md-ellipsis> 参考资料与注释 </span> </a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://oi-wiki.org/edit-landing/?ref=/dp/opt/wqs-binary-search.md" rel=edit title=编辑此页> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a><h1>WQS 二分</h1><h2 data-original-document-end=5 data-original-document-start=0 id=引入>引入<a title="Permanent link" class=headerlink href=#引入></a></h2><p data-original-document-end=125 data-original-document-start=7>本文介绍利用 WQS 二分优化动态规划问题的方法。在不同的文章中，它也常称作带权二分、凸优化 DP、凸完全单调性 DP、Lagrange 乘子法等，在国外也称作 Aliens Trick。它最早由王钦石在《浅析一类二分方法》一文中总结。</p><p data-original-document-end=188 data-original-document-start=127>WQS 二分通常用于解决这样一类优化问题：它们带有数量限制，直接求解代价较高；但一旦去除这一限制，问题本身就变得容易得多。</p><p data-original-document-end=353 data-original-document-start=190>比如，假设要解决的问题是，要从 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个物品中选取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 个，并最优化某个较复杂的目标函数。如果设从前 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个物品中选取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 个，目标函数的最优值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container>，那么原问题的答案就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(n,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(n,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(n,m)></mjx-container>。这类问题中，状态转移方程通常是二维的。直接实现该状态转移方程，时间复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(nm)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(nm) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(nm)></mjx-container> 的，难以接受。</p><p data-original-document-end=744 data-original-document-start=355>进一步假设，没有数量限制的最优化问题容易解决。但是，选取到的最优数量未必满足原问题的数量限制。假设选取的物品过多。那么，就可以考虑在选取物品时，为每个选取到的物品都附加一个固定大小的惩罚 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>（即「带权二分」中的「权」），仍然解没有数量限制的最优化问题。根据 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 的取值不同，选取到的最优数量也会有所不同；而且，随着 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 的变化，选取到的最优数量也是单调变化的。所以，可以通过二分，找到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 使得选取到的最优数量恰为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container>。假设此时目标函数的最优值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f_k(n)><mjx-msub data-latex=f_k><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f_k(n) xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=f_k><mi data-latex=f>f</mi><mi data-latex=k>k</mi></msub><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f_k(n)></mjx-container>，那么，只要消除额外附加的惩罚造成的价值损失，就能得到原问题的答案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(n,m)=f_k(n)+km" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=f_k space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-mi data-latex=k size=s><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=k space=3><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(n,m)=f_k(n)+km" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msub data-latex=f_k><mi data-latex=f>f</mi><mi data-latex=k>k</mi></msub><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=k>k</mi><mi data-latex=m>m</mi></math></mjx-assistive-mml><img title="f(n,m)=f_k(n)+km" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。假设单次求解附加惩罚的问题的复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(T(n))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(T(n)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=T>T</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(T(n))></mjx-container> 的，那么，算法的整体复杂度也就降低到了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(T(n)\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(T(n)\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=T>T</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(T(n)\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是二分 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 需要的次数。</p><p data-original-document-end=871 data-original-document-start=746>这就是 WQS 二分的基本想法。但是，这一想法能够行得通，前提是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(n,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(n,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(n,m)></mjx-container> 关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 是凸的。否则，可能不存在使得最优数量恰为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的附加惩罚 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>。这也是这种 DP 优化方法常常称为「凸优化 DP」或「凸完全单调性 DP」的原因。</p><h2 data-original-document-end=880 data-original-document-start=873 id=传统方法>传统方法<a title="Permanent link" class=headerlink href=#传统方法></a></h2><p data-original-document-end=1018 data-original-document-start=882>设非空集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 为（有限的）决策空间，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:X\rightarrow\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:X\rightarrow\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><mi data-latex=X>X</mi><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="f:X\rightarrow\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为目标函数，且另有函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g:X\rightarrow\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g:X\rightarrow\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=:>:</mo><mi data-latex=X>X</mi><mo data-latex=\rightarrow stretchy=false>→</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="g:X\rightarrow\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 用于施加限制。需要求解的问题，可以看作是计算如下最优化问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 在某处的取值：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
v(y)=\min_{x\in X}\;&f(x)\\
\text{subject to }&g(x)=y.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
v(y)=\min_{x\in X}\;&f(x)\\
\text{subject to }&g(x)=y.
\end{aligned}
" data-latex-item={aligned} style=min-width:8.96em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mtext data-latex="\text{subject to }"><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}v(y)=\min_{x\in X}\;&f(x)\\\text{subject to }&g(x)=y.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}v(y)=\min_{x\in X}\;&f(x)\\\text{subject to }&g(x)=y.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mspace data-latex=\; width=0.278em></mspace></mtd><mtd><mstyle indentshift=2em><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd><mtext data-latex="\text{subject to }">subject to </mtext></mtd><mtd><mstyle indentshift=2em><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
v(y)=\min_{x\in X}\;&f(x)\\
\text{subject to }&g(x)=y.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1243 data-original-document-start=1112>比如，对于前文提到的限制数量的问题，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 可以理解为所有物品集合的子集族，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in X" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in X" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></math></mjx-assistive-mml><img title="x\in X" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是单个子集，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 是单个子集的价值函数，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)></mjx-container> 是子集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 中的元素个数。当然，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)></mjx-container> 并非只能是数量限制，后文提供了更为广泛的限制条件的例子。</p><details class=info data-original-document-end=1374 data-original-document-start=1245 open><summary>约定</summary> <p>为了行文方便，本文仅讨论最小化目标函数的问题。最大化目标函数的问题与之相仿，只是需要将本文中的（下）凸函数相应地替换成凹函数（或称上凸函数）。或者，可以通过添加负号，将最大化目标函数的问题，转化为最小化它的相反数的问题。</p></details><h3 data-original-document-end=1384 data-original-document-start=1376 id=几何直观>几何直观<a title="Permanent link" class=headerlink href=#几何直观></a></h3><p data-original-document-end=1440 data-original-document-start=1386>因为算法竞赛中遇到的大多数问题都是组合优化问题，决策空间 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 通常没有良好的结构，所以，可以转而考察集合</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\mathcal D = \{(g(x),f(x))\in\mathbf R\times\mathbf R^d:x\in X\}.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=\times space=3><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=3><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.413em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=: space=4><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\mathcal D = \{(g(x),f(x))\in\mathbf R\times\mathbf R^d:x\in X\}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\times>×</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=:>:</mo><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\mathcal D = \{(g(x),f(x))\in\mathbf R\times\mathbf R^d:x\in X\}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=1581 data-original-document-start=1515>传统方法能够解决的主要是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="d=1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="d=1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="d=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形，即只有一个限制的情形。下图提供了此时点集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的一种可能的图示。</p><p data-original-document-end=1633 data-original-document-start=1583><img alt src=../../images/wqs-binary-search/wqs-f-g-space.svg></p><p data-original-document-end=1780 data-original-document-start=1635>图中的红点和蓝点是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 中所有可能的选择投影在平面 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(g(x),f(x))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(g(x),f(x)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(g(x),f(x))></mjx-container> 上得到的集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。于是，原问题所要求的就是横坐标为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 的那些点中，纵坐标的最小值 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container>。当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 变动时，所有这样的点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y,v(y))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y,v(y)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y,v(y))></mjx-container> 就构成了图中的红点的集合。</p><p data-original-document-end=1974 data-original-document-start=1782>为了求得点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y,v(y))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y,v(y)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y,v(y))></mjx-container> 的纵坐标，可以考虑用斜率为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda\in\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda\in\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="\lambda\in\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的直线去切集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。如图所示，当直线的斜率选取得恰当时，经过点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y,v(y))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y,v(y)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y,v(y))></mjx-container> 的那条直线，是所有经过集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 中的点且斜率为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的直线中，截距 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)-\lambda g(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)-\lambda g(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x)-\lambda g(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 最小的。将这一最小值记为</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
h(\lambda) = \min_{x\in X}f(x)-\lambda g(x).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="h(\lambda) = \min_{x\in X}f(x)-\lambda g(x)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
h(\lambda) = \min_{x\in X}f(x)-\lambda g(x).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=2064 data-original-document-start=2028>那么，因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y,v(y))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y,v(y)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y,v(y))></mjx-container> 同样位于该直线上，就可以得到原问题的解</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(y) = h(\lambda) + \lambda y.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=h space=4><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(y) = h(\lambda) + \lambda y." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mi data-latex=y>y</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v(y) = h(\lambda) + \lambda y.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=2202 data-original-document-start=2104>假设对于所有合理范围的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>，上述函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 都是容易求解的。这在算法竞赛中常常是成立的，因为它去掉了原问题中的限制条件。那么，现在面临的最为重要的两个问题，就是</p><ol data-original-document-end=2291 data-original-document-start=2204><li>是否存在这样的直线斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>，使得它的截距最小值恰好取得在点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y,v(y))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y,v(y)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y,v(y))></mjx-container> 处，以及</li><li>如果存在，如何找到这样的斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>。</li></ol><p data-original-document-end=2446 data-original-document-start=2293>第一个问题相对容易解决。因为当直线斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 发生变化时，所有这些直线切出的集合（即它们对应的上半平面的交）必然是一个凸集。因此，这些直线能够经过某个点，当且仅当这个点在该凸集的下凸壳上。这等价于说，函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是 <a href=../slope-trick/#离散点集上的凸函数>凸函数</a>。</p><p data-original-document-end=2678 data-original-document-start=2448>第二个问题则更为精细。因为所求点的横坐标已经知道是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container>，所以，一个自然的思路是，计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 时，顺便求出限制函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)></mjx-container> 在当前最优解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_\lambda><mjx-msub data-latex=x_\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_\lambda xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_\lambda></mjx-container> 处的取值。比如，在前文提到的例子中，求解带惩罚的问题时，可以记录带惩罚的目标函数取得最优解时，选取的物品数量。然后，将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 与所期望的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 进行比较，并相应调整下次计算时的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的取值。这就是最为传统的 WQS 二分的方法。</p><p data-original-document-end=2702 data-original-document-start=2680>总结一下，传统 WQS 二分的基本流程如下：</p><ol data-original-document-end=3003 data-original-document-start=2704><li>初始时，选取一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的合理的区间；</li><li>在当前的区间中选择一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>；</li><li>求解带惩罚的问题 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="h(\lambda)=\min_{x\in X}f(x)-\lambda g(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" limits=false space=4><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="h(\lambda)=\min_{x\in X}f(x)-\lambda g(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="h(\lambda)=\min_{x\in X}f(x)-\lambda g(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，并记录它的最优解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_\lambda><mjx-msub data-latex=x_\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_\lambda xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_\lambda></mjx-container> 处 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)></mjx-container> 的取值 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container>；</li><li>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g(x_\lambda)=y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g(x_\lambda)=y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="g(x_\lambda)=y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，就得到原问题的最优价值 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(y)=h(\lambda)+\lambda y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=h space=4><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(y)=h(\lambda)+\lambda y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="v(y)=h(\lambda)+\lambda y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，直接结束算法；</li><li>否则，根据 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 的大小关系，调整 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的区间，并回到步骤 2。</li></ol><p data-original-document-end=3048 data-original-document-start=3005>这一基本流程已经足以解决一些问题，但并不完善。接下来，本文将讨论对这一基本流程的改进。</p><h3 data-original-document-end=3061 data-original-document-start=3050 id=共线情形的处理>共线情形的处理<a title="Permanent link" class=headerlink href=#共线情形的处理></a></h3><p data-original-document-end=3092 data-original-document-start=3063>在应用基本流程时，首先遇到的问题就是共线情形无法正确处理。</p><p data-original-document-end=3511 data-original-document-start=3094>如果点集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的下凸壳上有三个及以上的红点共线，那么在上述基本流程中，可能无法正确地判断 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 的大小关系。比如，设共线的三个红点的横坐标分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_1,y_2,y_3><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_3 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_1,y_2,y_3 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_3><mi data-latex=y>y</mi><mn data-latex=3>3</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_1,y_2,y_3></mjx-container>，且它们共线的直线的斜率为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container>。那么，要正确求解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y_2)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y_2) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y_2)></mjx-container>，就必须保证算法终止时，最后计算的问题是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda^*)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda^*) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda^*)></mjx-container>，因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container> 是唯一一个最小化截距时能够经过点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y_2,v(y_2))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y_2,v(y_2)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y_2,v(y_2))></mjx-container> 的直线的斜率。但是，因为在求解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda^*)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda^*) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda^*)></mjx-container> 的过程中，记录的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_{\lambda^*})><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_{\lambda^*}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={\lambda^*} size=s texclass=ORD><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_{\lambda^*}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_{\lambda^*}><mi data-latex=x>x</mi><mrow data-latex={\lambda^*} data-mjx-texclass=ORD><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></mrow></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_{\lambda^*})></mjx-container> 可能是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_1,y_2,y_3><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_3 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_1,y_2,y_3 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_3><mi data-latex=y>y</mi><mn data-latex=3>3</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_1,y_2,y_3></mjx-container> 中的任意一个。如果记录到的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_{\lambda^*})><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_{\lambda^*}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={\lambda^*} size=s texclass=ORD><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_{\lambda^*}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_{\lambda^*}><mi data-latex=x>x</mi><mrow data-latex={\lambda^*} data-mjx-texclass=ORD><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></mrow></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_{\lambda^*})></mjx-container> 不等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_2><mjx-msub data-latex="y_2 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_2 "><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_2></mjx-container>，那么算法将错误地继续运行，并向着背离 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_2><mjx-msub data-latex="y_2 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_2 "><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_2></mjx-container> 的方向调整 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的区间，最终将得到错误的结果。</p><p data-original-document-end=3922 data-original-document-start=3513>为了解决共线的情形，一种处理方法是在记录最优解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_\lambda><mjx-msub data-latex=x_\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_\lambda xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_\lambda></mjx-container> 对应的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 时，总是使之尽可能大（或尽可能小）。同时，将二分中的终止条件从寻找恰好满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g(x_\lambda)=y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g(x_\lambda)=y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="g(x_\lambda)=y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 改为寻找满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g(x_\lambda)\ge y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g(x_\lambda)\ge y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="g(x_\lambda)\ge y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>（或 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="g(x_\lambda)\le y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="g(x_\lambda)\le y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="g(x_\lambda)\le y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>）的最小（或最大）的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>。在上一段的例子中，这相当于计算问题 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda^*)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda^*) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda^*)></mjx-container> 时，输出的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_{\lambda^*})><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_{\lambda^*}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={\lambda^*} size=s texclass=ORD><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_{\lambda^*}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_{\lambda^*}><mi data-latex=x>x</mi><mrow data-latex={\lambda^*} data-mjx-texclass=ORD><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></mrow></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_{\lambda^*})></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_3><mjx-msub data-latex="y_3 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_3 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_3 "><mi data-latex=y>y</mi><mn data-latex=3>3</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_3></mjx-container>。这就保证了算法终止时，最后计算的问题是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda^*)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda^*) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda^*)></mjx-container>。实现这一方法时，需要注意最后输出的不是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="h(\lambda)+\lambda g(x_{\lambda})" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_{\lambda}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={\lambda} size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="h(\lambda)+\lambda g(x_{\lambda})" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_{\lambda}><mi data-latex=x>x</mi><mrow data-latex={\lambda} data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi></mrow></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="h(\lambda)+\lambda g(x_{\lambda})" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 而是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="h(\lambda)+\lambda y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="h(\lambda)+\lambda y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="h(\lambda)+\lambda y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，因为记录的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 未必等于实际的限制 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container>。</p><p data-original-document-end=4544 data-original-document-start=3924>另一种处理方法是实数二分。如果问题涉及的数字都是整数，显然，WQS 二分中的斜率也是整数。在二分中引入实数，是为了保证错误地排除正确选项 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container> 时，可以通过小数部分调整回来，最终逼近正确答案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container>。例如，在上面的例子中，如果计算问题 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda^*)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda^*) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda^*)></mjx-container> 时，记录的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_{\lambda^*})><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_{\lambda^*}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={\lambda^*} size=s texclass=ORD><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_{\lambda^*}) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_{\lambda^*}><mi data-latex=x>x</mi><mrow data-latex={\lambda^*} data-mjx-texclass=ORD><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></mrow></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_{\lambda^*})></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_1><mjx-msub data-latex="y_1 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_1 "><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_1></mjx-container>，小于所希望的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_2><mjx-msub data-latex="y_2 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_2 "><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_2></mjx-container>，那么，算法就会转而考虑区间 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(\lambda^*,\lambda_r]><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_r space=2><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(\lambda^*,\lambda_r] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=,>,</mo><msub data-latex=\lambda_r><mi data-latex=\lambda>λ</mi><mi data-latex=r>r</mi></msub><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(\lambda^*,\lambda_r]></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda_r><mjx-msub data-latex=\lambda_r><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda_r xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\lambda_r><mi data-latex=\lambda>λ</mi><mi data-latex=r>r</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda_r></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 所在区间的右端点。对于整数的情形，这一区间实际应该写作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=[\lambda_*+1,\lambda_r]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_r space=2><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[\lambda_*+1,\lambda_r] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><msub data-latex=\lambda_*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msub><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><msub data-latex=\lambda_r><mi data-latex=\lambda>λ</mi><mi data-latex=r>r</mi></msub><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[\lambda_*+1,\lambda_r]></mjx-container>，这就排除了在后续算法中接近正确答案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container> 的可能。但是，实数二分时，考虑的区间仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(\lambda^*,\lambda_r]><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_r space=2><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(\lambda^*,\lambda_r] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup><mo data-latex=,>,</mo><msub data-latex=\lambda_r><mi data-latex=\lambda>λ</mi><mi data-latex=r>r</mi></msub><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(\lambda^*,\lambda_r]></mjx-container>，而且，对于该区间中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>，求解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 时记录的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 总是不小于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_3><mjx-msub data-latex="y_3 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_3 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_3 "><mi data-latex=y>y</mi><mn data-latex=3>3</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_3></mjx-container>，从而严格大于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y_2><mjx-msub data-latex="y_2 "><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="y_2 "><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y_2></mjx-container> 的。因此，随着算法继续进行，会不断地舍去右半区间，从而，最终得到的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的范围可以保证在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container> 附近。当然，因为已经知道所求的斜率是一个整数，实数二分终止时的精度不必太高，只要能保证二分的区间中只包含一个整数即可，这一整数就是要寻找的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda^*><mjx-msup data-latex=\lambda^*><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\lambda^*><mi data-latex=\lambda>λ</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda^*></mjx-container>。</p><p data-original-document-end=4699 data-original-document-start=4546>正确地处理共线情形后，WQS 二分足以解决绝大多数算法竞赛会遇到的 WQS 二分的问题。但是，这一方法仍然存在一些不足之处：它无法处理 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 难以记录的情形，也无法处理高维 WQS 二分中多个点共面的情形。本文将进一步考察最优化问题 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 的性质，并提出更为一般的处理方法。</p><h2 data-original-document-end=4708 data-original-document-start=4701 id=对偶方法>对偶方法<a title="Permanent link" class=headerlink href=#对偶方法></a></h2><p data-original-document-end=4769 data-original-document-start=4710>本节介绍一种 WQS 二分的实现方法，它只要求对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\lambda\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，可以高效地计算</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x)
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x)" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x)
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=4933 data-original-document-start=4827>的取值，且原问题的最优价值 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的凸函数<sup id=fnref:high-d-convex><a class=footnote-ref href=#fn:high-d-convex>1</a></sup>。用一句话概括，本节将证明原问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 就等于它的对偶问题的最优价值</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v^\star(y) = \sup_{\lambda\in\mathbf R^d} h(\lambda)+\lambda\cdot y,
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=\star><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=star size=s><mjx-c class=mjx-c22C6>⋆</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v^\star(y) = \sup_{\lambda\in\mathbf R^d} h(\lambda)+\lambda\cdot y," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\star><mi data-latex=v>v</mi><mo data-latex=star>⋆</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
v^\star(y) = \sup_{\lambda\in\mathbf R^d} h(\lambda)+\lambda\cdot y,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=5248 data-original-document-start=5011>而对偶问题的目标函数是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\lambda\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的凹函数，从而是单峰函数，可以通过 <a href=../../../basic/binary/#三分法>三分法</a> 或 <a href=../../../basic/binary/#优化黄金分割法>黄金分割法</a> 高效地求解，复杂度仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(T(n)\log^d L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=\log^d space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(T(n)\log^d L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=T>T</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo><msup data-latex=\log^d><mi data-latex=\log>log</mi><mi data-latex=d>d</mi></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(T(n)\log^d L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的。这就完全地解决了传统 WQS 二分方法中记录 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 的值可能会出现的问题，同时，允许将 WQS 二分的思想应用至高维的情形。</p><p data-original-document-end=5375 data-original-document-start=5250>另外，本节还说明，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 的范围可以通过 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 求得，而无需在求解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 时额外记录。例如，对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="d=1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="d=1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="d=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且问题只涉及整数的情形，可以证明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x_\lambda)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=lambda size=s><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x_\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda><mi data-latex=x>x</mi><mi data-latex=lambda>λ</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x_\lambda)></mjx-container> 的取值范围恰为</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h space=3><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h space=3><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)]. display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=5475 data-original-document-start=5435>这实际上也对于不得不采取前文所述二分流程的题目，提供了又一种解决共线问题的方法。</p><p data-original-document-end=5530 data-original-document-start=5477>接下来，本节将用凸分析的理论证明这些结论成立。至于这些方法的具体应用，可以参考 <a href=#例题>例题</a> 一节。</p><h3 data-original-document-end=5547 data-original-document-start=5532 id=lagrange-对偶>Lagrange 对偶<a title="Permanent link" class=headerlink href=#lagrange-对偶></a></h3><p data-original-document-end=5682 data-original-document-start=5549>考虑用 <a href=https://en.wikipedia.org/wiki/Lagrange_multiplier target=_blank>Lagrange 乘子法</a> 解决该问题。引入 Lagrange 乘子 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\lambda\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么，Lagrangian 可以写作</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
L(x,\lambda,y) = f(x) - \lambda\cdot g(x)+\lambda\cdot y.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=L><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="L(x,\lambda,y) = f(x) - \lambda\cdot g(x)+\lambda\cdot y." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=L>L</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
L(x,\lambda,y) = f(x) - \lambda\cdot g(x)+\lambda\cdot y.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=5805 data-original-document-start=5749>因为只要 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=g(x)-y><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x)-y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)-y></mjx-container> 有一个分量非零，就可以让相应的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container> 的分量趋于（正或负）无穷，所以有</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y)
= \begin{cases}
f(x),&g(x)=y,\\
+\infty,&\text{otherwise}.
\end{cases}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} data-latex-item={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:7.577em><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex=\text{otherwise}><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c68 noic=true style=padding-top:.694em>h</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c77 noic=true style=padding-top:.694em>w</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c65 style=padding-top:.694em>e</mjx-c></mjx-mtext><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y)= \begin{cases}f(x),&g(x)=y,\\+\infty,&\text{otherwise}.\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=L>L</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mrow data-latex={cases} data-latex-item={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex=\text{otherwise}>otherwise</mtext><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y)
= \begin{cases}
f(x),&g(x)=y,\\
+\infty,&\text{otherwise}.
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=5939 data-original-document-start=5928>这说明，原问题可以写作</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
v(y) &= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
v(y) &= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).
\end{aligned}
" data-latex-item={aligned} style=min-width:11.171em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}" space=2><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}v(y) &= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}v(y) &= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=L>L</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
v(y) &= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=6123 data-original-document-start=6043>交换两次最值操作，就得到它的 <a href=https://en.wikipedia.org/wiki/Duality_%28optimization%29 target=_blank>对偶问题</a>：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
v^\star(y)&=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\
&=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
v^\star(y)&=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\
&=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.
\end{aligned}
" data-latex-item={aligned} style=min-width:11.33em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msup data-latex=\star><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=star size=s><mjx-c class=mjx-c22C6>⋆</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex="\min_{x\in X}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}v^\star(y)&=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\&=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}v^\star(y)&=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\&=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><msup data-latex=\star><mi data-latex=v>v</mi><mo data-latex=star>⋆</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=L>L</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
v^\star(y)&=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\
&=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=6365 data-original-document-start=6289>马上要说明的是，在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 的凸函数的条件下，强对偶（strong duality）成立，即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v^\star(y)=v(y)" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=\star><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=star size=s><mjx-c class=mjx-c22C6>⋆</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=v space=4><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v^\star(y)=v(y)" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\star><mi data-latex=v>v</mi><mo data-latex=star>⋆</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="v^\star(y)=v(y)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p><h3 data-original-document-end=6374 data-original-document-start=6367 id=凸共轭>凸共轭<a title="Permanent link" class=headerlink href=#凸共轭></a></h3><p data-original-document-end=6397 data-original-document-start=6376>为了说明强对偶成立，需要引入凸共轭的概念。</p><details class=abstract data-original-document-end=6574 data-original-document-start=6399 open><summary>凸共轭</summary> <p>对于函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，它的 <strong>凸共轭</strong>（convex conjugate），或称 <strong>Legendre–Fenchel 变换</strong>（Legendre–Fenchel transformation），是指函数</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f^*(x^*) = \sup_{x\in\mathbf R^d}x^*\cdot x - f(x).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{x\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.15em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f^*(x^*) = \sup_{x\in\mathbf R^d}x^*\cdot x - f(x)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\sup_{x\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{x\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f^*(x^*) = \sup_{x\in\mathbf R^d}x^*\cdot x - f(x).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><p data-original-document-end=6717 data-original-document-start=6651>从变量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 的角度看，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f^*(x^*)><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f^*(x^*) xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f^*(x^*)></mjx-container> 是一系列线性函数的上确界，所以，必然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf R^d" aria-hidden=true class=NCM-N><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上的凸函数。</p><details class=info data-original-document-end=7070 data-original-document-start=6719 open><summary>超平面的「斜率向量」和「截距」</summary> <p>本文所讨论的向量空间 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf R^{d+1}" aria-hidden=true class=NCM-N><mjx-msup data-latex="\mathbf R^{d+1}"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={d+1} size=s texclass=ORD><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf R^{d+1}" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="\mathbf R^{d+1}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex={d+1} data-mjx-texclass=ORD><mi data-latex=d>d</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msup></math></mjx-assistive-mml><img title="\mathbf R^{d+1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 中的超平面的方程都具有形式</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
y = k\cdot x + b.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=k space=4><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=b space=3><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="y = k\cdot x + b." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mi data-latex=k>k</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=+>+</mo><mi data-latex=b>b</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
y = k\cdot x + b.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>也就是说，本文不会涉及平行于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 轴的超平面。为表述方便，本文并不严谨地将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 称为该超平面的「斜率向量」，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=b><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=b xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=b>b</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=b></mjx-container> 称为该超平面的「截距」。将这一超平面的方程写成更标准的形式，就是</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
k\cdot x - y = -b.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="k\cdot x - y = -b." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=->−</mo><mi data-latex=b>b</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
k\cdot x - y = -b.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>它的一个法向量是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=(k,-1)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(k,-1) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=,>,</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(k,-1)></mjx-container>。因此，所谓的斜率向量其实是将超平面的法向量归一化使得它的最后一个分量等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-1><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-1></mjx-container> 时，所得到的法向量的前 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=d><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=d xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=d>d</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=d></mjx-container> 个分量。</p></details><p data-original-document-end=7129 data-original-document-start=7072>几何直观上，函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 的凸共轭描述的是，对于所有斜率向量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 且与函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 的上境图</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\operatorname{epi}f = \{(x,y)\in\mathbf R^d\times\mathbf R:f(x)\le y\}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\operatorname{epi}><mjx-c class=mjx-c65 noic=true style=padding-top:.657em>e</mjx-c><mjx-c class=mjx-c70 noic=true style=padding-top:.657em>p</mjx-c><mjx-c class=mjx-c69 style=padding-top:.657em>i</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.413em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=\times space=3><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=3 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=: space=4><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=y space=4><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\operatorname{epi}f = \{(x,y)\in\mathbf R^d\times\mathbf R:f(x)\le y\}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\operatorname{epi}>epi</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi><mo data-latex="=">=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\times>×</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=:>:</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=y>y</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="
\operatorname{epi}f = \{(x,y)\in\mathbf R^d\times\mathbf R:f(x)\le y\}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=7458 data-original-document-start=7209>相交的超平面，截距 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)-x^*\cdot x" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)-x^*\cdot x" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi></math></mjx-assistive-mml><img title="f(x)-x^*\cdot x" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的最小值就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-f^*(x^*)><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-f^*(x^*) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-f^*(x^*)></mjx-container>。换句话说，函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 总在超平面 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y = x^*\cdot x-f^*(x^*)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y = x^*\cdot x-f^*(x^*)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y = x^*\cdot x-f^*(x^*)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上方，且与该平面切于点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(x_0,f(x_0))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(x_0,f(x_0)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(x_0,f(x_0))></mjx-container>；当然，可能存在其余的切点。这样的超平面，称为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处的 <strong>支撑超平面</strong>（supporting hyperplane）。函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 的一个支撑超平面的截距由它的斜率向量唯一确定，凸共轭就提供了这个从斜率向量到截距的映射。</p><p data-original-document-end=7548 data-original-document-start=7460>在集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 上最小化 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)-\lambda\cdot g(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)-\lambda\cdot g(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x)-\lambda\cdot g(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 就等价于在集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{(y,v(y))\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{(y,v(y))\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{(y,v(y))\}></mjx-container> 上最小化 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(y)-\lambda\cdot y" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(y)-\lambda\cdot y" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="v(y)-\lambda\cdot y" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\min_x f(x)-\lambda\cdot g(x) &= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\
&= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\
&= \min_{y\in g(X)}v(y) - \lambda\cdot y.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
\min_x f(x)-\lambda\cdot g(x) &= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\
&= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\
&= \min_{y\in g(X)}v(y) - \lambda\cdot y.
\end{aligned}
" data-latex-item={aligned} style=min-width:23.657em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-munder data-latex=\min_x><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.287em;padding-left:.631em><mjx-mi data-latex=x size=s><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{y\in g(X)}" space=4><mjx-row><mjx-base style=padding-left:.32em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in g(X)}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mrow data-latex="\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)" data-latex-item="\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)" space=2><mjx-mo data-latex=\left( data-latex-item=\left(><mjx-c class="mjx-c28 NCM-S6">(</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X:g(x)=y}"><mjx-row><mjx-base style=padding-left:1.098em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in X:g(x)=y}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right) data-latex-item=\right)><mjx-c class="mjx-c29 NCM-S6">)</mjx-c></mjx-mo></mjx-mrow></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{y\in g(X)}" space=4><mjx-row><mjx-base style=padding-left:.32em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in g(X)}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mrow data-latex="\left(\min_{x\in X:g(x)=y} f(x)\right)" data-latex-item="\left(\min_{x\in X:g(x)=y} f(x)\right)" space=2><mjx-mo data-latex=\left( data-latex-item=\left(><mjx-c class="mjx-c28 NCM-S6">(</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X:g(x)=y}"><mjx-row><mjx-base style=padding-left:1.098em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in X:g(x)=y}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\right) data-latex-item=\right)><mjx-c class="mjx-c29 NCM-S6">)</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{y\in g(X)}" space=4><mjx-row><mjx-base style=padding-left:.32em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in g(X)}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\min_x f(x)-\lambda\cdot g(x) &= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\&= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\&= \min_{y\in g(X)}v(y) - \lambda\cdot y.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\min_x f(x)-\lambda\cdot g(x) &= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\&= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\&= \min_{y\in g(X)}v(y) - \lambda\cdot y.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><munder data-latex=\min_x><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mi data-latex=x>x</mi></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\min_{y\in g(X)}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{y\in g(X)}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=X>X</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mrow data-latex="\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)" data-latex-item="\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-latex-item=\left( data-mjx-texclass=OPEN>(</mo><munder data-latex="\min_{x\in X:g(x)=y}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X:g(x)=y}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=:>:</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-latex-item=\right) data-mjx-texclass=CLOSE>)</mo></mrow></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\min_{y\in g(X)}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{y\in g(X)}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=X>X</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mrow data-latex="\left(\min_{x\in X:g(x)=y} f(x)\right)" data-latex-item="\left(\min_{x\in X:g(x)=y} f(x)\right)" data-mjx-texclass=INNER><mo data-latex=\left( data-latex-item=\left( data-mjx-texclass=OPEN>(</mo><munder data-latex="\min_{x\in X:g(x)=y}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X:g(x)=y}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=:>:</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=y>y</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\right) data-latex-item=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><munder data-latex="\min_{y\in g(X)}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{y\in g(X)}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=X>X</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\min_x f(x)-\lambda\cdot g(x) &= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\
&= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\
&= \min_{y\in g(X)}v(y) - \lambda\cdot y.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=7821 data-original-document-start=7817>因此，有</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
h(\lambda) = \min_{y\in g(X)}v(y) - \lambda\cdot y = -v^*(\lambda).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{y\in g(X)}" space=4><mjx-row><mjx-base style=padding-left:.32em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in g(X)}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=- space=4><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=v^*><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="h(\lambda) = \min_{y\in g(X)}v(y) - \lambda\cdot y = -v^*(\lambda)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{y\in g(X)}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{y\in g(X)}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=X>X</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mo data-latex=->−</mo><msup data-latex=v^*><mi data-latex=v>v</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
h(\lambda) = \min_{y\in g(X)}v(y) - \lambda\cdot y = -v^*(\lambda).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=7952 data-original-document-start=7898>这说明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\lambda\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的凹函数。进而，有</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v^\star(y) = \sup_{\lambda\in\mathbf R^d}\lambda\cdot y-v^*(\lambda) = v^{**}(y).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=\star><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=star size=s><mjx-c class=mjx-c22C6>⋆</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{\lambda\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.153em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\lambda\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=\lambda space=2><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=v^* space=3><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=v^{**} space=4><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v^\star(y) = \sup_{\lambda\in\mathbf R^d}\lambda\cdot y-v^*(\lambda) = v^{**}(y)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=\star><mi data-latex=v>v</mi><mo data-latex=star>⋆</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\sup_{\lambda\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\lambda\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=\lambda>λ</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=->−</mo><msup data-latex=v^*><mi data-latex=v>v</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=v^{**}><mi data-latex=v>v</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v^\star(y) = \sup_{\lambda\in\mathbf R^d}\lambda\cdot y-v^*(\lambda) = v^{**}(y).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=8122 data-original-document-start=8043>也就是说，对偶问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v^{\star}(y)><mjx-msup data-latex=v^{\star}><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={\star} size=s texclass=ORD><mjx-mo data-latex=\star><mjx-c class=mjx-c22C6>⋆</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v^{\star}(y) xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=v^{\star}><mi data-latex=v>v</mi><mrow data-latex={\star} data-mjx-texclass=ORD><mo data-latex=\star>⋆</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v^{\star}(y)></mjx-container> 是原问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 的双重凸共轭，也称为 <strong>双共轭</strong>（biconjugate）。</p><p data-original-document-end=8176 data-original-document-start=8124>所以，问题转化为：什么样的函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 满足它的双共轭就等于它自身？这一问题的答案由如下定理给出：</p><details class=note data-original-document-end=8452 data-original-document-start=8178 open><summary>定理（Fenchel–Moreau）</summary> <p>对于函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，它的双共轭等于它自身，即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}=f" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}=f" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex="=">=</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="f^{**}=f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，当且仅当以下三个条件之一满足：</p> <ol><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 是正常凸函数且 <a href=https://en.wikipedia.org/wiki/Semi-continuity target=_blank>下半连续</a>，</li><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(x)\equiv+\infty><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x)\equiv+\infty xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)\equiv+\infty></mjx-container>，或</li><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(x)\equiv-\infty><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x)\equiv-\infty xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)\equiv-\infty></mjx-container>。</li></ol></details><details class=note data-original-document-end=11302 data-original-document-start=8454><summary>证明</summary> <p>一个函数是正常的（proper），当且仅当它从不取得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-\infty><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-\infty xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-\infty></mjx-container> 的值，且不永远取得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+\infty><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+\infty xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+\infty></mjx-container> 的值。</p> <p>对于非正常函数的情形，可以验证 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(x)\equiv+\infty><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x)\equiv+\infty xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)\equiv+\infty></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(x)\equiv-\infty><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x)\equiv-\infty xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)\equiv-\infty></mjx-container> 互为共轭。除此之外，只要 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在任何一点处取到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-\infty><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-\infty xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-\infty></mjx-container>，必然有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f^*(x^*)\equiv+\infty><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\equiv><mjx-c class=mjx-c2261>≡</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f^*(x^*)\equiv+\infty xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=\equiv>≡</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f^*(x^*)\equiv+\infty></mjx-container>。所以，满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}=f" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}=f" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex="=">=</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="f^{**}=f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的非正常函数只有这两种情形。下面的讨论仅限于正常函数。对于正常函数，下半连续且凸的条件等价于它的上境图是闭凸集。</p> <p>这一条件的必要性是容易的。因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f=f^{**}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f=f^{**}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex="=">=</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup></math></mjx-assistive-mml><img title="f=f^{**}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f^*><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f^*></mjx-container> 的凸共轭，作为一系列线性函数的上确界，它的上境图必然是一系列闭凸集的交集，所以必然是闭凸集。这就说明，满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}=f" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}=f" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex="=">=</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="f^{**}=f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的正常函数必然是下半连续且凸的。</p> <p>反过来，这些条件也是充分的。和其他强对偶定理的证明一样，证明可以分为两步。</p> <p>第一步，说明弱对偶成立，即 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)\ge f^{**}(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)\ge f^{**}(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x)\ge f^{**}(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。由凸共轭的定义可知，对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x,x^*\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x,x^*\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=,>,</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x,x^*\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f^*(x^*) \ge x^*\cdot x-f(x).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f^*(x^*) \ge x^*\cdot x-f(x)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f^*(x^*) \ge x^*\cdot x-f(x).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这就说明，对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x,x^*\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x,x^*\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=,>,</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x,x^*\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，同样有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(x) \ge x^*\cdot x-f^*(x^*).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(x) \ge x^*\cdot x-f^*(x^*)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(x) \ge x^*\cdot x-f^*(x^*).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>对不等式右侧中的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 取上确界，就有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)\ge f^{**}(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)\ge f^{**}(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x)\ge f^{**}(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p> <p>第二步，利用 <a href=https://en.wikipedia.org/wiki/Hyperplane_separation_theorem target=_blank>超平面分离定理</a> 说明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x)\le f^{**}(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x)\le f^{**}(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x)\le f^{**}(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。假设不然，存在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x_0\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x_0\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x_0\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x_0)>f^{**}(x_0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x_0)>f^{**}(x_0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=">">></mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x_0)>f^{**}(x_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立。因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 的上境图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\operatorname{epi}(f)><mjx-mi data-latex=\operatorname{epi}><mjx-c class=mjx-c65 noic=true style=padding-top:.657em>e</mjx-c><mjx-c class=mjx-c70 noic=true style=padding-top:.657em>p</mjx-c><mjx-c class=mjx-c69 style=padding-top:.657em>i</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\operatorname{epi}(f) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\operatorname{epi}>epi</mi><mo data-mjx-texclass=NONE>⁡</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\operatorname{epi}(f)></mjx-container> 是闭凸集，而且单点集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{(x_0,f^{**}(x_0))\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=2><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{(x_0,f^{**}(x_0))\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=,>,</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{(x_0,f^{**}(x_0))\}></mjx-container> 是紧凸集，所以，根据超平面分离定理，存在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(\lambda,t)\in\mathbf R^d\times\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=t space=2><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=\times><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=3 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(\lambda,t)\in\mathbf R^d\times\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=,>,</mo><mi data-latex=t>t</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\times>×</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="(\lambda,t)\in\mathbf R^d\times\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha\in\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha\in\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><mo data-latex=\in>∈</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="\alpha\in\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\operatorname{dom} f:=\{x\in\mathbf R^d:f(x)<+\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\operatorname{dom} space=4><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6D style=padding-top:.694em>m</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=":="><mjx-c class=mjx-c3A>:</mjx-c><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\operatorname{dom} f:=\{x\in\mathbf R^d:f(x)<+\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\operatorname{dom}>dom</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi><mo data-latex=":=" data-mjx-texclass=REL>:=</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=:>:</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="<">&lt;</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="x\in\operatorname{dom} f:=\{x\in\mathbf R^d:f(x)<+\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\ge f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\ge f(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\ge>≥</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y\ge f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\lambda\cdot x-ty <\alpha <\lambda\cdot x_0 - tf^{**}(x_0)
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=t space=3><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=4><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=t space=3><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\lambda\cdot x-ty <\alpha <\lambda\cdot x_0 - tf^{**}(x_0)" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=t>t</mi><mi data-latex=y>y</mi><mo data-latex="<">&lt;</mo><mi data-latex=\alpha>α</mi><mo data-latex="<">&lt;</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><mi data-latex=t>t</mi><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
\lambda\cdot x-ty <\alpha <\lambda\cdot x_0 - tf^{**}(x_0)
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>成立。因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 可以选得任意大，所以必然有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t\ge 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t\ge 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi><mo data-latex=\ge>≥</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="t\ge 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。这又可以分为两种情形。</p> <p>首先，讨论 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="t>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形。此时，将不等式的各部分都同除以 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=t><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=t xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=t></mjx-container>，并设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda'=t^{-1}\lambda" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=t^{-1} space=4><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda'=t^{-1}\lambda" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><msup data-latex=t^{-1}><mi data-latex=t>t</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img title="\lambda'=t^{-1}\lambda" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha'=t^{-1}\alpha" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=t^{-1} space=4><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={-1} size=s texclass=ORD><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha'=t^{-1}\alpha" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\alpha>α</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><msup data-latex=t^{-1}><mi data-latex=t>t</mi><mrow data-latex={-1} data-mjx-texclass=ORD><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msup><mi data-latex=\alpha>α</mi></math></mjx-assistive-mml><img title="\alpha'=t^{-1}\alpha" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，就得到</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\lambda'\cdot x-y < \alpha'< \lambda'\cdot x_0-f^{**}(x_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\lambda'\cdot x-y < \alpha'< \lambda'\cdot x_0-f^{**}(x_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=y>y</mi><mo data-latex="<">&lt;</mo><msup><mi data-latex=\alpha>α</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="<">&lt;</mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\lambda'\cdot x-y < \alpha'< \lambda'\cdot x_0-f^{**}(x_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>对所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\operatorname{dom} f" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\operatorname{dom} space=4><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6D style=padding-top:.694em>m</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\operatorname{dom} f" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\operatorname{dom}>dom</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="x\in\operatorname{dom} f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y=f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y=f(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y=f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，就都成立</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\alpha' > \lambda'\cdot x - f(x).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\alpha' > \lambda'\cdot x - f(x)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\alpha>α</mi><mo data-mjx-alternate=1>′</mo></msup><mo data-latex=">">></mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\alpha' > \lambda'\cdot x - f(x).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>故而，对不等号右侧的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 取上确界，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\alpha' \ge \sup_{x\in\mathbf R^d}\lambda'\cdot x - f(x) = f^*(\lambda').
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{x\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.15em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup space=2><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\alpha' \ge \sup_{x\in\mathbf R^d}\lambda'\cdot x - f(x) = f^*(\lambda')." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\alpha>α</mi><mo data-mjx-alternate=1>′</mo></msup><mo data-latex=\ge>≥</mo><munder data-latex="\sup_{x\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{x\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\alpha' \ge \sup_{x\in\mathbf R^d}\lambda'\cdot x - f(x) = f^*(\lambda').
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>进而，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f^{**}(x_0) < \lambda'\cdot x_0-f^*(\lambda') \le \sup_{x^*\in\mathbf R^d}x^*\cdot x_0-f^*(x^*) = f^{**}(x_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{x^*\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.304em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x^*\in\mathbf R^d}" size=s texclass=ORD><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f^{**}(x_0) < \lambda'\cdot x_0-f^*(\lambda') \le \sup_{x^*\in\mathbf R^d}x^*\cdot x_0-f^*(x^*) = f^{**}(x_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="<">&lt;</mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><munder data-latex="\sup_{x^*\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{x^*\in\mathbf R^d}" data-mjx-texclass=ORD><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f^{**}(x_0) < \lambda'\cdot x_0-f^*(\lambda') \le \sup_{x^*\in\mathbf R^d}x^*\cdot x_0-f^*(x^*) = f^{**}(x_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这一矛盾说明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="t>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形并不成立。</p> <p>最后，讨论 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="t=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形。事实上，将要说明的是，可以通过微扰，将它转化为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="t>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形。任取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\lambda_0\in\operatorname{dom}f^*><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\operatorname{dom} space=4><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6D style=padding-top:.694em>m</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=2><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda_0\in\operatorname{dom}f^* xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=\in>∈</mo><mi data-latex=\operatorname{dom}>dom</mi><mo data-mjx-texclass=NONE>⁡</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda_0\in\operatorname{dom}f^*></mjx-container>，根据凸共轭的定义可知，对于任何 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=x\in\operatorname{dom}f><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\operatorname{dom} space=4><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6D style=padding-top:.694em>m</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x\in\operatorname{dom}f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\operatorname{dom}>dom</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x\in\operatorname{dom}f></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\ge f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\ge><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\ge f(x)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\ge>≥</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y\ge f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\lambda_0\cdot x-y\le f^*(\lambda_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\lambda_0\cdot x-y\le f^*(\lambda_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=y>y</mi><mo data-latex=\le>≤</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\lambda_0\cdot x-y\le f^*(\lambda_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\varepsilon>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\varepsilon><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\varepsilon>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\varepsilon>ε</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="\varepsilon>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
(\lambda+\varepsilon\lambda_0)\cdot x - \varepsilon y<\alpha+\varepsilon f^*(\lambda_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="(\lambda+\varepsilon\lambda_0)\cdot x - \varepsilon y<\alpha+\varepsilon f^*(\lambda_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=\varepsilon>ε</mi><mi data-latex=y>y</mi><mo data-latex="<">&lt;</mo><mi data-latex=\alpha>α</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
(\lambda+\varepsilon\lambda_0)\cdot x - \varepsilon y<\alpha+\varepsilon f^*(\lambda_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>同时，因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha<\lambda\cdot x_0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=4><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha<\lambda\cdot x_0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><mo data-latex="<">&lt;</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img title="\alpha<\lambda\cdot x_0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，所以，对于充分小的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\varepsilon>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\varepsilon><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\varepsilon>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\varepsilon>ε</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="\varepsilon>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，又有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\alpha+\varepsilon f^*(\lambda_0) < (\lambda+\varepsilon\lambda_0)\cdot x_0 - \varepsilon f^{**}(x_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\alpha+\varepsilon f^*(\lambda_0) < (\lambda+\varepsilon\lambda_0)\cdot x_0 - \varepsilon f^{**}(x_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="<">&lt;</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><mi data-latex=\varepsilon>ε</mi><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\alpha+\varepsilon f^*(\lambda_0) < (\lambda+\varepsilon\lambda_0)\cdot x_0 - \varepsilon f^{**}(x_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，如果取 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lambda'=\lambda+\varepsilon\lambda_0" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=4><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lambda'=\lambda+\varepsilon\lambda_0" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img title="\lambda'=\lambda+\varepsilon\lambda_0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="t'=\varepsilon" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=4><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="t'=\varepsilon" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=t>t</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mi data-latex=\varepsilon>ε</mi></math></mjx-assistive-mml><img title="t'=\varepsilon" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha'=\alpha+\varepsilon f^*(\lambda_0)" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=\lambda_0><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha'=\alpha+\varepsilon f^*(\lambda_0)" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\alpha>α</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><mi data-latex=\alpha>α</mi><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=\lambda_0><mi data-latex=\lambda>λ</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\alpha'=\alpha+\varepsilon f^*(\lambda_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么，就有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\lambda'\cdot x-t'y <\alpha' <\lambda'\cdot x_0 - t'f^{**}(x_0).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-msup space=4><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\lambda'\cdot x-t'y <\alpha' <\lambda'\cdot x_0 - t'f^{**}(x_0)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><msup><mi data-latex=t>t</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mi data-latex=y>y</mi><mo data-latex="<">&lt;</mo><msup><mi data-latex=\alpha>α</mi><mo data-mjx-alternate=1>′</mo></msup><mo data-latex="<">&lt;</mo><msup><mi data-latex=\lambda>λ</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\cdot>⋅</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=->−</mo><msup><mi data-latex=t>t</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\lambda'\cdot x-t'y <\alpha' <\lambda'\cdot x_0 - t'f^{**}(x_0).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这就又回到了前一种情形，仍然会导致矛盾。</p> <p>这一矛盾说明，并不存在满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x_0)>f^{**}(x_0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x_0)>f^{**}(x_0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=">">></mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x_0)>f^{**}(x_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x_0\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x_0\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x_0\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。故而，总有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x_0)\le f^{**}(x_0)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x_0)\le f^{**}(x_0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(x_0)\le f^{**}(x_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p> <p>结合这两步证明的结果，就得到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}(x)=f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}(x)=f(x)" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f^{**}(x)=f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立。</p></details><p data-original-document-end=11371 data-original-document-start=11304>因此，强对偶成立，当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的凸函数<sup id=fnref:other-conditions><a class=footnote-ref href=#fn:other-conditions>2</a></sup>。</p><h3 data-original-document-end=11380 data-original-document-start=11373 id=次梯度>次梯度<a title="Permanent link" class=headerlink href=#次梯度></a></h3><p data-original-document-end=11582 data-original-document-start=11382>上一节说明了，带惩罚的问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(\lambda)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(\lambda) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(\lambda)></mjx-container> 是原问题的价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 的凸共轭的相反数。因为凸共轭的定义实际上是一个含参数的最优化问题，所以它也成立类似 <a href=https://en.wikipedia.org/wiki/Envelope_theorem target=_blank>包络定理</a> 的结论。但是，因为凸函数并非处处可微的，所以需要首先将导数的定义推广到凸函数的情形。这就引出了次梯度的概念。</p><details class=abstract data-original-document-end=11952 data-original-document-start=11584 open><summary>次梯度</summary> <p>对于凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=x_0\in\operatorname{dom}f><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\operatorname{dom} space=4><mjx-c class=mjx-c64 noic=true style=padding-top:.694em>d</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c6D style=padding-top:.694em>m</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0\in\operatorname{dom}f xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=\in>∈</mo><mi data-latex=\operatorname{dom}>dom</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0\in\operatorname{dom}f></mjx-container>，如果向量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^*\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^*\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x^*\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 满足对于任何 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(x) \ge f(x_0)+x^*\cdot(x-x_0),
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=x_0 space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(x) \ge f(x_0)+x^*\cdot(x-x_0)," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
f(x) \ge f(x_0)+x^*\cdot(x-x_0),
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>那么，就称 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处的一个 <strong>次梯度</strong>（subgradient）。函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处的全体次梯度的集合称为它在该处的 <strong>次微分</strong>（subdifferential），记作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\partial f(x_0)" aria-hidden=true class=NCM-N><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\partial f(x_0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\partial f(x_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p></details><p data-original-document-end=12019 data-original-document-start=11954>几何直观上，凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处的次微分，就是它在该处的所有支撑超平面的斜率向量的集合。对于一维的情形，次微分</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\partial f(x_0) = [\partial_-f(x_0),\partial_+f(x_0)],
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=[ space=4><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-msub data-latex=\partial_-><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.035em><mjx-mo data-latex=- size=s><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo></mjx-script></mjx-msub><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=\partial_+ space=2><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.035em><mjx-mo data-latex=+ size=s><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo></mjx-script></mjx-msub><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\partial f(x_0) = [\partial_-f(x_0),\partial_+f(x_0)]," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=[ stretchy=false>[</mo><msub data-latex=\partial_-><mi data-latex=\partial>∂</mi><mo data-latex=->−</mo></msub><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><msub data-latex=\partial_+><mi data-latex=\partial>∂</mi><mo data-latex=+>+</mo></msub><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
\partial f(x_0) = [\partial_-f(x_0),\partial_+f(x_0)],
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=12271 data-original-document-start=12083>其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\partial_-f(x_0)><mjx-msub data-latex=\partial_-><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.035em><mjx-mo data-latex=- size=s><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo></mjx-script></mjx-msub><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\partial_-f(x_0) xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\partial_-><mi data-latex=\partial>∂</mi><mo data-latex=->−</mo></msub><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\partial_-f(x_0)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\partial_+f(x_0)><mjx-msub data-latex=\partial_+><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.035em><mjx-mo data-latex=+ size=s><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo></mjx-script></mjx-msub><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\partial_+f(x_0) xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\partial_+><mi data-latex=\partial>∂</mi><mo data-latex=+>+</mo></msub><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\partial_+f(x_0)></mjx-container> 分别是函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处的左右导数。进一步地，对于整数集上的凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf Z\rightarrow\mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf Z" space=4 texclass=ORD><mjx-mi data-latex=Z><mjx-c class=mjx-c1D419>𝐙</mjx-c></mjx-mi></mjx-texatom><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf Z\rightarrow\mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><mrow data-latex="\mathbf Z" data-mjx-texclass=ORD><mi data-latex=Z mathvariant=bold>Z</mi></mrow><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="f:\mathbf Z\rightarrow\mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 延拓而来的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\tilde f(x)" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\tilde f" texclass=ORD><mjx-mover><mjx-over style=margin-bottom:-.556em;padding-bottom:.105em;padding-left:.464em><mjx-mo style=width:0;margin-left:-.25em><mjx-c class=mjx-c2DC>˜</mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\tilde f(x)" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\tilde f" data-mjx-texclass=ORD><mover><mi data-latex=f>f</mi><mo stretchy=false>~</mo></mover></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\tilde f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，它在整数点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x=k" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=k space=4><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x=k" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mi data-latex=k>k</mi></math></mjx-assistive-mml><img title="x=k" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 处的左右导数就是左右两侧的一阶差分：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\partial\tilde f(k) = [f(k)-f(k-1),f(k+1)-f(k)]. 
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-texatom data-latex="\tilde f" texclass=ORD><mjx-mover><mjx-over style=margin-bottom:-.556em;padding-bottom:.105em;padding-left:.464em><mjx-mo style=width:0;margin-left:-.25em><mjx-c class=mjx-c2DC>˜</mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=[ space=4><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\partial\tilde f(k) = [f(k)-f(k-1),f(k+1)-f(k)]. " display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><mrow data-latex="\tilde f" data-mjx-texclass=ORD><mover><mi data-latex=f>f</mi><mo stretchy=false>~</mo></mover></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=[ stretchy=false>[</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\partial\tilde f(k) = [f(k)-f(k-1),f(k+1)-f(k)]. 
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=12393 data-original-document-start=12330>显然，凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x_0><mjx-msub data-latex="x_0 "><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="x_0 "><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x_0></mjx-container> 处可微，当且仅当它在该处的次微分 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\partial f(x_0)" aria-hidden=true class=NCM-N><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\partial f(x_0)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_0><mi data-latex=x>x</mi><mn data-latex=0>0</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\partial f(x_0)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是单点集。</p><p data-original-document-end=12480 data-original-document-start=12395>因为凸共轭提供了从支撑超平面的斜率向量到它的截距的映射，所以，利用凸共轭，可以判断一个斜率向量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 是否是凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x)></mjx-container> 在给定点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 处的一个次梯度。</p><details class=note data-original-document-end=12724 data-original-document-start=12482 open><summary>定理（凸共轭与次梯度）</summary> <p>对于正常凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^d\rightarrow\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^d\rightarrow\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="f:\mathbf R^d\rightarrow\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x,x^*\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x,x^*\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=,>,</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x,x^*\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\in\partial f(x) \iff x^*\cdot x = f(x) + f^*(x^*).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\partial space=4><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-mo data-latex=\Longleftrightarrow space=4><mjx-c class=mjx-c27FA>⟺</mjx-c></mjx-mo><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\in\partial f(x) \iff x^*\cdot x = f(x) + f^*(x^*)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mspace data-latex=\; width=0.278em></mspace><mo data-latex=\Longleftrightarrow stretchy=false>⟺</mo><mspace data-latex=\; width=0.278em></mspace><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\in\partial f(x) \iff x^*\cdot x = f(x) + f^*(x^*).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>进而，如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 还是下半连续的，那么这两个条件都等价于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\partial f^*(x^*)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\partial space=4><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\partial f^*(x^*)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\partial>∂</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x\in\partial f^*(x^*)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p></details><details class=note data-original-document-end=13461 data-original-document-start=12867><summary>证明</summary> <p>按照次梯度的定义，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x^*\in\partial f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\partial space=4><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x^*\in\partial f(x)" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x^*\in\partial f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，当且仅当</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(x') \ge f(x) + x^*\cdot(x'-x),~\forall x'\in\mathbf R^d.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=\forall><mjx-c class=mjx-c2200>∀</mjx-c></mjx-mi><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.413em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(x') \ge f(x) + x^*\cdot(x'-x),~\forall x'\in\mathbf R^d." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=->−</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=\forall mathvariant=normal>∀</mi><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(x') \ge f(x) + x^*\cdot(x'-x),~\forall x'\in\mathbf R^d.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这等价于</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\cdot x - f(x) \ge x^*\cdot x'-f(x'),~\forall x'\in\mathbf R^d.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=\forall><mjx-c class=mjx-c2200>∀</mjx-c></mjx-mi><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.413em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\cdot x - f(x) \ge x^*\cdot x'-f(x'),~\forall x'\in\mathbf R^d." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=\forall mathvariant=normal>∀</mi><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\cdot x - f(x) \ge x^*\cdot x'-f(x'),~\forall x'\in\mathbf R^d.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这又等价于</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\cdot x - f(x) \ge \sup_{x'\in\mathbf R^d}x^*\cdot x'-f(x') = f^*(x^*).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.281em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{\in\mathbf R^d}" size=s texclass=ORD><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\cdot x - f(x) \ge \sup_{x'\in\mathbf R^d}x^*\cdot x'-f(x') = f^*(x^*)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><munder data-latex="\sup_{\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{\in\mathbf R^d}" data-mjx-texclass=ORD><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msup><mi data-latex=x>x</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\cdot x - f(x) \ge \sup_{x'\in\mathbf R^d}x^*\cdot x'-f(x') = f^*(x^*).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>但是，依据凸共轭的定义，总是有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\cdot x - f(x) \le f^*(x^*).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\cdot x - f(x) \le f^*(x^*)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\cdot x - f(x) \le f^*(x^*).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，前一式中的大于等于号实际上等价于等号，也就等价于下式</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\cdot x = f(x) + f^*(x^*).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\cdot x = f(x) + f^*(x^*)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\cdot x = f(x) + f^*(x^*).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这就完成了第一部分的证明。</p> <p>对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 是下半连续的正常凸函数的情形，依 Fenchel–Moreau 定理，有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}=f" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}=f" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex="=">=</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="f^{**}=f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。因此，这两个条件等价于</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x^*\cdot x = f^*(x^*) + f^{**}(x).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msup data-latex=f^{**} space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x^*\cdot x = f^*(x^*) + f^{**}(x)." display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex="=">=</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
x^*\cdot x = f^*(x^*) + f^{**}(x).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>再次应用第一部分的结论，它们也就等价于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\partial f^*(x^*)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\partial space=4><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\partial f^*(x^*)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\partial>∂</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x\in\partial f^*(x^*)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p></details><p data-original-document-end=13596 data-original-document-start=13463>这一结论说明，如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^{**}=f" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^{**}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={**} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^{**}=f" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^{**}><mi data-latex=f>f</mi><mrow data-latex={**} data-mjx-texclass=ORD><mo data-latex=*>∗</mo><mo data-latex=*>∗</mo></mrow></msup><mo data-latex="=">=</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="f^{**}=f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么凸共轭 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f^*><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f^*></mjx-container> 在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 处的次微分 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\partial f^{*}(x^*)" aria-hidden=true class=NCM-N><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-msup data-latex=f^{*}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-texatom data-latex={*} size=s texclass=ORD><mjx-mo data-latex=*><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\partial f^{*}(x^*)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><msup data-latex=f^{*}><mi data-latex=f>f</mi><mrow data-latex={*} data-mjx-texclass=ORD><mo data-latex=*>∗</mo></mrow></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\partial f^{*}(x^*)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，恰好就是斜率向量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^*><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^* xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^*></mjx-container> 的支撑超平面与上境图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\operatorname{epi}f><mjx-mi data-latex=\operatorname{epi}><mjx-c class=mjx-c65 noic=true style=padding-top:.657em>e</mjx-c><mjx-c class=mjx-c70 noic=true style=padding-top:.657em>p</mjx-c><mjx-c class=mjx-c69 style=padding-top:.657em>i</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\operatorname{epi}f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\operatorname{epi}>epi</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\operatorname{epi}f></mjx-container> 的交点的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 分量的集合。</p><details class=note data-original-document-end=13694 data-original-document-start=13598 open><summary>推论</summary> <p>对于下半连续的正常凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^d\rightarrow\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^d\rightarrow\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="f:\mathbf R^d\rightarrow\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x,x^*\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x,x^*\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=,>,</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="x,x^*\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\partial f(x) &= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\
\partial f^*(x^*) &= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
\partial f(x) &= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\
\partial f^*(x^*) &= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).
\end{aligned}
" data-latex-item={aligned} style=min-width:14.976em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\arg space=4><mjx-c class=mjx-c61 noic=true style=padding-top:.453em>a</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.453em>r</mjx-c><mjx-c class=mjx-c67 style=padding-top:.453em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-munder data-latex="\max_{y^*\in\mathbf R^d}" space=2><mjx-row><mjx-base style=padding-left:.097em><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y^*\in\mathbf R^d}" size=s texclass=ORD><mjx-msup data-latex=y^*><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.289em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-msup data-latex=y^* space=3><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msup data-latex=f^* space=3><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=y^*><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=\arg space=4><mjx-c class=mjx-c61 noic=true style=padding-top:.453em>a</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.453em>r</mjx-c><mjx-c class=mjx-c67 style=padding-top:.453em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-munder data-latex="\max_{y\in\mathbf R^d}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.057em><mjx-texatom data-latex="{y\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\partial f(x) &= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\\partial f^*(x^*) &= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\partial f(x) &= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\\partial f^*(x^*) &= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=\partial>∂</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=\arg>arg</mi><mo data-mjx-texclass=NONE>⁡</mo><munder data-latex="\max_{y^*\in\mathbf R^d}"><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex="{y^*\in\mathbf R^d}" data-mjx-texclass=ORD><msup data-latex=y^*><mi data-latex=y>y</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><mi data-latex=x>x</mi><mo data-latex=\cdot>⋅</mo><msup data-latex=y^*><mi data-latex=y>y</mi><mo data-latex=*>∗</mo></msup><mo data-latex=->−</mo><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=y^*><mi data-latex=y>y</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd><mi data-latex=\partial>∂</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=\arg>arg</mi><mo data-mjx-texclass=NONE>⁡</mo><munder data-latex="\max_{y\in\mathbf R^d}"><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex="{y\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\partial f(x) &= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\
\partial f^*(x^*) &= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=14222 data-original-document-start=13947><summary>证明</summary> <p>下面，证明第二个等式。第一个等式的证明与之类似。</p> <p>按照凸共轭的定义，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f^*(x^*) = \sup_{y\in\mathbf R^d} x^*\cdot y - f(y),
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\sup_{y\in\mathbf R^d}" space=4><mjx-row><mjx-base style=padding-left:.121em><mjx-mo data-latex=\sup><mjx-c class=mjx-c73 noic=true style=padding-top:.448em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.448em>u</mjx-c><mjx-c class=mjx-c70 style=padding-top:.448em>p</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f^*(x^*) = \sup_{y\in\mathbf R^d} x^*\cdot y - f(y)," display=block xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\sup_{y\in\mathbf R^d}"><mo data-latex=\sup data-mjx-texclass=OP movablelimits=true>sup</mo><mrow data-latex="{y\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
f^*(x^*) = \sup_{y\in\mathbf R^d} x^*\cdot y - f(y),
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>所以，</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
x \in \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y)
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\arg space=4><mjx-c class=mjx-c61 noic=true style=padding-top:.453em>a</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.453em>r</mjx-c><mjx-c class=mjx-c67 style=padding-top:.453em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-munder data-latex="\max_{y\in\mathbf R^d}" space=2><mjx-row><mjx-base><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.057em><mjx-texatom data-latex="{y\in\mathbf R^d}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msup data-latex=x^* space=2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="x \in \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y)" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\arg>arg</mi><mo data-mjx-texclass=NONE>⁡</mo><munder data-latex="\max_{y\in\mathbf R^d}"><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex="{y\in\mathbf R^d}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></mrow></munder><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
x \in \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y)
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f^*(x^*) = x^*\cdot x - f(x)" aria-hidden=true breakable=true class=NCM-N><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msup data-latex=x^* space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f^*(x^*) = x^*\cdot x - f(x)" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f^*(x^*) = x^*\cdot x - f(x)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，而这一等式成立，又当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\partial f^*(x^*)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=\partial space=4><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-msup data-latex=f^*><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.053em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex=x^*><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-mo data-latex=* size=s><mjx-c class=mjx-c2217>∗</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\partial f^*(x^*)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=\partial>∂</mi><msup data-latex=f^*><mi data-latex=f>f</mi><mo data-latex=*>∗</mo></msup><mo data-latex=( stretchy=false>(</mo><msup data-latex=x^*><mi data-latex=x>x</mi><mo data-latex=*>∗</mo></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x\in\partial f^*(x^*)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。这就证明了两个集合是相等的。</p></details><p data-original-document-end=14245 data-original-document-start=14224>应用到本文的场景中，这一结论说明，求解问题</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x) = \min_{y\in g(X)}v(y) - \lambda\cdot y
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in X}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.095em><mjx-texatom data-latex="{x\in X}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=g space=3><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{y\in g(X)}" space=4><mjx-row><mjx-base style=padding-left:.32em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{y\in g(X)}" size=s texclass=ORD><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=y space=3><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x) = \min_{y\in g(X)}v(y) - \lambda\cdot y" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in X}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{y\in g(X)}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{y\in g(X)}" data-mjx-texclass=ORD><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=X>X</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=y>y</mi></math></mjx-assistive-mml><img title="
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x) = \min_{y\in g(X)}v(y) - \lambda\cdot y
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14424 data-original-document-start=14343>时，限制函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=g(x)><mjx-mi data-latex=g><mjx-c class=mjx-c1D454>𝑔</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=g(x) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=g>g</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=g(x)></mjx-container> 在最优决策集合上的取值恰为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\partial(-h(\lambda))><mjx-mi data-latex=\partial><mjx-c class=mjx-c1D715>𝜕</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\partial(-h(\lambda)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\partial>∂</mi><mo data-latex=( stretchy=false>(</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\partial(-h(\lambda))></mjx-container>。对于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="d=1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="d=1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=d>d</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="d=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且问题只涉及整数的情形，这一集合就是区间</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h space=3><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h space=3><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex=[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)]. display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\lambda>λ</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=] stretchy=false>]</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=14534 data-original-document-start=14484>对于连续的整数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\lambda><mjx-mi data-latex=\lambda><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\lambda xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\lambda>λ</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\lambda></mjx-container>，这些区间首尾相接，所以，如果用于二分，只需要计算一侧的端点即可。</p><h2 data-original-document-end=14543 data-original-document-start=14536 id=凸性证明>凸性证明<a title="Permanent link" class=headerlink href=#凸性证明></a></h2><p data-original-document-end=14645 data-original-document-start=14545>应用 WQS 二分的前提条件是价值函数的凸性。在算法竞赛中，可以通过打表、感性理解等方式猜测凸性成立。但是，严格地证明凸性成立，往往并不容易。本节结合如下经典题目，介绍算法竞赛中常见的证明凸性的方法。</p><details class=example data-original-document-end=14817 data-original-document-start=14647 open><summary>种树问题</summary> <p>有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个树坑，要种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树。树不能栽种于相邻的两个坑。给定长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 的序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i\}></mjx-container>，表示在每个坑种树的收益，收益可正可负。求种完这 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树最大可能的收益和。</p> <p>简言之，就是在长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 的链上，求解大小为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的最大权独立集的问题。</p></details><p data-original-document-end=14833 data-original-document-start=14819>这些方法粗略地可以分为四类：</p><ul data-original-document-end=15119 data-original-document-start=14835><li>归约为凸优化问题（包括 <a href=../../../math/linear-programming/>线性规划</a> 等）的价值函数对参数的凸性，这包括建立 <a href=../../../graph/flow/min-cost/>费用流</a> 模型等方法；</li><li>利用状态转移方程也可以归纳地证明凸性成立，过程中可能会用到一些 <a href=../slope-trick/#凸函数的变换>保持凸性的变换</a>；</li><li>对于区间分拆类型的问题，可以验证每段区间的成本函数满足 <a href=../quadrangle/>四边形不等式</a>；</li><li>最后，对于特殊的问题，也可以通过交换论证直接说明凸性成立。</li></ul><p data-original-document-end=15147 data-original-document-start=15121>这些证明方法本身往往都同该问题的某种解法联系在一起。</p><h3 data-original-document-end=15161 data-original-document-start=15149 id=归约为含参凸优化>归约为含参凸优化<a title="Permanent link" class=headerlink href=#归约为含参凸优化></a></h3><p data-original-document-end=15178 data-original-document-start=15163>考虑如下形式的含参凸优化问题：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(y)=\inf_{x\in\mathcal D(y)} f(x,y).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\inf_{x\in\mathcal D(y)}" space=4><mjx-row><mjx-base style=padding-left:.663em><mjx-mo data-latex=\inf><mjx-c class=mjx-c69 noic=true style=padding-top:.705em>i</mjx-c><mjx-c class=mjx-c6E noic=true style=padding-top:.705em>n</mjx-c><mjx-c class=mjx-c66 style=padding-top:.705em>f</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in\mathcal D(y)}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(y)=\inf_{x\in\mathcal D(y)} f(x,y)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\inf_{x\in\mathcal D(y)}"><mo data-latex=\inf data-mjx-texclass=OP movablelimits=true>inf</mo><mrow data-latex="{x\in\mathcal D(y)}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v(y)=\inf_{x\in\mathcal D(y)} f(x,y).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=15534 data-original-document-start=15225>其中，目标函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathbf R^n\times\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^n" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=3> </mjx-break><mjx-mo data-latex=\times><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=3><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathbf R^n\times\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><msup data-latex="\mathbf R^n"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=n>n</mi></msup><mo data-latex=\times>×</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="f:\mathbf R^n\times\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 对于每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in\mathbf R^m" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^m" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in\mathbf R^m" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^m"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=m>m</mi></msup></math></mjx-assistive-mml><img title="x\in\mathbf R^m" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的凸函数，而可行域 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D:\mathbf R^d\rightarrow \mathcal P(\mathbf R^m)" aria-hidden=true breakable=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal P" space=4 texclass=ORD><mjx-mi data-latex=P><mjx-c class="mjx-c50 NCM-C">P</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^m"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=m size=s><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D:\mathbf R^d\rightarrow \mathcal P(\mathbf R^m)" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathcal P" data-mjx-texclass=ORD><mi data-latex=P data-mjx-variant=-tex-calligraphic mathvariant=script>P</mi></mrow><mo data-latex=( stretchy=false>(</mo><msup data-latex="\mathbf R^m"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=m>m</mi></msup><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\mathcal D:\mathbf R^d\rightarrow \mathcal P(\mathbf R^m)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf R^d" aria-hidden=true class=NCM-N><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上的集合值函数，且对于每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D(y)" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D(y)" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\mathcal D(y)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都是凸集。这些条件保证了对于任意参数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，这都是一个凸优化问题。</p><details class=note data-original-document-end=15778 data-original-document-start=15536 open><summary>定理</summary> <p>假设上述含参凸优化问题满足如下条件：</p> <ol><li>目标函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(x,y)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(x,y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(x,y)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(x,y)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(x,y) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(x,y)></mjx-container> 的凸函数；</li><li>可行域映射 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\mapsto\mathcal D(y)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\mapsto><mjx-c class=mjx-c21A6>↦</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal D" space=4 texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\mapsto\mathcal D(y)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\mapsto stretchy=false>↦</mo><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="y\mapsto\mathcal D(y)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的图像 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\{(x,y):x\in\mathcal D(y)\}" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-mi data-latex=x space=4><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal D" space=4 texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\{(x,y):x\in\mathcal D(y)\}" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=x>x</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=:>:</mo><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="\{(x,y):x\in\mathcal D(y)\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是凸集。</li></ol> <p>如果对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(y)>-\infty" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(y)>-\infty" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=">">></mo><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img title="v(y)>-\infty" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么，价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 的正常凸函数。</p></details><details class=note data-original-document-end=16815 data-original-document-start=15946><summary>证明</summary> <p>对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y_1,y_2\in\mathbf R^d" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y_1,y_2\in\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="y_1,y_2\in\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\alpha\in(0,1)><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\alpha\in(0,1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><mo data-latex=\in>∈</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\alpha\in(0,1)></mjx-container>，需要证明</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=\alpha>α</mi><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(y_1)=+\infty" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(y_1)=+\infty" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img title="v(y_1)=+\infty" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 或 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(y_2)=+\infty" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(y_2)=+\infty" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img title="v(y_2)=+\infty" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，那么不等式的右侧就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+\infty><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+\infty xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+\infty></mjx-container>，不等式必然成立。否则，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y_1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y_1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y_1)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y_2)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y_2) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y_2)></mjx-container> 都是有限值。对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\varepsilon>0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\varepsilon><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=">"><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\varepsilon>0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\varepsilon>ε</mi><mo data-latex=">">></mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="\varepsilon>0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=2>2</mn></math></mjx-assistive-mml><img title="i=1,2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都存在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x_i\in\mathcal D(y_i)" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=x_i><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal D" space=4 texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_i><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x_i\in\mathcal D(y_i)" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=x_i><mi data-latex=x>x</mi><mi data-latex=i>i</mi></msub><mo data-latex=\in>∈</mo><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_i><mi data-latex=y>y</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="x_i\in\mathcal D(y_i)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(x_i,y_i)< v(y_i)+\varepsilon" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_i><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_i space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=v space=4><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_i><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(x_i,y_i)< v(y_i)+\varepsilon" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_i><mi data-latex=x>x</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><msub data-latex=y_i><mi data-latex=y>y</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="<">&lt;</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_i><mi data-latex=y>y</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi></math></mjx-assistive-mml><img title="f(x_i,y_i)< v(y_i)+\varepsilon" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立。利用映射 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal D" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal D" texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal D" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow></math></mjx-assistive-mml><img title="\mathcal D" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的图像的凸性可知</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\alpha x_1+(1-\alpha)x_2 \in \mathcal D(\alpha y_1+(1-\alpha)y_2).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal D" space=4 texclass=ORD><mjx-mi data-latex=D><mjx-c class="mjx-c44 NCM-C">D</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\alpha x_1+(1-\alpha)x_2 \in \mathcal D(\alpha y_1+(1-\alpha)y_2)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=\in>∈</mo><mrow data-latex="\mathcal D" data-mjx-texclass=ORD><mi data-latex=D data-mjx-variant=-tex-calligraphic mathvariant=script>D</mi></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\alpha x_1+(1-\alpha)x_2 \in \mathcal D(\alpha y_1+(1-\alpha)y_2).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>也就是说，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha x_1+(1-\alpha)x_2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha x_1+(1-\alpha)x_2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img title="\alpha x_1+(1-\alpha)x_2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\alpha y_1+(1-\alpha)y_2" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\alpha y_1+(1-\alpha)y_2" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img title="\alpha y_1+(1-\alpha)y_2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的最优化问题的一个可行解。利用最优化条件和目标函数的凸性可知</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
v(\alpha y_1+(1-\alpha)y_2)
&\le f(\alpha x_1+(1-\alpha)x_2,\alpha y_1+(1-\alpha)y_2) \\
&\le \alpha f(x_1,y_1) + (1-\alpha)f(x_2,y_2) \\
&< \alpha v(y_1) + (1-\alpha) v(y_2) + \varepsilon.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
v(\alpha y_1 +(1-\alpha)y_2 )
&\le f(\alpha x_1 +(1-\alpha)x_2 ,\alpha y_1 +(1-\alpha)y_2 ) \\
&\le \alpha f(x_1 ,y_1 ) + (1-\alpha)f(x_2 ,y_2 ) \\
&< \alpha v(y_1 ) + (1-\alpha) v(y_2 ) + \varepsilon.
\end{aligned}
" data-latex-item={aligned} style=min-width:25.103em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=2><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_1><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=x_2><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="<" space=4><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\varepsilon space=3><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}v(\alpha y_1+(1-\alpha)y_2)&\le f(\alpha x_1+(1-\alpha)x_2,\alpha y_1+(1-\alpha)y_2) \\&\le \alpha f(x_1,y_1) + (1-\alpha)f(x_2,y_2) \\&< \alpha v(y_1) + (1-\alpha) v(y_2) + \varepsilon.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}v(\alpha y_1 +(1-\alpha)y_2 )&\le f(\alpha x_1 +(1-\alpha)x_2 ,\alpha y_1 +(1-\alpha)y_2 ) \\&\le \alpha f(x_1 ,y_1 ) + (1-\alpha)f(x_2 ,y_2 ) \\&< \alpha v(y_1 ) + (1-\alpha) v(y_2 ) + \varepsilon.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\le>≤</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\alpha>α</mi><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex=\le>≤</mo><mi data-latex=\alpha>α</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_1><mi data-latex=x>x</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=x_2><mi data-latex=x>x</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="<">&lt;</mo><mi data-latex=\alpha>α</mi><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\varepsilon>ε</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
v(\alpha y_1+(1-\alpha)y_2)
&\le f(\alpha x_1+(1-\alpha)x_2,\alpha y_1+(1-\alpha)y_2) \\
&\le \alpha f(x_1,y_1) + (1-\alpha)f(x_2,y_2) \\
&< \alpha v(y_1) + (1-\alpha) v(y_2) + \varepsilon.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\varepsilon><mjx-mi data-latex=\varepsilon><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\varepsilon xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\varepsilon>ε</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\varepsilon></mjx-container> 的选取是任意的，令 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\varepsilon\rightarrow 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=\varepsilon><mjx-c class=mjx-c1D700>𝜀</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\varepsilon\rightarrow 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\varepsilon>ε</mi><mo data-latex=\rightarrow stretchy=false>→</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="\varepsilon\rightarrow 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，就有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=4><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\alpha space=3><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\alpha>α</mi><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=\alpha>α</mi><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mi data-latex=\alpha>α</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 的凸性成立。</p></details><p data-original-document-end=16842 data-original-document-start=16817>算法竞赛中，最为常见的凸优化问题就是线性规划问题。</p><details class=note data-original-document-end=17174 data-original-document-start=17128 open><summary>推论</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="c\in\mathbf R^n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^n" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="c\in\mathbf R^n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=c>c</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^n"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img title="c\in\mathbf R^n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="A_1\in\mathbf R^{d_1\times n}" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=A_1><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^{d_1\times n}" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-texatom data-latex="{d_1\times n}" size=s texclass=ORD><mjx-msub data-latex=d_1><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\times><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="A_1\in\mathbf R^{d_1\times n}" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=A_1><mi data-latex=A>A</mi><mn data-latex=1>1</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^{d_1\times n}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex="{d_1\times n}" data-mjx-texclass=ORD><msub data-latex=d_1><mi data-latex=d>d</mi><mn data-latex=1>1</mn></msub><mo data-latex=\times>×</mo><mi data-latex=n>n</mi></mrow></msup></math></mjx-assistive-mml><img title="A_1\in\mathbf R^{d_1\times n}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="A_2\in\mathbf R^{d_2\times n}" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=A_2><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^{d_2\times n}" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-texatom data-latex="{d_2\times n}" size=s texclass=ORD><mjx-msub data-latex=d_2><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\times><mjx-c class=mjx-cD7>×</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="A_2\in\mathbf R^{d_2\times n}" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=A_2><mi data-latex=A>A</mi><mn data-latex=2>2</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^{d_2\times n}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex="{d_2\times n}" data-mjx-texclass=ORD><msub data-latex=d_2><mi data-latex=d>d</mi><mn data-latex=2>2</mn></msub><mo data-latex=\times>×</mo><mi data-latex=n>n</mi></mrow></msup></math></mjx-assistive-mml><img title="A_2\in\mathbf R^{d_2\times n}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y_1\in\mathbf R^{d_1}" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^{d_1}" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={d_1} size=s texclass=ORD><mjx-msub data-latex=d_1><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y_1\in\mathbf R^{d_1}" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^{d_1}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex={d_1} data-mjx-texclass=ORD><msub data-latex=d_1><mi data-latex=d>d</mi><mn data-latex=1>1</mn></msub></mrow></msup></math></mjx-assistive-mml><img title="y_1\in\mathbf R^{d_1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="y_2\in\mathbf R^{d_2}" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=y_2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^{d_2}" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={d_2} size=s texclass=ORD><mjx-msub data-latex=d_2><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="y_2\in\mathbf R^{d_2}" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^{d_2}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex={d_2} data-mjx-texclass=ORD><msub data-latex=d_2><mi data-latex=d>d</mi><mn data-latex=2>2</mn></msub></mrow></msup></math></mjx-assistive-mml><img title="y_2\in\mathbf R^{d_2}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。考虑如下含参线性规划问题：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(y_1,y_2)=\min_{x\in\mathbf R^n} c\cdot x \text{ subject to }A_1x\le y_1,A_2x=y_2,x\ge 0.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{x\in\mathbf R^n}" space=4><mjx-row><mjx-base style=padding-left:.089em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{x\in\mathbf R^n}" size=s texclass=ORD><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^n"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.289em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=\cdot space=3><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mi data-latex=x space=3><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mtext data-latex="\text{ subject to }"><mjx-c class=mjx-cA0 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-msub data-latex=A_1><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msub data-latex=y_1 space=4><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=A_2 space=2><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=4><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mn data-latex=. space=4><mjx-c class=mjx-c30 noic=true style=padding-top:.666em>0</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(y_1,y_2)=\min_{x\in\mathbf R^n} c\cdot x \text{ subject to }A_1x\le y_1,A_2x=y_2,x\ge 0." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{x\in\mathbf R^n}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{x\in\mathbf R^n}" data-mjx-texclass=ORD><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><msup data-latex="\mathbf R^n"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=n>n</mi></msup></mrow></munder><mi data-latex=c>c</mi><mo data-latex=\cdot>⋅</mo><mi data-latex=x>x</mi><mtext data-latex="\text{ subject to }"> subject to </mtext><msub data-latex=A_1><mi data-latex=A>A</mi><mn data-latex=1>1</mn></msub><mi data-latex=x>x</mi><mo data-latex=\le>≤</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=A_2><mi data-latex=A>A</mi><mn data-latex=2>2</mn></msub><mi data-latex=x>x</mi><mo data-latex="=">=</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><mi data-latex=x>x</mi><mo data-latex=\ge>≥</mo><mn data-latex=.>0.</mn></math></mjx-assistive-mml><img title="
v(y_1,y_2)=\min_{x\in\mathbf R^n} c\cdot x \text{ subject to }A_1x\le y_1,A_2x=y_2,x\ge 0.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>那么，价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y_1,y_2)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y_1,y_2) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y_1,y_2)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(y_1,y_2)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=y_1><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=y_2 space=2><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(y_1,y_2) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=y_1><mi data-latex=y>y</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=y_2><mi data-latex=y>y</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(y_1,y_2)></mjx-container> 的凸函数。</p></details><p data-original-document-end=17214 data-original-document-start=17176>无论是不等式约束，还是等式约束，线性规划的价值函数都是约束条件参数的凸函数。</p><p data-original-document-end=17237 data-original-document-start=17216>很多图论问题都可以写成线性规划问题的形式：</p><ul data-original-document-end=17342 data-original-document-start=17239><li>网络流问题：最大流、最小割、最小费用流；</li><li>无负环的最短路问题；</li><li>二分图的最大（权）匹配、最小点覆盖等问题；</li><li>一般图的最大（权）匹配问题；</li><li>最小生成树问题<sup id=fnref:mst><a class=footnote-ref href=#fn:mst>3</a></sup>。</li></ul><p data-original-document-end=17373 data-original-document-start=17344>因此，这些问题的价值函数都是这些问题的参数的凸（凹）函数。</p><details class=warning data-original-document-end=17823 data-original-document-start=17375 open><summary>整数约束</summary> <p>利用图论模型为实际问题建模时，通常有隐含的整数限制，例如一条边只能选或不选、流量只能是整数等。因此，它们只能转化为整数线性规划（integer linear programming, ILP）问题而非线性规划（LP）问题。因为 ILP 问题并非凸优化问题，所以它的价值函数未必是该问题的参数的凸函数。将一个 ILP 问题中的整数约束松弛掉后就得到一个 LP 问题，但后者未必存在满足整数约束的最优解。因此，松弛整数约束后得到的 LP 的最优价值有可能严格优于相应的 ILP 问题，两者未必等价。</p> <p>上文列举的那些图论问题，都可以写成一个 LP 问题而不需要施加整数约束；但对于其他的一些问题，例如一般图的最大独立集问题等，整数约束则是必要的。另外，即使一个图论问题可以写成 LP 的形式，在该问题引入额外的线性约束条件后，仍然可能会破坏相应的 ILP 问题和 LP 问题的等价性，从而这个带约束的图论问题不再能够写成线性规划的形式。</p></details><p data-original-document-end=17845 data-original-document-start=17825>例如，在费用流的语境下，有如下常见结论：</p><details class=note open><summary>推论</summary> <p><a href=../../../graph/flow/min-cost/>最小费用流模型</a> 中，最小费用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是流量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凸函数。</p></details><details class=note data-original-document-end=18502 data-original-document-start=18470><summary>证明</summary> <p>设有向图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="G=(V,E)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=G><mjx-c class=mjx-c1D43A>𝐺</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=E space=2><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="G=(V,E)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=G>G</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=V>V</mi><mo data-latex=,>,</mo><mi data-latex=E>E</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="G=(V,E)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(i,j)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(i,j)></mjx-container> 的容量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=c_{ij}><mjx-msub data-latex=c_{ij}><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=c_{ij} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=c_{ij}><mi data-latex=c>c</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=c_{ij}></mjx-container>，单位流量的费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=w_{ij}><mjx-msub data-latex=w_{ij}><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=w_{ij} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=w_{ij}><mi data-latex=w>w</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=w_{ij}></mjx-container>,，源点和汇点分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=s><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=s xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=s>s</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=s></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=t><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=t xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=t></mjx-container>。记决策变量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{f_{ij}\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex="f_{i j}"><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{f_{ij}\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex="f_{i j}"><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{f_{ij}\}></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f_{ij}><mjx-msub data-latex=f_{ij}><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f_{ij} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=f_{ij}><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f_{ij}></mjx-container> 为边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="(i,j)\in E" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=E space=4><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="(i,j)\in E" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mi data-latex=E>E</mi></math></mjx-assistive-mml><img title="(i,j)\in E" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的流量。那么，最小费用流可以写成如下线性规划问题：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
v(m)=\min_{\{f_{ij}\}}\;&\sum_{(i,j)\in E}w_{ij}f_{ij}\\
\text{subject to }&\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = 
\begin{cases}
-m, & i=s,\\
m,  & i=t,\\
0,  & \text{otherwise},
\end{cases}
~\forall i\in V,\\
&0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
v(m)=\min_{\{f_{ij}\}}\;&\sum_{(i,j)\in E}w_{ij}f_{ij}\\
\text{subject to }&\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = 
\begin{cases}
-m, & i=s,\\
m,  & i=t,\\
0,  & \text{otherwise},
\end{cases}
~\forall i\in V,\\
&0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.
\end{aligned}
" data-latex-item={aligned} style=min-width:27.416em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{\{f_{i j}\}}" space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.088em><mjx-texatom data-latex="{\{f_{i j}\}}" size=s texclass=ORD><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex="f_{i j}"><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mspace data-latex=\; style=width:.278em></mjx-mspace><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-munder data-latex="\sum_{(i,j)\in E}" space=2><mjx-row><mjx-base style=padding-left:.426em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{(i,j)\in E}" size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex="w_{i j}" space=2><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-msub data-latex="f_{i j}"><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-bottom:.15em;padding-right:0><mjx-mtext data-latex="\text{subject to }"><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-munder data-latex="\sum_{(j,i)\in E}" space=2><mjx-row><mjx-base style=padding-left:.426em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{(j,i)\in E}" size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex="f_{j i}" space=2><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{j i}" size=s texclass=ORD><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{(i,j)\in E}" space=3><mjx-row><mjx-base style=padding-left:.426em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{(i,j)\in E}" size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex="f_{i j}" space=2><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} data-latex-item={cases} space=4><mjx-mo><mjx-stretchy-v class=mjx-c7B style=vertical-align:-1.45em;height:3.4em><mjx-beg>⎧</mjx-beg><mjx-ext class=NCM-EM><mjx-spacer>{ {</mjx-spacer></mjx-ext><mjx-mid>⎨</mjx-mid><mjx-ext class=NCM-EM><mjx-spacer>{ {</mjx-spacer></mjx-ext><mjx-end>⎩</mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable justify=left style=min-width:7.331em><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=s space=4><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=text-align:left;padding-top:.1em;padding-bottom:.1em;padding-right:.5em><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=t space=4><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mtext data-latex=\text{otherwise}><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c68 noic=true style=padding-top:.694em>h</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c72 noic=true style=padding-top:.694em>r</mjx-c><mjx-c class=mjx-c77 noic=true style=padding-top:.694em>w</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.694em>i</mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c65 style=padding-top:.694em>e</mjx-c></mjx-mtext><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=\forall><mjx-c class=mjx-c2200>∀</mjx-c></mjx-mi><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=V space=4><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msub data-latex="f_{i j}" space=4><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.062em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msub data-latex="c_{i j}" space=4><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{i j}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=\forall><mjx-c class=mjx-c2200>∀</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=E space=4><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}v(m)=\min_{\{f_{ij}\}}\;&\sum_{(i,j)\in E}w_{ij}f_{ij}\\\text{subject to }&\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = \begin{cases}-m, & i=s,\\m,  & i=t,\\0,  & \text{otherwise},\end{cases}~\forall i\in V,\\&0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}v(m)=\min_{\{f_{ij}\}}\;&\sum_{(i,j)\in E}w_{ij}f_{ij}\\\text{subject to }&\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = \begin{cases}-m, & i=s,\\m,  & i=t,\\0,  & \text{otherwise},\end{cases}~\forall i\in V,\\&0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{\{f_{i j}\}}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{\{f_{i j}\}}" data-mjx-texclass=ORD><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex="f_{i j}"><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><mo data-latex=\} fence=false stretchy=false>}</mo></mrow></munder><mspace data-latex=\; width=0.278em></mspace></mtd><mtd><mstyle indentshift=2em><mi></mi><munder data-latex="\sum_{(i,j)\in E}"><mo data-latex=\sum>∑</mo><mrow data-latex="{(i,j)\in E}" data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mi data-latex=E>E</mi></mrow></munder><msub data-latex="w_{i j}"><mi data-latex=w>w</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><msub data-latex="f_{i j}"><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd><mtext data-latex="\text{subject to }">subject to </mtext></mtd><mtd><mstyle indentshift=2em><mi></mi><munder data-latex="\sum_{(j,i)\in E}"><mo data-latex=\sum>∑</mo><mrow data-latex="{(j,i)\in E}" data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=j>j</mi><mo data-latex=,>,</mo><mi data-latex=i>i</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mi data-latex=E>E</mi></mrow></munder><msub data-latex="f_{j i}"><mi data-latex=f>f</mi><mrow data-latex="{j i}" data-mjx-texclass=ORD><mi data-latex=j>j</mi><mi data-latex=i>i</mi></mrow></msub><mo data-latex=->−</mo><munder data-latex="\sum_{(i,j)\in E}"><mo data-latex=\sum>∑</mo><mrow data-latex="{(i,j)\in E}" data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mi data-latex=E>E</mi></mrow></munder><msub data-latex="f_{i j}"><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><mo data-latex="=">=</mo><mrow data-latex={cases} data-latex-item={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mo data-latex=->−</mo><mi data-latex=m>m</mi><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mi data-latex=s>s</mi><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mi data-latex=m>m</mi><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mi data-latex=t>t</mi><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mn data-latex=0>0</mn><mo data-latex=,>,</mo></mtd><mtd><mtext data-latex=\text{otherwise}>otherwise</mtext><mo data-latex=,>,</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow><mtext data-latex=~> </mtext><mi data-latex=\forall mathvariant=normal>∀</mi><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mi data-latex=V>V</mi><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mn data-latex=0>0</mn><mo data-latex=\le>≤</mo><msub data-latex="f_{i j}"><mi data-latex=f>f</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><mo data-latex=\le>≤</mo><msub data-latex="c_{i j}"><mi data-latex=c>c</mi><mrow data-latex="{i j}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mi data-latex=j>j</mi></mrow></msub><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=\forall mathvariant=normal>∀</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\in>∈</mo><mi data-latex=E>E</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
v(m)=\min_{\{f_{ij}\}}\;&\sum_{(i,j)\in E}w_{ij}f_{ij}\\
\text{subject to }&\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = 
\begin{cases}
-m, & i=s,\\
m,  & i=t,\\
0,  & \text{otherwise},
\end{cases}
~\forall i\in V,\\
&0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>因此，最小费用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是参数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凸函数。</p></details><p data-original-document-end=18550 data-original-document-start=18504>算法竞赛中很多问题都可以归约为网络流等图论问题，从而都可以通过类似的方式建立价值函数的凸性。</p><p data-original-document-end=18576 data-original-document-start=18552>利用这一方法，可以得到种树问题的第一个凸性证明：</p><details class=example data-original-document-end=19161 data-original-document-start=18578><summary>凸性证明一</summary> <p>种树问题的最大收益实际上可以通过如下最大费用最大流模型得出：</p> <ul><li>从源点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=s><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=s xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=s>s</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=s></mjx-container> 出发，向结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container>，连接一条容量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container>、费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 的边；</li><li>从结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=r><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=r xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=r>r</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=r></mjx-container> 出发，向每个奇数结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,3,\cdots,2\lceil n/2\rceil-1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=3 space=2><mjx-c class=mjx-c33>3</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\lceil><mjx-c class=mjx-c2308>⌈</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rceil><mjx-c class=mjx-c2309>⌉</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,3,\cdots,2\lceil n/2\rceil-1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=3>3</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=\lceil fence=false stretchy=false>⌈</mo><mi data-latex=n>n</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rceil fence=false stretchy=false>⌉</mo><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="i=1,3,\cdots,2\lceil n/2\rceil-1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 连接一条容量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container>、费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 的边；</li><li>从每个偶数结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=0,2,\cdots,2\lfloor n/2\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=2 space=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=0,2,\cdots,2\lfloor n/2\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mn data-latex=2>2</mn><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=n>n</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="i=0,2,\cdots,2\lfloor n/2\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 出发，向汇点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=t><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=t xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=t></mjx-container> 连接一条容量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container>、费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 的边；</li><li>对于每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，从 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=i-1><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i-1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 中的奇数结点出发，向偶数结点连接一条容量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container>、费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a_i><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a_i></mjx-container> 的边。</li></ul> <p>最终答案就是求得的最大费用。将这一图论模型转换为相应的线性规划问题（具体见上文推论的证明），那么，总流量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 将出现在表示边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(s,r)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(s,r) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=s>s</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(s,r)></mjx-container> 的流量限制的不等式中。由推论可知，最大费用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是流量 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凹函数。</p> <p>利用该费用流模型，可以通过模拟费用流或 <a href=../../../basic/greedy/#后悔解法>反悔贪心</a> 的方法在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(n\log n)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(n\log n)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(n\log n)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的复杂度内解决该问题。</p></details><h3 data-original-document-end=19175 data-original-document-start=19163 id=利用状态转移方程>利用状态转移方程<a title="Permanent link" class=headerlink href=#利用状态转移方程></a></h3><p data-original-document-end=19430 data-original-document-start=19177>尽管状态转移方程无法提供有效的计算方式，但是，它常常可以用于证明状态函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container> 对于参数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 具有凸性。具体地说，就是将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container> 这一函数视为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 处的状态，就可以将关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container> 的状态转移方程看作是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container> 的递推关系，从而可以归纳地证明每个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container> 都是凸函数。这类证明凸性的方法在 <a href=../slope-trick/>Slope Trick 优化 DP</a> 的场景中更为常见，该页面也讨论了常见的保持凸性的变换。</p><p data-original-document-end=19452 data-original-document-start=19432>这一方法同样可以用于证明种树问题的凸性：</p><details class=example data-original-document-end=20704 data-original-document-start=19454><summary>凸性证明二</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container> 为前 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个坑种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 棵树时的最大收益。考察如下状态转移方程：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i,j) = \max\{f(i-1,j),f(i-2,j-1)+a_i\}.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\max space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_i space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i,j) = \max\{f(i-1,j),f(i-2,j-1)+a_i\}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
f(i,j) = \max\{f(i-1,j),f(i-2,j-1)+a_i\}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>将这一状态转移方程看作是函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container> 的递推关系式。因为最值符号内涉及两个不同的函数，这并不能表达为卷积上确界的形式。但是，仍然可以通过归纳的方法证明函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container> 是凹函数。</p> <p>实际上，需要归纳地证明如下两点：</p> <ul><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,j)-f(i-2,j-1)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j)-f(i-2,j-1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)-f(i-2,j-1)></mjx-container> 关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递减；</li><li><mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,j)-f(i-1,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j)-f(i-1,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)-f(i-1,j)></mjx-container> 关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递增。</li></ul> <p>归纳起点是平凡的。假设它们对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=i-1><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i-1></mjx-container> 及之前的自然数都成立，现在证明它对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 也成立。直接验证即可。</p> <p>首先，由归纳假设，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i-1,j) - f(i-2,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j)-f(i-1,j))
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i-1,j) - f(i-2,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j)-f(i-1,j))" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
f(i-1,j) - f(i-2,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j)-f(i-1,j))
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递减。所以，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i,j) - f(i-2,j-1) = \max\{f(i-1,j) - f(i-2,j-1), a_i\}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\max space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i,j) - f(i-2,j-1) = \max\{f(i-1,j) - f(i-2,j-1), a_i\}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="
f(i,j) - f(i-2,j-1) = \max\{f(i-1,j) - f(i-2,j-1), a_i\}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递减，且</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i,j) - f(i-1,j) = \max\{0,a_i-(f(i,j) - f(i-2,j-1))\}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\max space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i,j) - f(i-1,j) = \max\{0,a_i-(f(i,j) - f(i-2,j-1))\}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="
f(i,j) - f(i-1,j) = \max\{0,a_i-(f(i,j) - f(i-2,j-1))\}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递增。这就完成了归纳。</p> <p>进而，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i,j) - f(i,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j-1) - f(i-1,j-1)) - (f(i-1,j-1) - f(i-2,j-1))
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i,j) - f(i,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j-1) - f(i-1,j-1)) - (f(i-1,j-1) - f(i-2,j-1))" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="
f(i,j) - f(i,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j-1) - f(i-1,j-1)) - (f(i-1,j-1) - f(i-2,j-1))
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 递减。这就说明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=j><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=j xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=j></mjx-container> 的凹函数，从而，价值函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(m)=f(n,m)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(m)=f(n,m)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="v(m)=f(n,m)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凹函数。</p> <p>这个证明的一个副产品是，对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container>，都存在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=p_i><mjx-msub data-latex=p_i><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=p_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=p_i></mjx-container> 使得</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
f(i,j) =
\begin{cases}
f(i-1,j), & j\le p_i,\\
f(i-2,j-1) + a_i, & j> p_i.
\end{cases}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mrow data-latex={cases} data-latex-item={cases} space=4><mjx-mo><mjx-c class="mjx-c7B NCM-S5">{</mjx-c></mjx-mo><mjx-mtable style=min-width:12.186em><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-right:.5em><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.1em;padding-left:.5em><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msub data-latex=p_i space=4><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=text-align:left;padding-top:.1em;padding-right:.5em><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=2 space=3><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_i space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.1em;padding-left:.5em><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=">" space=4><mjx-c class=mjx-c3E>></mjx-c></mjx-mo><mjx-msub data-latex=p_i space=4><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo style=vertical-align:.25em;margin-right:.12em></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="f(i,j) =\begin{cases}f(i-1,j), & j\le p_i,\\f(i-2,j-1) + a_i, & j> p_i.\end{cases}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mrow data-latex={cases} data-latex-item={cases} data-mjx-texclass=INNER><mo data-mjx-texclass=OPEN>{</mo><mtable columnalign="left left" columnspacing=1em rowspacing=.2em><mtr><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=j>j</mi><mo data-latex=\le>≤</mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo></mtd></mtr><mtr><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=2>2</mn><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo></mtd><mtd><mi data-latex=j>j</mi><mo data-latex=">">></mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><mo data-latex=.>.</mo></mtd></mtr></mtable><mo data-mjx-texclass=CLOSE fence=true stretchy=true symmetric=true></mo></mrow></math></mjx-assistive-mml><img title="
f(i,j) =
\begin{cases}
f(i-1,j), & j\le p_i,\\
f(i-2,j-1) + a_i, & j> p_i.
\end{cases}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这说明，可以通过平衡树直接维护序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(i,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,\cdot)></mjx-container>，复杂度是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^2n)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^2 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^2n) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^2><mi data-latex=\log>log</mi><mn data-latex=2>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^2n)></mjx-container> 的。但是，好处是可以处理任意种树间隔的一般情形，且一次性地获得了所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的值。</p></details><h3 data-original-document-end=20716 data-original-document-start=20706 id=四边形不等式>四边形不等式<a title="Permanent link" class=headerlink href=#四边形不等式></a></h3><p data-original-document-end=20889 data-original-document-start=20718>算法竞赛中，另一类常见的成立凸性的问题是 <a href=../quadrangle/#区间分拆问题>区间分拆问题</a>。该页面证明了，如果单个区间的成本函数满足四边形不等式，那么限制区间个数的区间分拆问题的最小成本是区间个数的凸函数。该页面同样提供了一些判断某个函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=w(l,r)><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=w(l,r) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=w(l,r)></mjx-container> 是否满足四边形不等式的方法。最为直接的方法就是计算它的二阶混合差分：</p><mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
\Delta_l \Delta_r w(l,r) &= \Delta_l(w(l,r+1)-w(l,r)) \\
&= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
\Delta_l \Delta_r w(l,r) &= \Delta_l(w(l,r+1)-w(l,r)) \\
&= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).
\end{aligned}
" data-latex-item={aligned} style=min-width:27.969em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-msub data-latex=\Delta_l><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=l size=s><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub data-latex=\Delta_r><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=\Delta_l space=4><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=l size=s><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=w space=4><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}\Delta_l \Delta_r w(l,r) &= \Delta_l(w(l,r+1)-w(l,r)) \\&= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}\Delta_l \Delta_r w(l,r) &= \Delta_l(w(l,r+1)-w(l,r)) \\&= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><msub data-latex=\Delta_l><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=l>l</mi></msub><msub data-latex=\Delta_r><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=r>r</mi></msub><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><msub data-latex=\Delta_l><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=l>l</mi></msub><mo data-latex=( stretchy=false>(</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
\Delta_l \Delta_r w(l,r) &= \Delta_l(w(l,r+1)-w(l,r)) \\
&= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container><p data-original-document-end=21138 data-original-document-start=21025>函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=w(l,r)><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=w(l,r) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=w(l,r)></mjx-container> 满足四边形不等式，当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\Delta_l \Delta_r w(l,r)" aria-hidden=true class=NCM-N><mjx-msub data-latex=\Delta_l><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=l size=s><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub data-latex=\Delta_r><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\Delta_l \Delta_r w(l,r)" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\Delta_l><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=l>l</mi></msub><msub data-latex=\Delta_r><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=r>r</mi></msub><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\Delta_l \Delta_r w(l,r)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 非正。直观上，满足四边形不等式的函数通常意味着，区间向两侧扩大——即左端点向左移动和右端点向右移动——具有某种协同效应。</p><p data-original-document-end=21177 data-original-document-start=21140>种树问题同样可以看作是一个区间分拆问题，可以通过验证四边形不等式进行证明。</p><details class=example data-original-document-end=21993 data-original-document-start=21179><summary>凸性证明三</summary> <p>在种树的收益序列前添加一个 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a_0><mjx-msub data-latex="a_0 "><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a_0 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="a_0 "><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a_0></mjx-container>，它可以是任何值。然后，种树问题就等价于将序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_0,a_1,\cdots,a_n\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_0><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=0 size=s><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_1 space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=a_n space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_0,a_1,\cdots,a_n\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_0><mi data-latex=a>a</mi><mn data-latex=0>0</mn></msub><mo data-latex=,>,</mo><msub data-latex=a_1><mi data-latex=a>a</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><msub data-latex=a_n><mi data-latex=a>a</mi><mi data-latex=n>n</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_0,a_1,\cdots,a_n\}></mjx-container> 分成 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 段，且每段的收益函数为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
w(l,r) = \max_{i\in[l+1,r]} a_i
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_{i\in[l+1,r]} space=4><mjx-row><mjx-base style=padding-left:.439em><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={i\in[l+1,r]} size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="w(l,r) = \max_{i\in[l+1,r]} a_i" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\max_{i\in[l+1,r]}><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex={i\in[l+1,r]} data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mo data-latex=[ stretchy=false>[</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=] stretchy=false>]</mo></mrow></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img title="
w(l,r) = \max_{i\in[l+1,r]} a_i
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>的区间分拆问题。也就是说，每一段的收益是除去第一棵树外，其余树的收益的最大值——这就保证了间隔种树。</p> <p>因为这是最大化问题，需要验证「交叉大于包含」，即对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a<b<c<d" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=b space=4><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=c space=4><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="<"><mjx-c class=mjx-c3C>&lt;</mjx-c></mjx-mo><mjx-mi data-latex=d space=4><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a<b<c<d" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex="<">&lt;</mo><mi data-latex=b>b</mi><mo data-latex="<">&lt;</mo><mi data-latex=c>c</mi><mo data-latex="<">&lt;</mo><mi data-latex=d>d</mi></math></mjx-assistive-mml><img title="a<b<c<d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都成立</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
w(a,c)+w(b,d) \ge w(a,d)+w(b,c).
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=d space=2><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mi data-latex=w space=4><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=d space=2><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=w space=3><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c space=2><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="w(a,c)+w(b,d) \ge w(a,d)+w(b,c)." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=d>d</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\ge>≥</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=d>d</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=b>b</mi><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
w(a,c)+w(b,d) \ge w(a,d)+w(b,c).
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>代入收益函数的表达式，并设</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
A = \max_{i\in[a+1,b]} a_i,~ B = \max_{i\in[b+1,c]} a_i,~ C = \max_{i\in[c+1,d]}a_i,
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_{i\in[a+1,b]} space=4><mjx-row><mjx-base style=padding-left:.513em><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={i\in[a+1,b]} size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_{i\in[b+1,c]} space=4><mjx-row><mjx-base style=padding-left:.479em><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={i\in[b+1,c]} size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=b><mjx-c class=mjx-c1D44F>𝑏</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_{i\in[c+1,d]} space=4><mjx-row><mjx-base style=padding-left:.511em><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex={i\in[c+1,d]} size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=c><mjx-c class=mjx-c1D450>𝑐</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=d><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="A = \max_{i\in[a+1,b]} a_i,~ B = \max_{i\in[b+1,c]} a_i,~ C = \max_{i\in[c+1,d]}a_i," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=A>A</mi><mo data-latex="=">=</mo><munder data-latex=\max_{i\in[a+1,b]}><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex={i\in[a+1,b]} data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mo data-latex=[ stretchy=false>[</mo><mi data-latex=a>a</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=b>b</mi><mo data-latex=] stretchy=false>]</mo></mrow></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=B>B</mi><mo data-latex="=">=</mo><munder data-latex=\max_{i\in[b+1,c]}><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex={i\in[b+1,c]} data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mo data-latex=[ stretchy=false>[</mo><mi data-latex=b>b</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=c>c</mi><mo data-latex=] stretchy=false>]</mo></mrow></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=C>C</mi><mo data-latex="=">=</mo><munder data-latex=\max_{i\in[c+1,d]}><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex={i\in[c+1,d]} data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mo data-latex=[ stretchy=false>[</mo><mi data-latex=c>c</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mi data-latex=d>d</mi><mo data-latex=] stretchy=false>]</mo></mrow></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
A = \max_{i\in[a+1,b]} a_i,~ B = \max_{i\in[b+1,c]} a_i,~ C = \max_{i\in[c+1,d]}a_i,
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>则要证明的不等式可以写作</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\max\{A,B\} + \max\{B,C\} \ge \max\{A,B,C\} + B.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=\max space=3><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=C space=2><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=\ge space=4><mjx-c class=mjx-c2265>≥</mjx-c></mjx-mo><mjx-mo data-latex=\max space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=C space=2><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=B space=3><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\max\{A,B\} + \max\{B,C\} \ge \max\{A,B,C\} + B." display=block xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=+>+</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=B>B</mi><mo data-latex=,>,</mo><mi data-latex=C>C</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=\ge>≥</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=,>,</mo><mi data-latex=C>C</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=+>+</mo><mi data-latex=B>B</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\max\{A,B\} + \max\{B,C\} \ge \max\{A,B,C\} + B.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>注意到不等号左侧的两项 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\max\{A,B\}><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\max\{A,B\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\max\{A,B\}></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\max\{B,C\}><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=C space=2><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\max\{B,C\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=B>B</mi><mo data-latex=,>,</mo><mi data-latex=C>C</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\max\{B,C\}></mjx-container> 中较大的那个就等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\max\{A,B,C\}><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=C space=2><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\max\{A,B,C\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=,>,</mo><mi data-latex=C>C</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\max\{A,B,C\}></mjx-container>，而它们中较小的那个总是不小于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=B><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=B xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=B>B</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=B></mjx-container>，因此该不等式成立。</p> <p>将种树问题转化为区间分拆问题后，只需要用 ST 表等方式预处理区间最值，可以单次 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(1)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(1)></mjx-container> 地计算单个区间的成本，就可以套用区间分拆问题的算法在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(n\log n\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(n\log n\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(n\log n\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 或 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=O(n(n+m))><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=m space=3><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n(n+m)) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=+>+</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n(n+m))></mjx-container> 的时间复杂度内解决该问题。该方法同样可以处理任意种树间隔的问题。</p></details><h3 data-original-document-end=22003 data-original-document-start=21995 id=交换论证>交换论证<a title="Permanent link" class=headerlink href=#交换论证></a></h3><p data-original-document-end=22227 data-original-document-start=22005>组合优化问题中，证明价值函数的凸性常常会用到交换论证（exchange argument）。具体地说，就是从参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m+1></mjx-container> 的问题的最优解出发，通过交换部分元素，构造出参数为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 且价值不超过 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=(v(m-1)+v(m+1))/2><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(v(m-1)+v(m+1))/2 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(v(m-1)+v(m+1))/2></mjx-container> 的可行解，从而利用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的最优性来证明凸性的论证方法。相较于凸优化的情形，组合优化问题中并不存在自然地构造两个解的「中间形态」的方法，因此，交换论证的应用通常具有一定的技巧性。</p><details class=warning data-original-document-end=23025 data-original-document-start=22229 open><summary>「边际成本递增」并不一定导致凸性</summary> <p>组合优化问题中，目标函数常常具有一些「边际成本递增」的性质，但是这并不必然导致凸性。一个典型的例子是 <a href=https://www.luogu.com.cn/problem/P3354 target=_blank>[IOI 2005] Riv 河流</a>，该问题的链上版本是满足四边形不等式因而具有凸性的，但是树上版本存在凸性不成立的例子。</p> <p>用于刻画「边际成本递增」的一个常见性质是函数的超模性（supermodularity）。对于有限集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 的子集族 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathcal PX" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\mathcal P" texclass=ORD><mjx-mi data-latex=P><mjx-c class="mjx-c50 NCM-C">P</mjx-c></mjx-mi></mjx-texatom><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathcal PX" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\mathcal P" data-mjx-texclass=ORD><mi data-latex=P data-mjx-variant=-tex-calligraphic mathvariant=script>P</mi></mrow><mi data-latex=X>X</mi></math></mjx-assistive-mml><img title="\mathcal PX" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上的函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f:\mathcal PX\rightarrow\mathbf R" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-texatom data-latex="\mathcal P" space=4 texclass=ORD><mjx-mi data-latex=P><mjx-c class="mjx-c50 NCM-C">P</mjx-c></mjx-mi></mjx-texatom><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f:\mathcal PX\rightarrow\mathbf R" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=:>:</mo><mrow data-latex="\mathcal P" data-mjx-texclass=ORD><mi data-latex=P data-mjx-variant=-tex-calligraphic mathvariant=script>P</mi></mrow><mi data-latex=X>X</mi><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow></math></mjx-assistive-mml><img title="f:\mathcal PX\rightarrow\mathbf R" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，如果它满足以下两条等价性质之一：</p> <ol><li>（交叉小于包含）对于任何子集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="A,B\subseteq X" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=B space=2><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\subseteq><mjx-c class=mjx-c2286>⊆</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="A,B\subseteq X" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=A>A</mi><mo data-latex=,>,</mo><mi data-latex=B>B</mi><mo data-latex=\subseteq>⊆</mo><mi data-latex=X>X</mi></math></mjx-assistive-mml><img title="A,B\subseteq X" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(A)+f(B) \le f(A\cup B) + f(A\cap B)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mi data-latex=B space=3><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cap><mjx-c class=mjx-c2229>∩</mjx-c></mjx-mo><mjx-mi data-latex=B space=3><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(A)+f(B) \le f(A\cup B) + f(A\cap B)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=B>B</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=\cup>∪</mo><mi data-latex=B>B</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=\cap>∩</mo><mi data-latex=B>B</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(A)+f(B) \le f(A\cup B) + f(A\cap B)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立；</li><li>（边际成本递增）对于任何子集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="A\subseteq B\subseteq X" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\subseteq><mjx-c class=mjx-c2286>⊆</mjx-c></mjx-mo><mjx-mi data-latex=B space=4><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\subseteq><mjx-c class=mjx-c2286>⊆</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="A\subseteq B\subseteq X" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=A>A</mi><mo data-latex=\subseteq>⊆</mo><mi data-latex=B>B</mi><mo data-latex=\subseteq>⊆</mo><mi data-latex=X>X</mi></math></mjx-assistive-mml><img title="A\subseteq B\subseteq X" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 以及 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="x\in X\setminus B" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X space=4><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-mi data-latex=B space=3><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="x\in X\setminus B" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=\setminus>∖</mo><mi data-latex=B>B</mi></math></mjx-assistive-mml><img title="x\in X\setminus B" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(A\cup\{x\})-f(A)\le f(B\cup\{x\})-f(B)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(A\cup\{x\})-f(A)\le f(B\cup\{x\})-f(B)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=x>x</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=B>B</mi><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=x>x</mi><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=B>B</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="f(A\cup\{x\})-f(A)\le f(B\cup\{x\})-f(B)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立；</li></ol> <p>就称函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 是 <strong>超模的</strong>（supermodular）。但是，超模函数作为目标函数的最优化问题中，价值函数</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(m) = \min_{A\subseteq X} f(A) \text{ subject to }|A|=m
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\min_{A\subseteq X}" space=4><mjx-row><mjx-base style=padding-left:.008em><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{A\subseteq X}" size=s texclass=ORD><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=\subseteq><mjx-c class=mjx-c2286>⊆</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mtext data-latex="\text{ subject to }"><mjx-c class=mjx-cA0 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(m) = \min_{A\subseteq X} f(A) \text{ subject to }|A|=m" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\min_{A\subseteq X}"><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex="{A\subseteq X}" data-mjx-texclass=ORD><mi data-latex=A>A</mi><mo data-latex=\subseteq>⊆</mo><mi data-latex=X>X</mi></mrow></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=A>A</mi><mo data-latex=) stretchy=false>)</mo><mtext data-latex="\text{ subject to }"> subject to </mtext><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mi data-latex=A>A</mi><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mo data-latex="=">=</mo><mi data-latex=m>m</mi></math></mjx-assistive-mml><img title="
v(m) = \min_{A\subseteq X} f(A) \text{ subject to }|A|=m
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p><strong>未必</strong> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凸函数。究其原因，就是从子集大小分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m+1></mjx-container> 的最优解，一般来说是无法构造出子集大小为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 且满足前述价值函数大小关系的可行解的。</p></details><p data-original-document-end=23049 data-original-document-start=23027>交换论证提供了种树问题凸性的又一种证明方式。</p><details class=example data-original-document-end=24088 data-original-document-start=23051><summary>凸性证明四</summary> <p>利用交换论证。设种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container> 棵树和种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m+1></mjx-container> 棵树的最优方案分别由 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\{x_i^{(m-1)}\}\in\{0,1\}^n><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msubsup data-latex=x_i^{(m-1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.294em;margin-left:0><mjx-texatom data-latex={(m-1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=\}^n><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{x_i^{(m-1)}\}\in\{0,1\}^n xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msubsup data-latex=x_i^{(m-1)}><mi data-latex=x>x</mi><mi data-latex=i>i</mi><mrow data-latex={(m-1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msubsup><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=\in>∈</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><msup data-latex=\}^n><mo data-latex=\} fence=false stretchy=false>}</mo><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{x_i^{(m-1)}\}\in\{0,1\}^n></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\{x_i^{(m+1)}\}\in\{0,1\}^n><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msubsup data-latex=x_i^{(m+1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.294em;margin-left:0><mjx-texatom data-latex={(m+1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=\}^n><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{x_i^{(m+1)}\}\in\{0,1\}^n xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msubsup data-latex=x_i^{(m+1)}><mi data-latex=x>x</mi><mi data-latex=i>i</mi><mrow data-latex={(m+1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msubsup><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=\in>∈</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><msup data-latex=\}^n><mo data-latex=\} fence=false stretchy=false>}</mo><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{x_i^{(m+1)}\}\in\{0,1\}^n></mjx-container> 给出，其中，取值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container> 表示该坑位种了一棵树，取值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 表示该坑位没有种树。定义序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\{z_i\}\in\{0,\pm 1\}^n" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=z_i><mjx-mi data-latex=z><mjx-c class=mjx-c1D467>𝑧</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.002em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=4><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=\}^n><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-script style=vertical-align:.363em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\{z_i\}\in\{0,\pm 1\}^n" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=z_i><mi data-latex=z>z</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=\in>∈</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn><msup data-latex=\}^n><mo data-latex=\} fence=false stretchy=false>}</mo><mi data-latex=n>n</mi></msup></math></mjx-assistive-mml><img title="\{z_i\}\in\{0,\pm 1\}^n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 满足</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
z_i = x_i^{(m+1)} - x_i^{(m-1)},~i=1,\cdots,n.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msub data-latex=z_i><mjx-mi data-latex=z><mjx-c class=mjx-c1D467>𝑧</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.002em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msubsup data-latex=x_i^{(m+1)} space=4><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.294em;margin-left:0><mjx-texatom data-latex={(m+1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msubsup data-latex=x_i^{(m-1)} space=3><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:-.294em;margin-left:0><mjx-texatom data-latex={(m-1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom><mjx-spacer style=margin-top:.18em></mjx-spacer><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="z_i = x_i^{(m+1)} - x_i^{(m-1)},~i=1,\cdots,n." display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=z_i><mi data-latex=z>z</mi><mi data-latex=i>i</mi></msub><mo data-latex="=">=</mo><msubsup data-latex=x_i^{(m+1)}><mi data-latex=x>x</mi><mi data-latex=i>i</mi><mrow data-latex={(m+1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msubsup><mo data-latex=->−</mo><msubsup data-latex=x_i^{(m-1)}><mi data-latex=x>x</mi><mi data-latex=i>i</mi><mrow data-latex={(m-1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msubsup><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
z_i = x_i^{(m+1)} - x_i^{(m-1)},~i=1,\cdots,n.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这个序列标记了两个种树方案的差异。这一序列中取值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 的位置表示该坑位要么在两个方案中都种了一棵树，要么在两个方案中都没有种树；而取值为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=-1><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+1><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+1></mjx-container> 的位置则分别表示只在方案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^{(m-1)}><mjx-msup data-latex=x^{(m-1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(m-1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^{(m-1)} xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{(m-1)}><mi data-latex=x>x</mi><mrow data-latex={(m-1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^{(m-1)}></mjx-container> 或只在方案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^{(m+1)}><mjx-msup data-latex=x^{(m+1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(m+1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^{(m+1)} xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{(m+1)}><mi data-latex=x>x</mi><mrow data-latex={(m+1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^{(m+1)}></mjx-container> 中，该坑位种了一棵树。因为任何方案中都不能在相邻的坑位种树，所以有如下观察：</p> <ul><li>连续的非零子段中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=z_i><mjx-msub data-latex=z_i><mjx-mi data-latex=z><mjx-c class=mjx-c1D467>𝑧</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.002em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=z_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=z_i><mi data-latex=z>z</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=z_i></mjx-container> 的取值必然在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\pm 1" aria-hidden=true class=NCM-N><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\pm 1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\pm 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 之间相互交错的；</li><li>极大的连续非零子段左右两侧的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>，必然表示在两个方案中都没有种树。</li></ul> <p>因此，如果某个极大的连续非零子段中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=z_i><mjx-msub data-latex=z_i><mjx-mi data-latex=z><mjx-c class=mjx-c1D467>𝑧</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.002em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=z_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=z_i><mi data-latex=z>z</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=z_i></mjx-container> 的和恰好为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+1><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+1></mjx-container>，也就是说，在该段坑位中，方案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^{(m+1)}><mjx-msup data-latex=x^{(m+1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(m+1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^{(m+1)} xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{(m+1)}><mi data-latex=x>x</mi><mrow data-latex={(m+1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^{(m+1)}></mjx-container> 比方案 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x^{(m-1)}><mjx-msup data-latex=x^{(m-1)}><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em><mjx-texatom data-latex={(m-1)} size=s texclass=ORD><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x^{(m-1)} xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex=x^{(m-1)}><mi data-latex=x>x</mi><mrow data-latex={(m-1)} data-mjx-texclass=ORD><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mrow></msup></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x^{(m-1)}></mjx-container> 多种了一棵树，那么就可以在该段内交换两个方案的种树位置。这样，就得到了两个各种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树的可行方案。因为没有改变两个方案中总的种树的位置和数量，只是将它们重新分配，所以总的收益不变，仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m-1)+v(m+1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m-1)+v(m+1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m-1)+v(m+1)></mjx-container>。但是，这两个种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树的方案未必是最优的，因此，它们各自的收益不会超过 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container>。这就证明了</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(m-1) + v(m+1) \le 2v(m),
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mn data-latex=2 space=4><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(m-1) + v(m+1) \le 2v(m)," display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mn data-latex=2>2</mn><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo></math></mjx-assistive-mml><img title="
v(m-1) + v(m+1) \le 2v(m),
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>也就是说，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凹函数。</p> <p>现在，只剩下一个问题，就是和恰好为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+1><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+1></mjx-container> 的极大连续非零子段是否存在。因为是若干个交错的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\pm 1" aria-hidden=true class=NCM-N><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\pm 1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\pm 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 相加，一个连续非零子段的和只能是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 或 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\pm 1" aria-hidden=true class=NCM-N><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\pm 1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\pm>±</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\pm 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。又因为所有这些极大连续非零子段的和等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=2><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=2 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=2></mjx-container>，所以，一定存在至少两个和恰好为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=+1><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=+1 xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=+1></mjx-container> 的极大连续非零子段。这就完成了证明。</p></details><h2 data-original-document-end=24095 data-original-document-start=24090 id=例题>例题<a title="Permanent link" class=headerlink href=#例题></a></h2><p data-original-document-end=24123 data-original-document-start=24097>本节介绍几个不同场景下应用 WQS 二分方法的例题。</p><h3 data-original-document-end=24133 data-original-document-start=24125 id=模板题目>模板题目<a title="Permanent link" class=headerlink href=#模板题目></a></h3><details class=example data-original-document-end=24313 data-original-document-start=24135 open><summary><a href=https://www.luogu.com.cn/problem/P1484 target=_blank>Luogu P1484 种树</a></summary> <p>有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个树坑，<strong>至多</strong> 种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树。树不能栽种于相邻的两个坑。给定长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 的序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i\}></mjx-container>，表示在每个坑种树的收益，收益可正可负。求种完这 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树最大可能的收益和。</p></details><details class=note data-original-document-end=25301 data-original-document-start=24315><summary>解答</summary> <p>与前文讨论的种树问题稍有不同，本题要求至多种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树，而非恰好种 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 棵树。仍然用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 表示前文讨论的种树问题的价值函数，本题的答案实际上是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\tilde v(m)=\max_{k\le m}v(k)" aria-hidden=true breakable=true class=NCM-N><mjx-texatom data-latex="\tilde v" texclass=ORD><mjx-mover><mjx-over style=margin-bottom:-.556em;padding-bottom:.105em;padding-left:.293em><mjx-mo style=width:0;margin-left:-.25em><mjx-c class=mjx-c2DC>˜</mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex="\max_{k\le m}" limits=false space=4><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex="{k\le m}" size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-munder><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\tilde v(m)=\max_{k\le m}v(k)" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\tilde v" data-mjx-texclass=ORD><mover><mi data-latex=v>v</mi><mo stretchy=false>~</mo></mover></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex="\max_{k\le m}"><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex="{k\le m}" data-mjx-texclass=ORD><mi data-latex=k>k</mi><mo data-latex=\le>≤</mo><mi data-latex=m>m</mi></mrow></munder><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="\tilde v(m)=\max_{k\le m}v(k)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是凹函数，也就是一个单峰函数，本题的答案相当于只保留 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 上升至峰顶的部分，然后函数会一直留在峰顶；这相当于仅仅保留切线斜率非负的部分。因此，本题与前文讨论的题目的唯一差别，就是 WQS 二分时，初始的斜率范围为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=[0,\max_ia_i]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-munder data-latex=\max_i limits=false space=2><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[0,\max_ia_i] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><munder data-latex=\max_i><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mi data-latex=i>i</mi></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[0,\max_ia_i]></mjx-container> 而非 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=[\min_ia_i,\max_ia_i]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-munder data-latex=\min_i limits=false><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-munder data-latex=\max_i limits=false space=2><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-munder><mjx-msub data-latex=a_i space=2><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[\min_ia_i,\max_ia_i] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><munder data-latex=\min_i><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mi data-latex=i>i</mi></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><munder data-latex=\max_i><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mi data-latex=i>i</mi></munder><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[\min_ia_i,\max_ia_i]></mjx-container>。</p> <p>应用 WQS 二分的方法移除数量限制后，问题转化为计算链上最大权独立集，只是将原本的收益 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i\}></mjx-container> 替换为了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\{a_i+k\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=k space=3><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i+k\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><mi data-latex=k>k</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i+k\}></mjx-container>。这是经典的动态规划题目。可以设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(i,j)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=j space=2><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(i,j) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mi data-latex=j>j</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(i,j)></mjx-container> 为第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个坑位选择种树（<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="j=1" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="j=1" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="j=1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>）或不种树（<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="j=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=j><mjx-c class=mjx-c1D457>𝑗</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="j=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=j>j</mi><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="j=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>）时，前 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 个树坑的子问题的最大收益。由此，可以写出状态转移方程为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(i,0) &= \max\{f(i-1,0),f(i-1,1)\},\\
f(i,1) &= f(i-1,0) + a_i + k.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
f(i,0) &= \max\{f(i-1,0),f(i-1,1)\},\\
f(i,1) &= f(i-1,0) + a_i + k.
\end{aligned}
" data-latex-item={aligned} style=min-width:16.221em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=\max space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=f space=4><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=a_i space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=k space=3><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(i,0) &= \max\{f(i-1,0),f(i-1,1)\},\\f(i,1) &= f(i-1,0) + a_i + k.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(i,0) &= \max\{f(i-1,0),f(i-1,1)\},\\f(i,1) &= f(i-1,0) + a_i + k.\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=,>,</mo></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=i>i</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><mi data-latex=k>k</mi><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(i,0) &= \max\{f(i-1,0),f(i-1,1)\},\\
f(i,1) &= f(i-1,0) + a_i + k.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>初始条件为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(0,0)=0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(0,0)=0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="f(0,0)=0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f(0,1)=-\infty" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f(0,1)=-\infty" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mo data-latex=->−</mo><mi data-latex=\infty mathvariant=normal>∞</mi></math></mjx-assistive-mml><img title="f(0,1)=-\infty" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，最终答案为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\max\{f(n,0),f(n,1)\}><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=0 space=2><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mn data-latex=1 space=2><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\max\{f(n,0),f(n,1)\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mn data-latex=0>0</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=,>,</mo><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=,>,</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\max\{f(n,0),f(n,1)\}></mjx-container>。单次计算复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n)></mjx-container>，整体时间复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(n\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(n\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(n\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="L=\max_i|a_i|" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=L><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_i limits=false space=4><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-munder><mjx-mo data-latex=| space=2><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="L=\max_i|a_i|" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=L>L</mi><mo data-latex="=">=</mo><munder data-latex=\max_i><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mi data-latex=i>i</mi></munder><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo></math></mjx-assistive-mml><img title="L=\max_i|a_i|" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p> <p>参考实现如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>传统方法</label><label for=__tabbed_1_2>对偶方法</label></div><div class=tabbed-content><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cstring></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = max_x f(x) - k * g(x).</span>
<span class=w>  </span><span class=c1>// Meanwhile, obtain the maximum value g(x) of the optimizer x.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mh>-0x3f3f3f3f3f3f3f3f</span><span class=p>};</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>};</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>tmp_dp</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>tmp_opt</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>tmp_dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>        </span><span class=n>tmp_opt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>      </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>tmp_dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>        </span><span class=n>tmp_opt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>      </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>tmp_dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>        </span><span class=n>tmp_opt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=n>tmp_dp</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
<span class=w>      </span><span class=n>tmp_opt</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>memcpy</span><span class=p>(</span><span class=n>dp</span><span class=p>,</span><span class=w> </span><span class=n>tmp_dp</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>dp</span><span class=p>));</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>memcpy</span><span class=p>(</span><span class=n>opt</span><span class=p>,</span><span class=w> </span><span class=n>tmp_opt</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>opt</span><span class=p>));</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>opt_m</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>      </span><span class=n>opt_m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>      </span><span class=n>opt_m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>      </span><span class=n>opt_m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>opt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>opt</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>};</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// WQS binary search.</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>tar_val</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>opt_m</span><span class=p>,</span><span class=w> </span><span class=n>tar_k</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>tie</span><span class=p>(</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>opt_m</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Have already reached the peak.</span>
<span class=w>    </span><span class=n>tar_k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=n>tar_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Find the maximum k such that g(x) >= m.</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1000000</span><span class=p>;</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>tie</span><span class=p>(</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>mm</span><span class=p>);</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>opt_m</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>tar_k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>        </span><span class=n>tar_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>        </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tar_val</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>tar_k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Golden section search on integer domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_integral</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ml</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>mr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ll</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>val</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>best_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>best_x</span><span class=p>,</span><span class=w> </span><span class=n>best_val</span><span class=p>};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = max_x f(x) + k * g(x).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mh>-0x3f3f3f3f3f3f3f3f</span><span class=p>};</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>std</span><span class=o>::</span><span class=n>tie</span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=w> </span><span class=o>=</span>
<span class=w>          </span><span class=n>std</span><span class=o>::</span><span class=n>make_pair</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span><span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>dp</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Solve the dual problem to find v(m).</span>
<span class=w>  </span><span class=c1>// Implemented as a minimization problem by adding negative signs.</span>
<span class=w>  </span><span class=c1>// Only consider tangent lines of negative slopes to ignore the part</span>
<span class=w>  </span><span class=c1>//     of the curve after the peak.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>golden_section_search</span><span class=p>(</span><span class=mi>-1000000</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>calc</span><span class=p>(</span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>              </span><span class=p>}).</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div></div></div></details><details class=example data-original-document-end=25435 data-original-document-start=25303 open><summary><a href=https://www.luogu.com.cn/problem/P2619 target=_blank>Luogu P2619 [国家集训队] Tree I</a></summary> <p>给定一张带权无向连通图，每条边是黑色或白色。求恰有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 条白边的生成树的最小权。</p></details><details class=note data-original-document-end=27234 data-original-document-start=25613><summary>解答</summary> <p>首先，通过交换论证可以证明 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是凸函数。不妨假设所有边的边权各不相同：那些存在两边边权相同的情形，可以通过微扰使之变为边权各不相同的情形；然后只要令微扰的幅度趋近于零，就可以证明函数的凸性在极限情形——也就是存在两边边权相同的情形——仍然成立。证明的关键在于如下引理：<sup id=fnref:edge-swap><a class=footnote-ref href=#fn:edge-swap>4</a></sup></p> <details class=note open><summary>引理</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=S><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=T><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=T>T</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T></mjx-container> 是无向连通图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="G=(V,E)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=G><mjx-c class=mjx-c1D43A>𝐺</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=E space=2><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="G=(V,E)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=G>G</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=V>V</mi><mo data-latex=,>,</mo><mi data-latex=E>E</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="G=(V,E)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的两个生成树。对于任意 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e\in S\setminus T" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=S space=4><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-mi data-latex=T space=3><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e\in S\setminus T" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi><mo data-latex=\in>∈</mo><mi data-latex=S>S</mi><mo data-latex=\setminus>∖</mo><mi data-latex=T>T</mi></math></mjx-assistive-mml><img title="e\in S\setminus T" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，都存在至少一条边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f\in T\setminus S" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=T space=4><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-mi data-latex=S space=3><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f\in T\setminus S" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=\in>∈</mo><mi data-latex=T>T</mi><mo data-latex=\setminus>∖</mo><mi data-latex=S>S</mi></math></mjx-assistive-mml><img title="f\in T\setminus S" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=S-e+f><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S-e+f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=+>+</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S-e+f></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=T-f+e><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T-f+e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=T>T</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=+>+</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T-f+e></mjx-container> 都是图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=G><mjx-mi data-latex=G><mjx-c class=mjx-c1D43A>𝐺</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=G xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=G>G</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=G></mjx-container> 的生成树。</p></details> <details class=note><summary>证明</summary> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="e=(u,v)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="e=(u,v)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=u>u</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="e=(u,v)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，且 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=P><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=P xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=P>P</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=P></mjx-container> 是树 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=T><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=T>T</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T></mjx-container> 中连接 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=u><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=u xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=u>u</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=u></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v></mjx-container> 的唯一一条路径。因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=P+e><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=P+e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=P>P</mi><mo data-latex=+>+</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=P+e></mjx-container> 是图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=T+e><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T+e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=T>T</mi><mo data-latex=+>+</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T+e></mjx-container> 中唯一的环路，所以删掉 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=P><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=P xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=P>P</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=P></mjx-container> 中的任何一条边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 都可以使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=T-f+e><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T-f+e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=T>T</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi><mo data-latex=+>+</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T-f+e></mjx-container> 是一棵生成树。与此同时，图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=S-e><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S-e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi><mo data-latex=->−</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S-e></mjx-container> 是有两个连通分量的森林，它们的顶点集分别记作 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_1><mjx-msub data-latex="V_1 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_1 "><mi data-latex=V>V</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_2><mjx-msub data-latex="V_2 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_2 "><mi data-latex=V>V</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_2></mjx-container>，所以，只要选择边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f\in P" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=P space=4><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f\in P" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=\in>∈</mo><mi data-latex=P>P</mi></math></mjx-assistive-mml><img title="f\in P" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 连通了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_1><mjx-msub data-latex="V_1 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_1 "><mi data-latex=V>V</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_2><mjx-msub data-latex="V_2 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_2 "><mi data-latex=V>V</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_2></mjx-container>，就能保证 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=S-e+f><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S-e+f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=+>+</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S-e+f></mjx-container> 是一棵生成树。这样的边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 总是存在的，因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=u><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=u xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=u>u</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=u></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v></mjx-container> 分别属于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_1><mjx-msub data-latex="V_1 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_1 "><mi data-latex=V>V</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_2><mjx-msub data-latex="V_2 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_2 "><mi data-latex=V>V</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_2></mjx-container>，而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=P><mjx-mi data-latex=P><mjx-c class=mjx-c1D443>𝑃</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=P xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=P>P</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=P></mjx-container> 连接了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=u><mjx-mi data-latex=u><mjx-c class=mjx-c1D462>𝑢</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=u xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=u>u</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=u></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v></mjx-container>。而且，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f\notin S" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\notin><mjx-c class=mjx-c2209>∉</mjx-c></mjx-mo><mjx-mi data-latex=S space=4><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f\notin S" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=\notin>∉</mo><mi data-latex=S>S</mi></math></mjx-assistive-mml><img title="f\notin S" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，因为图 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=S-e><mjx-mi data-latex=S><mjx-c class=mjx-c1D446>𝑆</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=S-e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=S>S</mi><mo data-latex=->−</mo><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=S-e></mjx-container> 中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_1><mjx-msub data-latex="V_1 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_1 "><mi data-latex=V>V</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V_2><mjx-msub data-latex="V_2 "><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.187em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="V_2 "><mi data-latex=V>V</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V_2></mjx-container> 并不是连通的。这就完成了证明。</p></details> <p>设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=T_{m-1}><mjx-msub data-latex=T_{m-1}><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T_{m-1} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=T_{m-1}><mi data-latex=T>T</mi><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T_{m-1}></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=T_{m+1}><mjx-msub data-latex=T_{m+1}><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T_{m+1} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=T_{m+1}><mi data-latex=T>T</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T_{m+1}></mjx-container> 是白边数量分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m+1></mjx-container> 的最小生成树。设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T_{m+1}\setminus T_{m-1}" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=T_{m+1}><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-msub data-latex=T_{m-1} space=3><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T_{m+1}\setminus T_{m-1}" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=T_{m+1}><mi data-latex=T>T</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub><mo data-latex=\setminus>∖</mo><msub data-latex=T_{m-1}><mi data-latex=T>T</mi><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img title="T_{m+1}\setminus T_{m-1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的一条白边，对它应用上述引理可知，存在边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="f\in T_{m-1}\setminus T_{m+1}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex=T_{m-1} space=4><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-msub data-latex=T_{m+1} space=3><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="f\in T_{m-1}\setminus T_{m+1}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=\in>∈</mo><msub data-latex=T_{m-1}><mi data-latex=T>T</mi><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msub><mo data-latex=\setminus>∖</mo><msub data-latex=T_{m+1}><mi data-latex=T>T</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img title="f\in T_{m-1}\setminus T_{m+1}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，使得 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'=T_{m+1}-e+f" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=T_{m+1} space=4><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'=T_{m+1}-e+f" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup><mo data-latex="=">=</mo><msub data-latex=T_{m+1}><mi data-latex=T>T</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub><mo data-latex=->−</mo><mi data-latex=e>e</mi><mo data-latex=+>+</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="T'=T_{m+1}-e+f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T''=T_{m-1}+e-f" aria-hidden=true breakable=true class=NCM-N><mjx-msup><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2033 NCM-V">″</mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=T_{m-1} space=4><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m-1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=e space=3><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=f space=3><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T''=T_{m-1}+e-f" xmlns=http://www.w3.org/1998/Math/MathML><msup><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>″</mo></msup><mo data-latex="=">=</mo><msub data-latex=T_{m-1}><mi data-latex=T>T</mi><mrow data-latex={m-1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></mrow></msub><mo data-latex=+>+</mo><mi data-latex=e>e</mi><mo data-latex=->−</mo><mi data-latex=f>f</mi></math></mjx-assistive-mml><img title="T''=T_{m-1}+e-f" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都是生成树。因为只是交换了一对边，所以，树 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'" aria-hidden=true class=NCM-N><mjx-msup data-latex="T'"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T'"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="T'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和树 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T''" aria-hidden=true class=NCM-N><mjx-msup data-latex="T''"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2033 NCM-V">″</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T''" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T''"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>″</mo></msup></math></mjx-assistive-mml><img title="T''" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的边权和仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m-1)+v(m+1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m-1)+v(m+1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m-1)+v(m+1)></mjx-container>。进而，分两种情形讨论：</p> <ul><li>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 是一条黑边，那么，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'" aria-hidden=true class=NCM-N><mjx-msup data-latex="T'"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T'"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="T'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T''" aria-hidden=true class=NCM-N><mjx-msup data-latex="T''"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2033 NCM-V">″</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T''" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T''"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>″</mo></msup></math></mjx-assistive-mml><img title="T''" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 中的白边数量都是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container>。它们各自的边权和都不会小于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container>。这就证明了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="2v(m)\le v(m-1)+v(m+1)" aria-hidden=true breakable=true class=NCM-N><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=v space=4><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="2v(m)\le v(m-1)+v(m+1)" xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=2>2</mn><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="2v(m)\le v(m-1)+v(m+1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，故而 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 是凸的。</li><li>如果 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 是一条白边，那么，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'" aria-hidden=true class=NCM-N><mjx-msup data-latex="T'"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T'"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="T'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T''" aria-hidden=true class=NCM-N><mjx-msup data-latex="T''"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2033 NCM-V">″</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T''" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T''"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>″</mo></msup></math></mjx-assistive-mml><img title="T''" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的白边数量分别是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m+1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m+1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=m-1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m-1 xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m-1></mjx-container>，所以它们的边权和分别不小于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m+1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m+1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m+1)></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m-1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m-1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m-1)></mjx-container>。但是，上面已经说明，它们的边权和加在一起就等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m-1)+v(m+1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=v space=3><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m-1)+v(m+1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m-1)+v(m+1)></mjx-container>。这说明，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'" aria-hidden=true class=NCM-N><mjx-msup data-latex="T'"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T'"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="T'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的边权和就等于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=v(m+1)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m+1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m+1)></mjx-container>。将 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="T'" aria-hidden=true class=NCM-N><mjx-msup data-latex="T'"><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:.363em;margin-left:.056em><mjx-mo data-latex="'" size=s><mjx-c class="mjx-c2032 NCM-V">′</mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="T'" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="T'"><mi data-latex=T>T</mi><mo data-latex="'" data-mjx-alternate=1>′</mo></msup></math></mjx-assistive-mml><img title="T'" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 与 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=T_{m+1}><mjx-msub data-latex=T_{m+1}><mjx-mi data-latex=T><mjx-c class=mjx-c1D447>𝑇</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.12em><mjx-texatom data-latex={m+1} size=s texclass=ORD><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=T_{m+1} xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=T_{m+1}><mi data-latex=T>T</mi><mrow data-latex={m+1} data-mjx-texclass=ORD><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=T_{m+1}></mjx-container> 比较可知，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=e><mjx-mi data-latex=e><mjx-c class=mjx-c1D452>𝑒</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=e xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=e>e</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=e></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f></mjx-container> 的边权必然相等。这与假设矛盾，所以该情形并不成立。</li></ul> <p>这就证明了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凸函数。</p> <p>建立了函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的凸性后，就可以用 WQS 二分解决该问题。移除数量限制并将每条白边的权重都减去 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>，并求解最小生成树问题。为此，可以应用 <a href=../../../graph/mst/#kruskal-算法>Kruskal 算法</a>。利用并查集维护连通性，算法的复杂度就是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(E\log E+E\alpha(V))" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=E space=2><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=E space=3><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(E\log E+E\alpha(V))" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=E>E</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=E>E</mi><mo data-latex=+>+</mo><mi data-latex=E>E</mi><mi data-latex=\alpha>α</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=V>V</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(E\log E+E\alpha(V))" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=E><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=E xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=E>E</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=E></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=V>V</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V></mjx-container> 分别为边数和顶点数，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=\alpha(\cdot)><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\alpha(\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=\alpha>α</mi><mo data-latex=( stretchy=false>(</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\alpha(\cdot)></mjx-container> 为反 Ackerman 函数。复杂度的主要部分 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(E\log E)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=E space=2><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(E\log E)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=E>E</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=E>E</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(E\log E)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 是给边排序的复杂度，在本题中可以进一步优化。虽然在 WQS 二分的过程中需要多次计算最小生成树，但是每次只有白边的边权会整体加减一个数。所以，可以在预处理时给白边、黑边分别排序，然后每次计算最小生成树时，只需要将调整完权重后的白边和黑边归并到一起就可以了。这样，整体复杂度就降低到了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(E\log E+E\alpha(V)\log L)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=E><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=E space=2><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=E space=3><mjx-c class=mjx-c1D438>𝐸</mjx-c></mjx-mi><mjx-mi data-latex=\alpha><mjx-c class=mjx-c1D6FC>𝛼</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(E\log E+E\alpha(V)\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=E>E</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=E>E</mi><mo data-latex=+>+</mo><mi data-latex=E>E</mi><mi data-latex=\alpha>α</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=V>V</mi><mo data-latex=) stretchy=false>)</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(E\log E+E\alpha(V)\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=L><mjx-mi data-latex=L><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=L xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=L>L</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=L></mjx-container> 为边权的取值范围的长度。</p> <p>参考实现如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>传统方法</label><label for=__tabbed_2_2>对偶方法</label></div><div class=tabbed-content><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span>
<span class=normal>84</span>
<span class=normal>85</span>
<span class=normal>86</span>
<span class=normal>87</span>
<span class=normal>88</span>
<span class=normal>89</span>
<span class=normal>90</span>
<span class=normal>91</span>
<span class=normal>92</span>
<span class=normal>93</span>
<span class=normal>94</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;array></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;numeric></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=k>class</span><span class=w> </span><span class=nc>DisjointSet</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>fa</span><span class=p>,</span><span class=w> </span><span class=n>sz</span><span class=p>;</span>

<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=nf>find</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]);</span><span class=w> </span><span class=p>}</span>

<span class=w> </span><span class=k>public</span><span class=o>:</span>
<span class=w>  </span><span class=n>DisjointSet</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>fa</span><span class=p>(</span><span class=n>n</span><span class=p>),</span><span class=w> </span><span class=n>sz</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>iota</span><span class=p>(</span><span class=n>fa</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>fa</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=mi>0</span><span class=p>);</span><span class=w> </span><span class=p>}</span>

<span class=w>  </span><span class=kt>bool</span><span class=w> </span><span class=n>unite</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
<span class=w>    </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sz</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>sz</span><span class=p>[</span><span class=n>y</span><span class=p>])</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span>
<span class=w>    </span><span class=n>fa</span><span class=p>[</span><span class=n>y</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
<span class=w>    </span><span class=n>sz</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>sz</span><span class=p>[</span><span class=n>y</span><span class=p>];</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>V</span><span class=p>,</span><span class=w> </span><span class=n>E</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>V</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>E</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>array</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>array</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=o>>></span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=o>></span><span class=w> </span><span class=n>edges</span><span class=p>;</span>
<span class=w>  </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>reserve</span><span class=p>(</span><span class=n>E</span><span class=p>);</span><span class=w>  </span><span class=c1>// white edges.</span>
<span class=w>  </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>reserve</span><span class=p>(</span><span class=n>E</span><span class=p>);</span><span class=w>  </span><span class=c1>// black edges.</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>E</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>w</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=n>w</span><span class=p>});</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=c1>// Sort edges.</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>sort</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>end</span><span class=p>(),</span>
<span class=w>            </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>lhs</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>              </span><span class=k>return</span><span class=w> </span><span class=n>lhs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>            </span><span class=p>});</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>sort</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>end</span><span class=p>(),</span>
<span class=w>            </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>lhs</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>              </span><span class=k>return</span><span class=w> </span><span class=n>lhs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>            </span><span class=p>});</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x) by Kruskal algorithm.</span>
<span class=w>  </span><span class=c1>// Use white edges first, whenever possible.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>cnt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=n>DisjointSet</span><span class=w> </span><span class=n>djs</span><span class=p>(</span><span class=n>V</span><span class=p>);</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{};</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>k</span><span class=p>);</span>
<span class=w>        </span><span class=n>cnt</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
<span class=w>        </span><span class=o>++</span><span class=n>cnt</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>res</span><span class=p>,</span><span class=w> </span><span class=n>cnt</span><span class=p>};</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// WQS binary search.</span>
<span class=w>  </span><span class=c1>// Find the minimum k such that g(x) >= m.</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>,</span><span class=w> </span><span class=n>tar_val</span><span class=p>,</span><span class=w> </span><span class=n>tar_k</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>-100</span><span class=p>,</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>tie</span><span class=p>(</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>mm</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>opt_m</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>tar_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>tar_k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tar_val</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tar_k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;array></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;numeric></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Golden section search on integer domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_integral</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ml</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>mr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ll</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>val</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>best_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>best_x</span><span class=p>,</span><span class=w> </span><span class=n>best_val</span><span class=p>};</span>
<span class=p>}</span>

<span class=k>class</span><span class=w> </span><span class=nc>DisjointSet</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>fa</span><span class=p>,</span><span class=w> </span><span class=n>sz</span><span class=p>;</span>

<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=nf>find</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>fa</span><span class=p>[</span><span class=n>x</span><span class=p>]);</span><span class=w> </span><span class=p>}</span>

<span class=w> </span><span class=k>public</span><span class=o>:</span>
<span class=w>  </span><span class=n>DisjointSet</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>fa</span><span class=p>(</span><span class=n>n</span><span class=p>),</span><span class=w> </span><span class=n>sz</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>iota</span><span class=p>(</span><span class=n>fa</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>fa</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=mi>0</span><span class=p>);</span><span class=w> </span><span class=p>}</span>

<span class=w>  </span><span class=kt>bool</span><span class=w> </span><span class=n>unite</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
<span class=w>    </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>sz</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>sz</span><span class=p>[</span><span class=n>y</span><span class=p>])</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span>
<span class=w>    </span><span class=n>fa</span><span class=p>[</span><span class=n>y</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
<span class=w>    </span><span class=n>sz</span><span class=p>[</span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>sz</span><span class=p>[</span><span class=n>y</span><span class=p>];</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>};</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>V</span><span class=p>,</span><span class=w> </span><span class=n>E</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>V</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>E</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>array</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>array</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=o>>></span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=o>></span><span class=w> </span><span class=n>edges</span><span class=p>;</span>
<span class=w>  </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>reserve</span><span class=p>(</span><span class=n>E</span><span class=p>);</span><span class=w>  </span><span class=c1>// white edges.</span>
<span class=w>  </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>reserve</span><span class=p>(</span><span class=n>E</span><span class=p>);</span><span class=w>  </span><span class=c1>// black edges.</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>E</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>w</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<span class=w>    </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>].</span><span class=n>push_back</span><span class=p>({</span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=n>w</span><span class=p>});</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=c1>// Sort edges.</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>sort</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>end</span><span class=p>(),</span>
<span class=w>            </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>lhs</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>              </span><span class=k>return</span><span class=w> </span><span class=n>lhs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>            </span><span class=p>});</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>sort</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>end</span><span class=p>(),</span>
<span class=w>            </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>lhs</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&</span><span class=w> </span><span class=n>rhs</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>              </span><span class=k>return</span><span class=w> </span><span class=n>lhs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>rhs</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
<span class=w>            </span><span class=p>});</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x) by Kruskal algorithm.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=n>DisjointSet</span><span class=w> </span><span class=n>djs</span><span class=p>(</span><span class=n>V</span><span class=p>);</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{};</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=n>c</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>k</span><span class=p>);</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=n>c</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>size</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>djs</span><span class=p>.</span><span class=n>unite</span><span class=p>(</span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>0</span><span class=p>],</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>1</span><span class=p>]))</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>edges</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>]][</span><span class=mi>2</span><span class=p>];</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=o>++</span><span class=n>i</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Solve the dual problem to find v(m).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>golden_section_search</span><span class=p>(</span><span class=mi>-100</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span>
<span class=w>               </span><span class=k>return</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>             </span><span class=p>}).</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div></div></div></details><h3 data-original-document-end=27505 data-original-document-start=27495 id=区间分拆问题>区间分拆问题<a title="Permanent link" class=headerlink href=#区间分拆问题></a></h3><details class=example data-original-document-end=27705 data-original-document-start=27507 open><summary><a href=https://www.luogu.com.cn/problem/P6246 target=_blank>Luogu P6246 [IOI 2000] 邮局 加强版 加强版</a></summary> <p>给定长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 且递增的正整数序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i\}></mjx-container> 表示一条高速公路旁的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 个村庄的位置，需要修建 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 个邮局。邮局位置的选择，需要最小化所有村庄与其最近邮局的距离之和。求这个最小值。</p></details><details class=note data-original-document-end=28277 data-original-document-start=27786><summary>解答</summary> <p>这是典型的 <a href=../quadrangle/#区间分拆问题>区间分拆问题</a>。二分队列的实现细节请参考该页面。</p> <p>每个邮局服务离它最近的村庄，那么，这些村庄必然是高速公路旁连续的若干个村庄。所以，修建 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 个邮局，就相当于将所有村庄划分为连续的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 段，并为每一段村庄修建一个成本最低的邮局。众所周知，邮局应当修建在村庄位置的中位数的位置。由此，可以写出区间 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=[l,r]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[l,r] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[l,r]></mjx-container> 的成本函数为</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
w(l,r) = \sum_{i=l}^r|a_i-a_{\lfloor(l+r)/2\rfloor}|.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=l}^r" space=4><mjx-over style=padding-bottom:.192em;padding-left:.563em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.22em><mjx-texatom data-latex="{i=l}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=| space=2><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=a_{\lfloor(l+r)/2\rfloor} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em><mjx-texatom data-latex={\lfloor(l+r)/2\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="w(l,r) = \sum_{i=l}^r|a_i-a_{\lfloor(l+r)/2\rfloor}|." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=l}^r"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=l}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mi data-latex=l>l</mi></mrow><mi data-latex=r>r</mi></munderover><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=a_{\lfloor(l+r)/2\rfloor}><mi data-latex=a>a</mi><mrow data-latex={\lfloor(l+r)/2\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msub><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
w(l,r) = \sum_{i=l}^r|a_i-a_{\lfloor(l+r)/2\rfloor}|.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>它满足四边形不等式，因为它的二阶混合差分非正：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\Delta_l\Delta_r w(l,r)
= \Delta_l(a_{r+1} - a_{\lfloor(l+r+1)/2\rfloor})
= a_{\lfloor(l+r+1)/2\rfloor}-a_{\lfloor(l+r+2)/2\rfloor} \le 0.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msub data-latex=\Delta_l><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=l size=s><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub data-latex=\Delta_r><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=r size=s><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi data-latex=w><mjx-c class=mjx-c1D464>𝑤</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=r space=2><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=\Delta_l space=4><mjx-mi data-latex=\Delta><mjx-c class=mjx-c394>Δ</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=l size=s><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_{r+1}><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={r+1} size=s texclass=ORD><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=a_{\lfloor(l+r+1)/2\rfloor} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em><mjx-texatom data-latex={\lfloor(l+r+1)/2\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=a_{\lfloor(l+r+1)/2\rfloor} space=4><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em><mjx-texatom data-latex={\lfloor(l+r+1)/2\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=a_{\lfloor(l+r+2)/2\rfloor} space=3><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.177em><mjx-texatom data-latex={\lfloor(l+r+2)/2\rfloor} size=s texclass=ORD><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=l><mjx-c class=mjx-c1D459>𝑙</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=r><mjx-c class=mjx-c1D45F>𝑟</mjx-c></mjx-mi><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mn data-latex=. space=4><mjx-c class=mjx-c30 noic=true style=padding-top:.666em>0</mjx-c><mjx-c class=mjx-c2E style=padding-top:.666em>.</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\Delta_l\Delta_r w(l,r)= \Delta_l(a_{r+1} - a_{\lfloor(l+r+1)/2\rfloor})= a_{\lfloor(l+r+1)/2\rfloor}-a_{\lfloor(l+r+2)/2\rfloor} \le 0." display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=\Delta_l><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=l>l</mi></msub><msub data-latex=\Delta_r><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=r>r</mi></msub><mi data-latex=w>w</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=,>,</mo><mi data-latex=r>r</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msub data-latex=\Delta_l><mi data-latex=\Delta mathvariant=normal>Δ</mi><mi data-latex=l>l</mi></msub><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_{r+1}><mi data-latex=a>a</mi><mrow data-latex={r+1} data-mjx-texclass=ORD><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></msub><mo data-latex=->−</mo><msub data-latex=a_{\lfloor(l+r+1)/2\rfloor}><mi data-latex=a>a</mi><mrow data-latex={\lfloor(l+r+1)/2\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><msub data-latex=a_{\lfloor(l+r+1)/2\rfloor}><mi data-latex=a>a</mi><mrow data-latex={\lfloor(l+r+1)/2\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msub><mo data-latex=->−</mo><msub data-latex=a_{\lfloor(l+r+2)/2\rfloor}><mi data-latex=a>a</mi><mrow data-latex={\lfloor(l+r+2)/2\rfloor} data-mjx-texclass=ORD><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=l>l</mi><mo data-latex=+>+</mo><mi data-latex=r>r</mi><mo data-latex=+>+</mo><mn data-latex=2>2</mn><mo data-latex=) stretchy=false>)</mo><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mn data-latex=2>2</mn><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></mrow></msub><mo data-latex=\le>≤</mo><mn data-latex=.>0.</mn></math></mjx-assistive-mml><img title="
\Delta_l\Delta_r w(l,r)
= \Delta_l(a_{r+1} - a_{\lfloor(l+r+1)/2\rfloor})
= a_{\lfloor(l+r+1)/2\rfloor}-a_{\lfloor(l+r+2)/2\rfloor} \le 0.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这说明，可以通过二分队列结合 WQS 二分的方法在 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(n\log n\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-mi data-latex=\log space=2><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(n\log n\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=n>n</mi><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(n\log n\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的复杂度内求解该问题。</p> <p>参考实现如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>传统方法</label><label for=__tabbed_3_2>对偶方法</label></div><div class=tabbed-content><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;deque></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Monotone decision DP.</span>
<span class=c1>// This solves f(i) = min f(j-1) + w(j,i) s.t. 1 &lt;= j &lt;= i.</span>
<span class=c1>// Also records the minimal optimal decision j for each f(i).</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>W</span><span class=o>></span>
<span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>W</span><span class=o>></span><span class=p>()(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>))</span><span class=o>></span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>>></span>
<span class=n>monotone_decision_opt_dp</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>W</span><span class=w> </span><span class=n>ww</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>using</span><span class=w> </span><span class=n>ValueT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>W</span><span class=o>></span><span class=p>()(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>));</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ValueT</span><span class=o>></span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>opt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>lt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>rt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>deque</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>dq</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=n>ValueT</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>ww</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>f</span><span class=p>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>];</span><span class=w> </span><span class=p>};</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>()]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=n>dq</span><span class=p>.</span><span class=n>pop_front</span><span class=p>();</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>()]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()])</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]))</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>pop_back</span><span class=p>();</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()])</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]))</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>        </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()],</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()],</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span>
<span class=w>      </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>mm</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>mm</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>          </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>f</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>(),</span><span class=w> </span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=n>opt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>();</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>f</span><span class=p>,</span><span class=w> </span><span class=n>opt</span><span class=p>};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>ps</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>    </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=c1>// Cost function for interval [l,r].</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>mm</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>mm</span><span class=p>];</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x).</span>
<span class=w>  </span><span class=c1>// Also record the minimum of optimal number of segments.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>monotone_decision_opt_dp</span><span class=p>(</span>
<span class=w>        </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=p>;</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>first</span><span class=p>[</span><span class=n>n</span><span class=p>];</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>cnt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=n>second</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=o>++</span><span class=n>cnt</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>cnt</span><span class=p>};</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// WQS binary search.</span>
<span class=w>  </span><span class=c1>// Find the largest k such that g(x) &lt;= m.</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>tar_val</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>opt_m</span><span class=p>,</span><span class=w> </span><span class=n>tar_k</span><span class=p>;</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=p>(</span><span class=mf>1L</span><span class=n>L</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>32</span><span class=p>),</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>tie</span><span class=p>(</span><span class=n>val</span><span class=p>,</span><span class=w> </span><span class=n>opt_m</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>mm</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>opt_m</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>tar_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>tar_k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tar_val</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=p>)</span><span class=n>tar_k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div><div class=tabbed-block><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;deque></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;utility></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Monotone decision DP.</span>
<span class=c1>// This solves f(i) = min f(j-1) + w(j,i) s.t. 1 &lt;= j &lt;= i.</span>
<span class=c1>// Also records the minimal optimal decision j for each f(i).</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>W</span><span class=o>></span>
<span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>W</span><span class=o>></span><span class=p>()(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>))</span><span class=o>></span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>>></span>
<span class=n>monotone_decision_opt_dp</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>W</span><span class=w> </span><span class=n>ww</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>using</span><span class=w> </span><span class=n>ValueT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>W</span><span class=o>></span><span class=p>()(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>));</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ValueT</span><span class=o>></span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>opt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>lt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>rt</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>deque</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>dq</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=n>ValueT</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>ww</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>f</span><span class=p>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>];</span><span class=w> </span><span class=p>};</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>()]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=n>dq</span><span class=p>.</span><span class=n>pop_front</span><span class=p>();</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>()]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()])</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]))</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>pop_back</span><span class=p>();</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()])</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]))</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>        </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>int</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()],</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()],</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span>
<span class=w>      </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>mm</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>(),</span><span class=w> </span><span class=n>mm</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>          </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>dq</span><span class=p>.</span><span class=n>back</span><span class=p>()]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>      </span><span class=n>lt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>      </span><span class=n>rt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>      </span><span class=n>dq</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>f</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>(),</span><span class=w> </span><span class=n>j</span><span class=p>);</span>
<span class=w>    </span><span class=n>opt</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dq</span><span class=p>.</span><span class=n>front</span><span class=p>();</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>f</span><span class=p>,</span><span class=w> </span><span class=n>opt</span><span class=p>};</span>
<span class=p>}</span>

<span class=c1>// Golden section search on integer domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_integral</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ml</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>mr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ll</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>val</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>best_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>best_x</span><span class=p>,</span><span class=w> </span><span class=n>best_val</span><span class=p>};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>ps</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>    </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=c1>// Cost function for interval [l,r].</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>ps</span><span class=p>[</span><span class=n>mm</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>mm</span><span class=p>];</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>solve</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>monotone_decision_opt_dp</span><span class=p>(</span>
<span class=w>               </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>w</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>k</span><span class=p>;</span><span class=w> </span><span class=p>})</span>
<span class=w>               </span><span class=p>.</span><span class=n>first</span><span class=p>[</span><span class=n>n</span><span class=p>]</span><span class=w> </span><span class=o>+</span>
<span class=w>           </span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Solve the dual problem to find v(m).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>golden_section_search</span><span class=p>(</span><span class=o>-</span><span class=p>(</span><span class=mf>1L</span><span class=n>L</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>32</span><span class=p>),</span><span class=w> </span><span class=mf>0L</span><span class=n>L</span><span class=p>,</span><span class=w> </span><span class=n>solve</span><span class=p>).</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div></div></div></details><h3 data-original-document-end=28541 data-original-document-start=28530 id=二维的限制条件>二维的限制条件<a title="Permanent link" class=headerlink href=#二维的限制条件></a></h3><details class=example data-original-document-end=29008 data-original-document-start=28543 open><summary><a href=https://codeforces.com/problemset/problem/739/E target=_blank>Codeforces 739 E. Gosha is hunting</a></summary> <p>有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 只神奇宝贝，序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{p_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=p_i><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{p_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{p_i\}></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{q_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=q_i><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.006em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{q_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=q_i><mi data-latex=q>q</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{q_i\}></mjx-container> 分别表示用宝贝球和超级球抓到第 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 只神奇宝贝的概率。可以向一个神奇宝贝扔一个宝贝球，或者扔一个超级球，或者两种球各扔一个，或者什么球都不扔。现有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_1><mjx-msub data-latex="m_1 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_1 "><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_1></mjx-container> 个宝贝球和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_2><mjx-msub data-latex="m_2 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_2 "><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_2></mjx-container> 个神奇球，需要合理分配，并同时扔出。求抓到的神奇宝贝的期望数量的最大值。单次抓捕成功与否，与其它抓捕的结果无关。</p> <p>更一般地，可以抽象为如下问题：</p> <p>给定长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 的三个正实数序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{A_i\},\{B_i\},\{C_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=A_i><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=2><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=B_i><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=2><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=C_i><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{A_i\},\{B_i\},\{C_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=,>,</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=,>,</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{A_i\},\{B_i\},\{C_i\}></mjx-container>，而且，对所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 都有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="C_i\le A_i+B_i" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=C_i><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-msub data-latex=A_i space=4><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=B_i space=3><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="C_i\le A_i+B_i" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=\le>≤</mo><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img title="C_i\le A_i+B_i" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 成立。求最优的下标集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=Y><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=Y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=Y>Y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=Y></mjx-container> 满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="|X|=m_1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=m_1 space=4><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="|X|=m_1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mi data-latex=X>X</mi><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mo data-latex="=">=</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img title="|X|=m_1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="|Y|=m_2" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi><mjx-mo data-latex=|><mjx-c class=mjx-c7C>|</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=4><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="|Y|=m_2" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mi data-latex=Y>Y</mi><mo data-latex=| data-mjx-texclass=ORD stretchy=false>|</mo><mo data-latex="=">=</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img title="|Y|=m_2" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 且最大化</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\sum_{i\in X\setminus Y}A_i + \sum_{i\in Y\setminus X}B_i + \sum_{i\in X\cap Y}C_i.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-munder data-latex="\sum_{i\in X\setminus Y}"><mjx-row><mjx-base style=padding-left:.407em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{i\in X\setminus Y}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=A_i space=2><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{i\in Y\setminus X}" space=3><mjx-row><mjx-base style=padding-left:.407em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{i\in Y\setminus X}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi><mjx-mo data-latex=\setminus><mjx-c class=mjx-c2216>∖</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=B_i space=2><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-munder data-latex="\sum_{i\in X\cap Y}" space=3><mjx-row><mjx-base style=padding-left:.442em><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em><mjx-texatom data-latex="{i\in X\cap Y}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi><mjx-mo data-latex=\cap><mjx-c class=mjx-c2229>∩</mjx-c></mjx-mo><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=C_i space=2><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\sum_{i\in X\setminus Y}A_i + \sum_{i\in Y\setminus X}B_i + \sum_{i\in X\cap Y}C_i." display=block xmlns=http://www.w3.org/1998/Math/MathML><munder data-latex="\sum_{i\in X\setminus Y}"><mo data-latex=\sum>∑</mo><mrow data-latex="{i\in X\setminus Y}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=\setminus>∖</mo><mi data-latex=Y>Y</mi></mrow></munder><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><munder data-latex="\sum_{i\in Y\setminus X}"><mo data-latex=\sum>∑</mo><mrow data-latex="{i\in Y\setminus X}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mi data-latex=Y>Y</mi><mo data-latex=\setminus>∖</mo><mi data-latex=X>X</mi></mrow></munder><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><munder data-latex="\sum_{i\in X\cap Y}"><mo data-latex=\sum>∑</mo><mrow data-latex="{i\in X\cap Y}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex=\in>∈</mo><mi data-latex=X>X</mi><mo data-latex=\cap>∩</mo><mi data-latex=Y>Y</mi></mrow></munder><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
\sum_{i\in X\setminus Y}A_i + \sum_{i\in Y\setminus X}B_i + \sum_{i\in X\cap Y}C_i.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container></details><details class=note data-original-document-end=30274 data-original-document-start=29226><summary>解答</summary> <p>原问题可以看作是这个更一般的问题在</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
A_i = p_i,~ B_i = q_i,~ C_i = p_i+q_i-p_iq_i
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-msub data-latex=A_i><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=p_i space=4><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-msub data-latex=B_i><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=q_i space=4><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.006em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-msub data-latex=C_i><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-msub data-latex=p_i space=4><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=q_i space=3><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.006em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=p_i space=3><mjx-mi data-latex=p><mjx-c class=mjx-c1D45D>𝑝</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub data-latex=q_i><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.006em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="A_i = p_i,~ B_i = q_i,~ C_i = p_i+q_i-p_iq_i" display=block xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex="=">=</mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub><mo data-latex="=">=</mo><msub data-latex=q_i><mi data-latex=q>q</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex="=">=</mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><msub data-latex=q_i><mi data-latex=q>q</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=p_i><mi data-latex=p>p</mi><mi data-latex=i>i</mi></msub><msub data-latex=q_i><mi data-latex=q>q</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img title="
A_i = p_i,~ B_i = q_i,~ C_i = p_i+q_i-p_iq_i
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>时的特殊情形。因此，只需要讨论更一般的问题的解决方案就可以了。</p> <p>用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m_1,m_2)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m_1,m_2) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m_1,m_2)></mjx-container> 表示该问题的价值函数，需要证明它是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(m_1,m_2)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(m_1,m_2) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(m_1,m_2)></mjx-container> 的凹函数。考虑如下费用流模型：</p> <ul><li>从源点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=s><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=s xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=s>s</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=s></mjx-container> 出发，分别向结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 连一条边，容量分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_1><mjx-msub data-latex="m_1 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_1 "><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_2><mjx-msub data-latex="m_2 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_2 "><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_2></mjx-container>，费用均为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container>；</li><li>对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，分别从结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=x><mjx-mi data-latex=x><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=x xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=x>x</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=x></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 向结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 连一条边，容量均为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container>，费用分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=A_i><mjx-msub data-latex=A_i><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=A_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=A_i></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=B_i><mjx-msub data-latex=B_i><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=B_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=B_i></mjx-container>；</li><li>对于所有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="i=1,\cdots,n" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1 space=4><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mo data-latex=\cdots space=2><mjx-c class=mjx-c22EF>⋯</mjx-c></mjx-mo><mjx-mo data-latex=, space=2><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=n space=2><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="i=1,\cdots,n" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn><mo data-latex=,>,</mo><mo data-latex=\cdots>⋯</mo><mo data-latex=,>,</mo><mi data-latex=n>n</mi></math></mjx-assistive-mml><img title="i=1,\cdots,n" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，从结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 出发向汇点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=t><mjx-mi data-latex=t><mjx-c class=mjx-c1D461>𝑡</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=t xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=t>t</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=t></mjx-container> 连两条边，容量均为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container>，费用分别为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=C_i-A_i-B_i><mjx-msub data-latex=C_i><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=A_i space=3><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=B_i space=3><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=C_i-A_i-B_i xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=C_i-A_i-B_i></mjx-container>。</li></ul> <p>问题的答案就是该费用流模型的最大费用最大流。条件 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="C_i-A_i-B_i\le 0" aria-hidden=true breakable=true class=NCM-N><mjx-msub data-latex=C_i><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=A_i space=3><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=B_i space=3><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="C_i-A_i-B_i\le 0" xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub><mo data-latex=\le>≤</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="C_i-A_i-B_i\le 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 保证了当流经结点 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=i><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=i xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=i>i</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=i></mjx-container> 的流量为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=1><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=1 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=1>1</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=1></mjx-container> 时，会优先选择费用为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=0><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=0 xmlns=http://www.w3.org/1998/Math/MathML><mn data-latex=0>0</mn></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=0></mjx-container> 的那条边流出。将这个费用流模型写成线性规划问题，那么，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_1><mjx-msub data-latex="m_1 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_1 "><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m_2><mjx-msub data-latex="m_2 "><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="m_2 "><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m_2></mjx-container> 就会分别出现在表示边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(s,x)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=x space=2><mjx-c class=mjx-c1D465>𝑥</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(s,x) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=s>s</mi><mo data-latex=,>,</mo><mi data-latex=x>x</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(s,x)></mjx-container> 和边 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(s,y)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=s><mjx-c class=mjx-c1D460>𝑠</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=y space=2><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(s,y) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=s>s</mi><mo data-latex=,>,</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(s,y)></mjx-container> 的流量限制的不等式中。因此，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m_1,m_2)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m_1,m_2) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m_1,m_2)></mjx-container> 确实是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(m_1,m_2)><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(m_1,m_2) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(m_1,m_2)></mjx-container> 的凹函数。</p> <p>为了应用 WQS 二分，需要考虑移除数量限制后的最优化问题。设 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k_1><mjx-msub data-latex="k_1 "><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k_1 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="k_1 "><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k_1></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k_2><mjx-msub data-latex="k_2 "><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k_2 xmlns=http://www.w3.org/1998/Math/MathML><msub data-latex="k_2 "><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k_2></mjx-container> 分别为将一个下标放入集合 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=Y><mjx-mi data-latex=Y><mjx-c class=mjx-c1D44C>𝑌</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=Y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=Y>Y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=Y></mjx-container> 时获得的额外奖励。没有数量限制后，关于每个下标的决策都是独立的，因此，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
h(k_1,k_2) = \sum_{i=1}^n\max\{0,A_i+k_1,B_i+k_2,C_i+k_1+k_2\}.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munderover data-latex="\sum_{i=1}^n" space=4><mjx-over style=padding-bottom:.192em;padding-left:.51em><mjx-mi data-latex=n size=s><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.148em><mjx-texatom data-latex="{i=1}" size=s texclass=ORD><mjx-mi data-latex=i><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=1><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mo data-latex=\max space=2><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=A_i space=2><mjx-mi data-latex=A><mjx-c class=mjx-c1D434>𝐴</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=B_i space=2><mjx-mi data-latex=B><mjx-c class=mjx-c1D435>𝐵</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=C_i space=2><mjx-mi data-latex=C><mjx-c class=mjx-c1D436>𝐶</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em;margin-left:-.045em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="h(k_1,k_2) = \sum_{i=1}^n\max\{0,A_i+k_1,B_i+k_2,C_i+k_1+k_2\}." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munderover data-latex="\sum_{i=1}^n"><mo data-latex=\sum>∑</mo><mrow data-latex="{i=1}" data-mjx-texclass=ORD><mi data-latex=i>i</mi><mo data-latex="=">=</mo><mn data-latex=1>1</mn></mrow><mi data-latex=n>n</mi></munderover><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><msub data-latex=A_i><mi data-latex=A>A</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=B_i><mi data-latex=B>B</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=,>,</mo><msub data-latex=C_i><mi data-latex=C>C</mi><mi data-latex=i>i</mi></msub><mo data-latex=+>+</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=+>+</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=\} fence=false stretchy=false>}</mo><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
h(k_1,k_2) = \sum_{i=1}^n\max\{0,A_i+k_1,B_i+k_2,C_i+k_1+k_2\}.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>原问题的答案就由</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(m_1,m_2) = \min_{k_1,k_2} h(k_1,k_2) - k_1m_1 - k_2m_2
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_2 space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\min_{k_1,k_2} space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.058em><mjx-texatom data-latex={k_1,k_2} size=s texclass=ORD><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=k_2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=h space=2><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=k_1><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=2><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=k_1 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=m_1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=1 size=s><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-msub data-latex=k_2 space=3><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub data-latex=m_2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(m_1,m_2) = \min_{k_1,k_2} h(k_1,k_2) - k_1m_1 - k_2m_2" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\min_{k_1,k_2}><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex={k_1,k_2} data-mjx-texclass=ORD><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub></mrow></munder><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><mo data-latex=,>,</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><msub data-latex=k_1><mi data-latex=k>k</mi><mn data-latex=1>1</mn></msub><msub data-latex=m_1><mi data-latex=m>m</mi><mn data-latex=1>1</mn></msub><mo data-latex=->−</mo><msub data-latex=k_2><mi data-latex=k>k</mi><mn data-latex=2>2</mn></msub><msub data-latex=m_2><mi data-latex=m>m</mi><mn data-latex=2>2</mn></msub></math></mjx-assistive-mml><img title="
v(m_1,m_2) = \min_{k_1,k_2} h(k_1,k_2) - k_1m_1 - k_2m_2
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>给出。总的时间复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^2L)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^2 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^2L) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^2><mi data-latex=\log>log</mi><mn data-latex=2>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^2L)></mjx-container>，其中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="O(\log L)" aria-hidden=true class=NCM-N><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="O(\log L)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=\log>log</mi><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="O(\log L)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 为对单个维度二分的次数。</p> <p>抓捕神奇宝贝问题的参考实现如下：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iomanip></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Golden section search on floating-point domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_floating_point</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>eps</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>eps</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>mid</span><span class=p>,</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mid</span><span class=p>)};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m1</span><span class=p>,</span><span class=w> </span><span class=n>m2</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m1</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>m2</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=o>></span><span class=w> </span><span class=n>p</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=n>q</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=c1>// Calculate h(k1,k2).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>solve</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k1</span><span class=p>,</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k2</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>max</span><span class=p>(</span>
<span class=w>          </span><span class=p>{</span><span class=mf>0.0l</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k1</span><span class=p>,</span><span class=w> </span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k2</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k2</span><span class=p>});</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Solve the dual problem to find v(m1,m2).</span>
<span class=w>  </span><span class=c1>// Implemented as a minimization problem by adding negative signs.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>golden_section_search</span><span class=p>(</span>
<span class=w>                  </span><span class=mf>-1.0l</span><span class=p>,</span><span class=w> </span><span class=mf>0.0l</span><span class=p>,</span>
<span class=w>                  </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k1</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>return</span><span class=w> </span><span class=n>golden_section_search</span><span class=p>(</span>
<span class=w>                               </span><span class=mf>-1.0l</span><span class=p>,</span><span class=w> </span><span class=mf>0.0l</span><span class=p>,</span>
<span class=w>                               </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k2</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span>
<span class=w>                                 </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>solve</span><span class=p>(</span><span class=n>k1</span><span class=p>,</span><span class=w> </span><span class=n>k2</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m2</span><span class=p>;</span>
<span class=w>                               </span><span class=p>},</span>
<span class=w>                               </span><span class=mf>1e-8l</span><span class=p>)</span>
<span class=w>                               </span><span class=p>.</span><span class=n>second</span><span class=w> </span><span class=o>+</span>
<span class=w>                           </span><span class=n>k1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>m1</span><span class=p>;</span>
<span class=w>                  </span><span class=p>},</span>
<span class=w>                  </span><span class=mf>1e-8l</span><span class=p>)</span>
<span class=w>                  </span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>fixed</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>setprecision</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></details><h3 data-original-document-end=30288 data-original-document-start=30276 id=更广泛的限制条件>更广泛的限制条件<a title="Permanent link" class=headerlink href=#更广泛的限制条件></a></h3><details class=example data-original-document-end=30492 data-original-document-start=30290 open><summary><a href=https://codeforces.com/problemset/problem/1661/F target=_blank>Codeforces 1661 F. Teleporters</a></summary> <p>有 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=n><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=n xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=n>n</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=n></mjx-container> 条线段，它们的长度由序列 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{a_i\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{a_i\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{a_i\}></mjx-container> 给出。可以将它们任意切割为若干条整数长度的线段，目标是最小化所有线段长度平方的总和。求至少需要切割多少次，才能使这个平方和降到不超过 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=V><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=V xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=V>V</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=V></mjx-container>。</p></details><details class=note data-original-document-end=33154 data-original-document-start=31095><summary>解答</summary> <p>设将长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=a><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=a xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=a></mjx-container> 的线段切割 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 次能得到的最小平方和为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container>。由于均值不等式，当两数之和一定时，两数之差越小，两数的平方和也越小。所以，切割之后得到的线段长度越均匀，总的长度平方和也就越小。但是由于整数约束的存在，最均匀的情形就是得到了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a\bmod (m+1)" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a\bmod (m+1)" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="a\bmod (m+1)" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 条长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lceil a/(m+1)\rceil" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\lceil><mjx-c class=mjx-c2308>⌈</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\rceil><mjx-c class=mjx-c2309>⌉</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lceil a/(m+1)\rceil" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lceil fence=false stretchy=false>⌈</mo><mi data-latex=a>a</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\rceil fence=false stretchy=false>⌉</mo></math></mjx-assistive-mml><img title="\lceil a/(m+1)\rceil" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的线段和 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m+1-(a\bmod (m+1))" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m+1-(a\bmod (m+1))" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img title="m+1-(a\bmod (m+1))" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 条长度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor a/(m+1)\rfloor" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor a/(m+1)\rfloor" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo></math></mjx-assistive-mml><img title="\lfloor a/(m+1)\rfloor" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的线段。因此，有如下表达式：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,m) &= (a\bmod (m+1))\left\lceil\dfrac{a}{m+1}\right\rceil^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 \\
&= (a\bmod (m+1))\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2.
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}(m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 .
\end{aligned}
' data-latex-item={aligned} style=min-width:37.1em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=\left\lceil\dfrac{a}{m+1}\right\rceil^2><mjx-mrow data-latex=\left\lceil\dfrac{a}{m+1}\right\rceil data-latex-item=\left\lceil\dfrac{a}{m+1}\right\rceil><mjx-mo data-latex=\left\lceil data-latex-item=\left\lceil><mjx-c class="mjx-c2308 NCM-S5">⌈</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{m+1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rceil data-latex-item=\right\rceil><mjx-c class="mjx-c2309 NCM-S5">⌉</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.027em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor^2><mjx-mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor><mjx-mo data-latex=\left\lfloor data-latex-item=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{m+1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor data-latex-item=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.027em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2><mjx-mrow data-latex=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right) data-latex-item=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)><mjx-mo data-latex=\left( data-latex-item=\left(><mjx-c class="mjx-c28 NCM-S5">(</mjx-c></mjx-mo><mjx-mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor><mjx-mo data-latex=\left\lfloor data-latex-item=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{m+1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor data-latex-item=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=\right) data-latex-item=\right)><mjx-c class="mjx-c29 NCM-S5">)</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.027em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor^2><mjx-mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor><mjx-mo data-latex=\left\lfloor data-latex-item=\left\lfloor><mjx-c class="mjx-c230A NCM-S5">⌊</mjx-c></mjx-mo><mjx-mfrac data-latex=\dfrac{a}{m+1}><mjx-frac type=d><mjx-num><mjx-nstrut type=d></mjx-nstrut><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type=d></mjx-line><mjx-row><mjx-den><mjx-dstrut type=d></mjx-dstrut><mjx-mrow data-latex=m+1><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo data-latex=\right\rfloor data-latex-item=\right\rfloor><mjx-c class="mjx-c230B NCM-S5">⌋</mjx-c></mjx-mo></mjx-mrow><mjx-script style=vertical-align:1.027em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,m) &= (a\bmod (m+1))\left\lceil\dfrac{a}{m+1}\right\rceil^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 \\&= (a\bmod (m+1))\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2.\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}(m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 .\end{aligned}' columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><msup data-latex=\left\lceil\dfrac{a}{m+1}\right\rceil^2><mrow data-latex=\left\lceil\dfrac{a}{m+1}\right\rceil data-latex-item=\left\lceil\dfrac{a}{m+1}\right\rceil data-mjx-texclass=INNER><mo data-latex=\left\lceil data-latex-item=\left\lceil data-mjx-texclass=OPEN>⌈</mo><mfrac data-latex=\dfrac{a}{m+1}><mi data-latex=a>a</mi><mrow data-latex=m+1><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex=\right\rceil data-latex-item=\right\rceil data-mjx-texclass=CLOSE>⌉</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><msup data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor^2><mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-latex-item=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{m+1}><mi data-latex=a>a</mi><mrow data-latex=m+1><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex=\right\rfloor data-latex-item=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><msup data-latex=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2><mrow data-latex=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right) data-latex-item=\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right) data-mjx-texclass=INNER><mo data-latex=\left( data-latex-item=\left( data-mjx-texclass=OPEN>(</mo><mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-latex-item=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{m+1}><mi data-latex=a>a</mi><mrow data-latex=m+1><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex=\right\rfloor data-latex-item=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=\right) data-latex-item=\right) data-mjx-texclass=CLOSE>)</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><msup data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor^2><mrow data-latex=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-latex-item=\left\lfloor\dfrac{a}{m+1}\right\rfloor data-mjx-texclass=INNER><mo data-latex=\left\lfloor data-latex-item=\left\lfloor data-mjx-texclass=OPEN>⌊</mo><mfrac data-latex=\dfrac{a}{m+1}><mi data-latex=a>a</mi><mrow data-latex=m+1><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn></mrow></mfrac><mo data-latex=\right\rfloor data-latex-item=\right\rfloor data-mjx-texclass=CLOSE>⌋</mo></mrow><mn data-latex=2>2</mn></msup><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,m) &= (a\bmod (m+1))\left\lceil\dfrac{a}{m+1}\right\rceil^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 \\
&= (a\bmod (m+1))\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2.
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>第二步的等号成立，是因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lceil a/(m+1)\rceil \neq \lfloor a/(m+1)\rfloor + 1" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\lceil><mjx-c class=mjx-c2308>⌈</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\rceil><mjx-c class=mjx-c2309>⌉</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\neq><mjx-c class=mjx-c2260>≠</mjx-c></mjx-mo><mjx-mo data-latex=\lfloor space=4><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lceil a/(m+1)\rceil \neq \lfloor a/(m+1)\rfloor + 1" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lceil fence=false stretchy=false>⌈</mo><mi data-latex=a>a</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\rceil fence=false stretchy=false>⌉</mo><mo data-latex=\neq>≠</mo><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex=+>+</mo><mn data-latex=1>1</mn></math></mjx-assistive-mml><img title="\lceil a/(m+1)\rceil \neq \lfloor a/(m+1)\rfloor + 1" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 当且仅当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="a\bmod (m+1) = 0" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' rspace=4 space=4><mjx-c class=mjx-c6D noic=true style=padding-top:.694em>m</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c64 style=padding-top:.694em>d</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mn data-latex=0 space=4><mjx-c class=mjx-c30>0</mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="a\bmod (m+1) = 0" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=a>a</mi><mo data-latex='\mmlToken{mo}[lspace="0.278em" rspace="0.278em"]{mod}' lspace=0.278em rspace=0.278em>mod</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mn data-latex=0>0</mn></math></mjx-assistive-mml><img title="a\bmod (m+1) = 0" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>。</p> <p>可以证明，函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 是关于 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的凸函数。为此，需要将它延拓到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="m\in\mathbf R_{+}" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=4> </mjx-break><mjx-mo data-latex=\in><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-msub data-latex="\mathbf R_{+}" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:-.15em><mjx-texatom data-latex={+} size=s texclass=ORD><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="m\in\mathbf R_{+}" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=\in>∈</mo><msub data-latex="\mathbf R_{+}"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mrow data-latex={+} data-mjx-texclass=ORD><mo data-latex=+>+</mo></mrow></msub></math></mjx-assistive-mml><img title="m\in\mathbf R_{+}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的情形。当 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\lfloor a/(m+1)\rfloor = q" aria-hidden=true breakable=true class=NCM-N><mjx-mo data-latex=\lfloor><mjx-c class=mjx-c230A>⌊</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-texatom texclass=ORD><mjx-mo data-latex=/><mjx-c class=mjx-c2F>/</mjx-c></mjx-mo></mjx-texatom><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\rfloor><mjx-c class=mjx-c230B>⌋</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex="="><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=q space=4><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\lfloor a/(m+1)\rfloor = q" xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\lfloor fence=false stretchy=false>⌊</mo><mi data-latex=a>a</mi><mrow data-mjx-texclass=ORD><mo data-latex=/>/</mo></mrow><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=\rfloor fence=false stretchy=false>⌋</mo><mo data-latex="=">=</mo><mi data-latex=q>q</mi></math></mjx-assistive-mml><img title="\lfloor a/(m+1)\rfloor = q" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 时，有</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
\begin{aligned}
f(a,m) &= (a-(m+1)q)(q+1)^2 + ((m+1)(q+1)-a)q^2 \\
&= a(2q+1) - q(q+1)(m+1).
\end{aligned}
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mtable data-latex="
\begin{aligned}
f(a,m) &= (a-(m+1)q)(q+1)^2  + ((m+1)(q+1)-a)q^2  \\
&= a(2q+1) - q(q+1)(m+1).
\end{aligned}
" data-latex-item={aligned} style=min-width:25.286em><mjx-table><mjx-itable><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-bottom:.15em;padding-right:0><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-bottom:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mo data-latex=( space=4><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-msup data-latex=)^2><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-script style=vertical-align:.413em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mo data-latex=( space=3><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=a space=3><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-msup data-latex=q^2><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-script style=vertical-align:.413em;margin-left:.05em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr data-latex="
" data-latex-item="
"><mjx-mtd style=text-align:right;padding-top:.15em;padding-right:0><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=text-align:left;padding-top:.15em;padding-left:0><mjx-mstyle><mjx-mi></mjx-mi><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=a space=4><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mn data-latex=2><mjx-c class=mjx-c32>2</mjx-c></mjx-mn><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=q space=3><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-mstyle><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="\begin{aligned}f(a,m) &= (a-(m+1)q)(q+1)^2 + ((m+1)(q+1)-a)q^2 \\&= a(2q+1) - q(q+1)(m+1).\end{aligned}" display=block xmlns=http://www.w3.org/1998/Math/MathML><mtable columnalign="right left" data-break-align="bottom top" data-latex="\begin{aligned}f(a,m) &= (a-(m+1)q)(q+1)^2  + ((m+1)(q+1)-a)q^2  \\&= a(2q+1) - q(q+1)(m+1).\end{aligned}" columnspacing=0em data-latex-item={aligned} displaystyle=true rowspacing=3pt><mtr data-latex data-latex-item><mtd><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=->−</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mi data-latex=q>q</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><msup data-latex=)^2><mo data-latex=) stretchy=false>)</mo><mn data-latex=2>2</mn></msup><mo data-latex=+>+</mo><mo data-latex=( stretchy=false>(</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=a>a</mi><mo data-latex=) stretchy=false>)</mo><msup data-latex=q^2><mi data-latex=q>q</mi><mn data-latex=2>2</mn></msup></mstyle></mtd></mtr><mtr data-latex data-latex-item><mtd></mtd><mtd><mstyle indentshift=2em><mi></mi><mo data-latex="=">=</mo><mi data-latex=a>a</mi><mo data-latex=( stretchy=false>(</mo><mn data-latex=2>2</mn><mi data-latex=q>q</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=q>q</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo><mo data-latex=.>.</mo></mstyle></mtd></mtr></mtable></math></mjx-assistive-mml><img title="
\begin{aligned}
f(a,m) &= (a-(m+1)q)(q+1)^2 + ((m+1)(q+1)-a)q^2 \\
&= a(2q+1) - q(q+1)(m+1).
\end{aligned}
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这是斜率为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=-q(q+1)><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=q><mjx-c class=mjx-c1D45E>𝑞</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=+><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=-q(q+1) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=->−</mo><mi data-latex=q>q</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=q>q</mi><mo data-latex=+>+</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=-q(q+1)></mjx-container> 的直线。因此，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 是分段线性函数，且斜率随着 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的增加而增加。这就说明了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 是凸函数，它限制在整点上当然也是凸函数<sup id=fnref:conv-int><a class=footnote-ref href=#fn:conv-int>5</a></sup>。</p> <p>利用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=f(\cdot,\cdot)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-break size=2> </mjx-break><mjx-mo data-latex=\cdot><mjx-c class=mjx-c22C5>⋅</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(\cdot,\cdot) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=,>,</mo><mo data-latex=\cdot>⋅</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(\cdot,\cdot)></mjx-container>，可以将所有线段总共切割 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 次得到的最小平方和写作如下最优化问题的价值函数：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(m) = \min_{\{m_i\}}\sum_i f(a_i,m_i)\text{ subject to }\sum_i m_i=m,~m_i\in\mathbf N.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\min_{\{m_i\}} space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.054em><mjx-texatom data-latex={\{m_i\}} size=s texclass=ORD><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=m_i><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex=\sum_i space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.6em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_i space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mtext data-latex="\text{ subject to }"><mjx-c class=mjx-cA0 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-munder data-latex=\sum_i space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.6em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=m_i space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=m space=4><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mtext data-latex=~ space=2><mjx-c class=mjx-cA0> </mjx-c></mjx-mtext><mjx-msub data-latex=m_i><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\in space=4><mjx-c class=mjx-c2208>∈</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf N" space=4 texclass=ORD><mjx-mi data-latex=N><mjx-c class=mjx-c1D40D>𝐍</mjx-c></mjx-mi></mjx-texatom><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(m) = \min_{\{m_i\}}\sum_i f(a_i,m_i)\text{ subject to }\sum_i m_i=m,~m_i\in\mathbf N." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\min_{\{m_i\}}><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex={\{m_i\}} data-mjx-texclass=ORD><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></mrow></munder><munder data-latex=\sum_i><mo data-latex=\sum>∑</mo><mi data-latex=i>i</mi></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo><mtext data-latex="\text{ subject to }"> subject to </mtext><munder data-latex=\sum_i><mo data-latex=\sum>∑</mo><mi data-latex=i>i</mi></munder><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex="=">=</mo><mi data-latex=m>m</mi><mo data-latex=,>,</mo><mtext data-latex=~> </mtext><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=\in>∈</mo><mrow data-latex="\mathbf N" data-mjx-texclass=ORD><mi data-latex=N mathvariant=bold>N</mi></mrow><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
v(m) = \min_{\{m_i\}}\sum_i f(a_i,m_i)\text{ subject to }\sum_i m_i=m,~m_i\in\mathbf N.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>这是若干个凸函数的 <a href=../slope-trick/#卷积下确界minkowski-和>卷积下确界</a>，所以也是凸函数。如果题目要求的是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container>，那么，可以使用与之前的例题一致的方法求解，时间复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^2L)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^2 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^2L) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^2><mi data-latex=\log>log</mi><mn data-latex=2>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^2L)></mjx-container>；但是，本题求的是满足 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="v(m)\le V" aria-hidden=true breakable=true class=NCM-N><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=4> </mjx-break><mjx-mo data-latex=\le><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=V space=4><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="v(m)\le V" xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=V>V</mi></math></mjx-assistive-mml><img title="v(m)\le V" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 的最小的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container>。利用 WQS 二分计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 再对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 二分的方法是行不通的，它的复杂度达到了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^3L)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^3 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=3 size=s><mjx-c class=mjx-c33>3</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^3L) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^3><mi data-latex=\log>log</mi><mn data-latex=3>3</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^3L)></mjx-container>。就本题而言，有如下两种处理方法。</p> <p><strong>方法一</strong>：仍然二分斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>，但是二分的依据是对 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 上下界的估计。</p> <p>传统的 WQS 二分的方法中，对于给定的斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>，可以计算出相应的最优的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的取值范围。因为这些 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=(m,v(m))><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=(m,v(m)) xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=(m,v(m))></mjx-container> 共线，所以这相当于确定了 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的取值范围。因此，可以直接二分斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container>。得到斜率 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=k><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=k xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=k>k</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=k></mjx-container> 之后，可以利用直线方程</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
v(m) = h(k) + km
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-mi data-latex=h space=4><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=k space=3><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="v(m) = h(k) + km" display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=k>k</mi><mi data-latex=m>m</mi></math></mjx-assistive-mml><img title="
v(m) = h(k) + km
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>计算出最小的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container>。整体复杂度为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^2L)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^2 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^2L) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^2><mi data-latex=\log>log</mi><mn data-latex=2>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^2L)></mjx-container>。</p> <p>为了确定 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的取值范围，需要确定 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的取值范围。一种做法是，在计算 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=h(k)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(k) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(k)></mjx-container> 时记录相应的最大最优解，利用它可以计算相应的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的下界；另一种做法是，利用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true breakable=true class=NCM-N data-latex=h(k)-h(k-1)><mjx-mi data-latex=h><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=h space=3><mjx-c class=mjx-c210E>ℎ</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi><mjx-break size=3> </mjx-break><mjx-mo data-latex=-><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mn data-latex=1 space=3><mjx-c class=mjx-c31>1</mjx-c></mjx-mn><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=h(k)-h(k-1) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=->−</mo><mi data-latex=h>h</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=k>k</mi><mo data-latex=->−</mo><mn data-latex=1>1</mn><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=h(k)-h(k-1)></mjx-container> 得到相应的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m></mjx-container> 的上界，进而得到相应的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(m)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(m)></mjx-container> 的下界。参考实现中，采用的是第二种做法，它不依赖于问题的具体结构，无需特别处理。</p> <p><strong>方法二</strong>：改写最优化问题，使得对偶问题的价值函数就是本问题的解。</p> <p>本问题可以直接看作是如下最优化问题：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
m(v) = \min_{\{m_i\}} \sum_i m_i \text{ subject to }\sum_i f(a_i,m_i) \le V.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\min_{\{m_i\}} space=4><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.054em><mjx-texatom data-latex={\{m_i\}} size=s texclass=ORD><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-msub data-latex=m_i><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex=\sum_i space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.6em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-msub data-latex=m_i space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext data-latex="\text{ subject to }"><mjx-c class=mjx-cA0 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c73 noic=true style=padding-top:.694em>s</mjx-c><mjx-c class=mjx-c75 noic=true style=padding-top:.694em>u</mjx-c><mjx-c class=mjx-c62 noic=true style=padding-top:.694em>b</mjx-c><mjx-c class=mjx-c6A noic=true style=padding-top:.694em>j</mjx-c><mjx-c class=mjx-c65 noic=true style=padding-top:.694em>e</mjx-c><mjx-c class=mjx-c63 noic=true style=padding-top:.694em>c</mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c20 noic=true style=padding-top:.694em> </mjx-c><mjx-c class=mjx-c74 noic=true style=padding-top:.694em>t</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-cA0 style=padding-top:.694em> </mjx-c></mjx-mtext><mjx-munder data-latex=\sum_i space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.6em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi data-latex=f space=2><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_i space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\le space=4><mjx-c class=mjx-c2264>≤</mjx-c></mjx-mo><mjx-mi data-latex=V space=4><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="m(v) = \min_{\{m_i\}} \sum_i m_i \text{ subject to }\sum_i f(a_i,m_i) \le V." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=v>v</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\min_{\{m_i\}}><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex={\{m_i\}} data-mjx-texclass=ORD><mo data-latex=\{ fence=false stretchy=false>{</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=\} fence=false stretchy=false>}</mo></mrow></munder><munder data-latex=\sum_i><mo data-latex=\sum>∑</mo><mi data-latex=i>i</mi></munder><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mtext data-latex="\text{ subject to }"> subject to </mtext><munder data-latex=\sum_i><mo data-latex=\sum>∑</mo><mi data-latex=i>i</mi></munder><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=\le>≤</mo><mi data-latex=V>V</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
m(v) = \min_{\{m_i\}} \sum_i m_i \text{ subject to }\sum_i f(a_i,m_i) \le V.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>本文的分析仍然适用于这一问题。故而，可以利用它的对偶问题求解所要求的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=m(v)><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=m(v) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=v>v</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=m(v)></mjx-container>：</p> <mjx-container class=MathJax display=true jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="
m(v) = \max_{k} \sum_i\min_{m_i}(m_i - \lambda f(a_i,m_i)) + \lambda V.
" aria-hidden=true class=NCM-N display=true style=margin-left:0;margin-right:0><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex="=" space=4><mjx-c class=mjx-c3D>=</mjx-c></mjx-mo><mjx-munder data-latex=\max_{k} space=4><mjx-row><mjx-base><mjx-mo data-latex=\max><mjx-c class=mjx-c6D noic=true style=padding-top:.448em>m</mjx-c><mjx-c class=mjx-c61 noic=true style=padding-top:.448em>a</mjx-c><mjx-c class=mjx-c78 style=padding-top:.448em>x</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.746em><mjx-texatom data-latex={k} size=s texclass=ORD><mjx-mi data-latex=k><mjx-c class=mjx-c1D458>𝑘</mjx-c></mjx-mi></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex=\sum_i space=2><mjx-row><mjx-base><mjx-mo data-latex=\sum><mjx-c class="mjx-c2211 NCM-LO">∑</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.167em;padding-left:.6em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-munder data-latex=\min_{m_i} space=2><mjx-row><mjx-base><mjx-mo data-latex=\min><mjx-c class=mjx-c6D noic=true style=padding-top:.657em>m</mjx-c><mjx-c class=mjx-c69 noic=true style=padding-top:.657em>i</mjx-c><mjx-c class=mjx-c6E style=padding-top:.657em>n</mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style=padding-top:.287em;padding-left:.407em><mjx-texatom data-latex={m_i} size=s texclass=ORD><mjx-msub data-latex=m_i><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-under></mjx-row></mjx-munder><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=m_i><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=- space=3><mjx-c class=mjx-c2212>−</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-msub data-latex=a_i><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msub data-latex=m_i space=2><mjx-mi data-latex=m><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-script style=vertical-align:-.15em><mjx-mi data-latex=i size=s><mjx-c class=mjx-c1D456>𝑖</mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=+ space=3><mjx-c class=mjx-c2B>+</mjx-c></mjx-mo><mjx-mi data-latex=\lambda space=3><mjx-c class=mjx-c1D706>𝜆</mjx-c></mjx-mi><mjx-mi data-latex=V><mjx-c class=mjx-c1D449>𝑉</mjx-c></mjx-mi><mjx-mo data-latex=.><mjx-c class=mjx-c2E>.</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=block unselectable=on><math data-latex="m(v) = \max_{k} \sum_i\min_{m_i}(m_i - \lambda f(a_i,m_i)) + \lambda V." display=block xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=m>m</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=v>v</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex="=">=</mo><munder data-latex=\max_{k}><mo data-latex=\max data-mjx-texclass=OP movablelimits=true>max</mo><mrow data-latex={k} data-mjx-texclass=ORD><mi data-latex=k>k</mi></mrow></munder><munder data-latex=\sum_i><mo data-latex=\sum>∑</mo><mi data-latex=i>i</mi></munder><munder data-latex=\min_{m_i}><mo data-latex=\min data-mjx-texclass=OP movablelimits=true>min</mo><mrow data-latex={m_i} data-mjx-texclass=ORD><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub></mrow></munder><mo data-latex=( stretchy=false>(</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=->−</mo><mi data-latex=\lambda>λ</mi><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><msub data-latex=a_i><mi data-latex=a>a</mi><mi data-latex=i>i</mi></msub><mo data-latex=,>,</mo><msub data-latex=m_i><mi data-latex=m>m</mi><mi data-latex=i>i</mi></msub><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=+>+</mo><mi data-latex=\lambda>λ</mi><mi data-latex=V>V</mi><mo data-latex=.>.</mo></math></mjx-assistive-mml><img title="
m(v) = \max_{k} \sum_i\min_{m_i}(m_i - \lambda f(a_i,m_i)) + \lambda V.
" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> <p>整体算法复杂度仍然是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=O(n\log^2L)><mjx-mi data-latex=O><mjx-c class=mjx-c1D442>𝑂</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=n><mjx-c class=mjx-c1D45B>𝑛</mjx-c></mjx-mi><mjx-msup data-latex=\log^2 space=2><mjx-mi data-latex=\log><mjx-c class=mjx-c6C noic=true style=padding-top:.694em>l</mjx-c><mjx-c class=mjx-c6F noic=true style=padding-top:.694em>o</mjx-c><mjx-c class=mjx-c67 style=padding-top:.694em>g</mjx-c></mjx-mi><mjx-script style=vertical-align:.421em><mjx-mn data-latex=2 size=s><mjx-c class=mjx-c32>2</mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo><mjx-c class=mjx-c2061>⁡</mjx-c></mjx-mo><mjx-mi data-latex=L space=2><mjx-c class=mjx-c1D43F>𝐿</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=O(n\log^2L) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=O>O</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=n>n</mi><msup data-latex=\log^2><mi data-latex=\log>log</mi><mn data-latex=2>2</mn></msup><mo data-mjx-texclass=NONE>⁡</mo><mi data-latex=L>L</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=O(n\log^2L)></mjx-container> 的。</p> <p>参考代码如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>方法一</label><label for=__tabbed_4_2>方法二</label></div><div class=tabbed-content><div class=tabbed-block><p>代码仅做示意，为通过原题数据范围，需要 128 位整数，并调整二分初始区间为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=[0,10^{60}]><mjx-mo data-latex=[><mjx-c class=mjx-c5B>[</mjx-c></mjx-mo><mjx-mn data-latex=0><mjx-c class=mjx-c30>0</mjx-c></mjx-mn><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-msup data-latex=0^{0} space=2><mjx-mn data-latex=0><mjx-c class=mjx-c31 noic=true style=padding-top:.666em>1</mjx-c><mjx-c class=mjx-c30 style=padding-top:.666em>0</mjx-c></mjx-mn><mjx-script style=vertical-align:.393em><mjx-texatom data-latex={0} size=s texclass=ORD><mjx-mn data-latex=0><mjx-c class=mjx-c36 noic=true style=padding-top:.666em>6</mjx-c><mjx-c class=mjx-c30 style=padding-top:.666em>0</mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo data-latex=]><mjx-c class=mjx-c5D>]</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=[0,10^{60}] xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=[ stretchy=false>[</mo><mn data-latex=0>0</mn><mo data-latex=,>,</mo><msup data-latex=0^{0}><mn data-latex=0>10</mn><mrow data-latex={0} data-mjx-texclass=ORD><mn data-latex=0>60</mn></mrow></msup><mo data-latex=] stretchy=false>]</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=[0,10^{60}]></mjx-container>。</p><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span>
<span class=normal>77</span>
<span class=normal>78</span>
<span class=normal>79</span>
<span class=normal>80</span>
<span class=normal>81</span>
<span class=normal>82</span>
<span class=normal>83</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Golden section search on integer domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_integral</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ml</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>mr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ll</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>val</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>best_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>best_x</span><span class=p>,</span><span class=w> </span><span class=n>best_val</span><span class=p>};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>];</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>v</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>v</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Cost of adding M more teleporters to a segment of length LEN.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>len</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>rem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>rem</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rem</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=o>-</span><span class=n>golden_section_search</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>f</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
<span class=w>              </span><span class=p>}).</span><span class=n>second</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Find the smallest k such that h(k) + k * m &lt;= v.</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=p>(</span><span class=mf>1L</span><span class=n>L</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>30</span><span class=p>),</span><span class=w> </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>ti</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>fi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>mm</span><span class=p>);</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>ub</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fi</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fi</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>ub</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>v</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ti</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=p>;</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mm</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)((</span><span class=n>calc</span><span class=p>(</span><span class=n>ti</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ti</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=o>-</span><span class=n>ti</span><span class=p>))</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div><div class=tabbed-block><p>代码仅做示意，由于浮点数精度问题无法通过原题数据范围。</p><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;tuple></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;type_traits></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector></span>

<span class=c1>// Golden section search on integer domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_integral</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>ml</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>mr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>));</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>static_cast</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ll</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>rr</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>val</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>best_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>best_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>val</span><span class=p>;</span>
<span class=w>      </span><span class=n>best_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>best_x</span><span class=p>,</span><span class=w> </span><span class=n>best_val</span><span class=p>};</span>
<span class=p>}</span>

<span class=c1>// Golden section search on floating-point domain (unimodal function)</span>
<span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>F</span><span class=o>></span>
<span class=k>typename</span><span class=w> </span><span class=nc>std</span><span class=o>::</span><span class=n>enable_if</span><span class=o>&lt;</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>is_floating_point</span><span class=o>&lt;</span><span class=n>T</span><span class=o>>::</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>F</span><span class=o>></span><span class=p>()(</span><span class=n>std</span><span class=o>::</span><span class=n>declval</span><span class=o>&lt;</span><span class=n>T</span><span class=o>></span><span class=p>()))</span><span class=o>>>::</span><span class=n>type</span>
<span class=n>golden_section_search</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>ll</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>rr</span><span class=p>,</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=n>func</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>eps</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>constexpr</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>phi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.618033988749894848204586834L</span><span class=p>;</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>;</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>),</span><span class=w> </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>((</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>eps</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fl</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>fr</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>rr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fl</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>phi</span><span class=p>);</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>ml</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>ll</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ml</span><span class=p>;</span>
<span class=w>      </span><span class=n>ml</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mr</span><span class=p>;</span>
<span class=w>      </span><span class=n>fl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fr</span><span class=p>;</span>
<span class=w>      </span><span class=n>mr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>rr</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ll</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>phi</span><span class=p>;</span>
<span class=w>      </span><span class=n>fr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mr</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>T</span><span class=w> </span><span class=n>mid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>ll</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>mid</span><span class=p>,</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>mid</span><span class=p>)};</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>n</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>a</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>];</span>
<span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>v</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>v</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// Cost of adding M more teleporters to a segment of length LEN.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>len</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>rem</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>rem</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rem</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>q</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Calculate h(k) = min_x f(x) - k * g(x).</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>calc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>res</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=o>-</span><span class=n>golden_section_search</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>m</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=n>m</span><span class=p>);</span>
<span class=w>              </span><span class=p>}).</span><span class=n>second</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>res</span><span class=p>;</span>
<span class=w>  </span><span class=p>};</span>
<span class=w>  </span><span class=c1>// Solve the dual problem.</span>
<span class=w>  </span><span class=k>auto</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span>
<span class=w>      </span><span class=n>golden_section_search</span><span class=p>(</span>
<span class=w>          </span><span class=mf>-1.0l</span><span class=p>,</span><span class=w> </span><span class=mf>0.0l</span><span class=p>,</span>
<span class=w>          </span><span class=p>[</span><span class=o>&</span><span class=p>](</span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>-></span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>calc</span><span class=p>(</span><span class=n>k</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>v</span><span class=p>;</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=mf>1e-12l</span><span class=p>)</span>
<span class=w>          </span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>ceill</span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div></div></div></div></details><h2 data-original-document-end=33161 data-original-document-start=33156 id=习题>习题<a title="Permanent link" class=headerlink href=#习题></a></h2><p data-original-document-end=33192 data-original-document-start=33163>最后，列举一些可以通过 WQS 二分解决的题目，以供练习：</p><ul data-original-document-end=35174 data-original-document-start=33194><li><a href=https://www.luogu.com.cn/problem/P1484 target=_blank>Luogu P1484 种树</a></li><li><a href=https://www.luogu.com.cn/problem/P1792 target=_blank>Luogu P1792 [国家集训队] 种树</a></li><li><a href=https://www.luogu.com.cn/problem/P2619 target=_blank>Luogu P2619 [国家集训队] Tree I</a></li><li><a href=https://www.luogu.com.cn/problem/P3620 target=_blank>Luogu P3620 [APIO/CTSC2007] 数据备份</a></li><li><a href=https://www.luogu.com.cn/problem/P4072 target=_blank>Luogu P4072 [SDOI2016] 征途</a></li><li><a href=https://www.luogu.com.cn/problem/P4383 target=_blank>Luogu P4383 [八省联考 2018] 林克卡特树</a></li><li><a href=https://www.luogu.com.cn/problem/P4983 target=_blank>Luogu P4983 忘情</a></li><li><a href=https://www.luogu.com.cn/problem/P5308 target=_blank>Luogu P5308 [COCI 2018/2019 #4] Akvizna</a></li><li><a href=https://www.luogu.com.cn/problem/P5633 target=_blank>Luogu P5633 最小度限制生成树</a></li><li><a href=https://www.luogu.com.cn/problem/P5896 target=_blank>Luogu P5896 [IOI 2016] aliens</a></li><li><a href=https://www.luogu.com.cn/problem/P6246 target=_blank>Luogu P6246 [IOI 2000] 邮局 加强版 加强版</a></li><li><a href=https://atcoder.jp/contests/abc218/tasks/abc218_h target=_blank>AtCoder Beginner Contest 218 H - Red and Blue Lamps</a></li><li><a href=https://atcoder.jp/contests/abc305/tasks/abc305_h target=_blank>AtCoder Beginner Contest 305 Ex - Shojin</a></li><li><a href=https://atcoder.jp/contests/arc164/tasks/arc164_e target=_blank>AtCoder Regular Contest 164 E - Segment-Tree Optimization</a></li><li><a href=https://codeforces.com/problemset/problem/125/E target=_blank>Codeforces 125 E. MST Company</a></li><li><a href=https://codeforces.com/problemset/problem/321/E target=_blank>Codeforces 321 E. Ciel and Gondolas</a></li><li><a href=https://codeforces.com/problemset/problem/739/E target=_blank>Codeforces 739 E. Gosha is hunting</a></li><li><a href=https://codeforces.com/contest/802/problem/O target=_blank>Codeforces 802 O. April Fools' Problem (hard)</a></li><li><a href=https://codeforces.com/problemset/problem/958/E2 target=_blank>Codeforces 958 E2. Guard Duty (medium)</a></li><li><a href=https://codeforces.com/problemset/problem/1279/F target=_blank>Codeforces 1279 F. New Year and Handle Change</a></li><li><a href=https://codeforces.com/problemset/problem/1661/F target=_blank>Codeforces 1661 F. Teleporters</a></li><li><a href=https://codeforces.com/problemset/problem/1799/F target=_blank>Codeforces 1799 F. Halve or Subtract</a></li><li><a href=https://codeforces.com/gym/102331/problem/H target=_blank>2019 Summer Petrozavodsk Camp H. Honorable Mention</a></li></ul><h2 data-original-document-end=35186 data-original-document-start=35176 id=参考资料与注释>参考资料与注释<a title="Permanent link" class=headerlink href=#参考资料与注释></a></h2><ul data-original-document-end=37713 data-original-document-start=35188><li><a href=https://github.com/hzwer/shareOI/blob/master/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/%E6%B5%85%E6%9E%90%E4%B8%80%E7%B1%BB%E4%BA%8C%E5%88%86%E6%96%B9%E6%B3%95_%E7%8E%8B%E9%92%A6%E7%9F%B3.pdf target=_blank>王钦石《浅析一类二分方法》</a></li><li><a href=https://codeforces.com/blog/entry/98334 target=_blank>Theoretical grounds of lambda optimization by adamant - Codeforces blog</a></li><li><a href=https://www.luogu.com.cn/article/vsffwrc3 target=_blank>严谨的 WQS 二分方法 by YeahPotato - 洛谷博客</a></li><li><a href=https://blog.csdn.net/Emm_Titan/article/details/124035796 target=_blank>【学习笔记】WQS 二分详解及常见理解误区解释 by ikrvxt - CSDN 博客</a></li><li><a href=https://en.wikipedia.org/wiki/Convex_conjugate target=_blank>Convex conjugate - Wikipedia</a></li><li><a href=https://en.wikipedia.org/wiki/Fenchel%E2%80%93Moreau_theorem target=_blank>Fenchel–Moreau theorem - Wikipedia</a></li><li><a href=https://en.wikipedia.org/wiki/Subderivative target=_blank>Subderivative - Wikipedia</a></li><li><a href=https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf target=_blank>Boyd, Stephen P., and Lieven Vandenberghe. Convex optimization. Cambridge university press, 2004.</a></li><li>Papadimitriou, Christos H., and Kenneth Steiglitz. Combinatorial optimization: algorithms and complexity. Courier Corporation, 1998.</li><li>Conforti, Michele, Gérard Cornuéjols, and Giacomo Zambelli. Integer programming. Springer International Publishing, 2014.</li><li>Schrijver, Alexander. Combinatorial optimization: polyhedra and efficiency. Vol. 24, no. 2. Berlin: Springer, 2003.</li></ul><div class=footnote><hr><ol><li id=fn:high-d-convex><p>实际问题中，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=y><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=y xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=y>y</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=y></mjx-container> 可能只能取到 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf R^d" aria-hidden=true class=NCM-N><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 中的有限多个格点。此处实际需要的条件是，原问题的解 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 可以延拓为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\mathbf R^d" aria-hidden=true class=NCM-N><mjx-msup data-latex="\mathbf R^d"><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\mathbf R^d" xmlns=http://www.w3.org/1998/Math/MathML><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup></math></mjx-assistive-mml><img title="\mathbf R^d" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 上的凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\tilde v:\mathbf R^d\rightarrow \mathbf R\cup\{\pm\infty\}" aria-hidden=true breakable=true class=NCM-N><mjx-texatom data-latex="\tilde v" texclass=ORD><mjx-mover><mjx-over style=margin-bottom:-.556em;padding-bottom:.105em;padding-left:.293em><mjx-mo style=width:0;margin-left:-.25em><mjx-c class=mjx-c2DC>˜</mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-break size=4> </mjx-break><mjx-mo data-latex=:><mjx-c class=mjx-c3A>:</mjx-c></mjx-mo><mjx-msup data-latex="\mathbf R^d" space=4><mjx-texatom data-latex="\mathbf R" texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-script style=vertical-align:.363em><mjx-mi data-latex=d size=s><mjx-c class=mjx-c1D451>𝑑</mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-break size=4> </mjx-break><mjx-mo data-latex=\rightarrow><mjx-c class=mjx-c2192>→</mjx-c></mjx-mo><mjx-texatom data-latex="\mathbf R" space=4 texclass=ORD><mjx-mi data-latex=R><mjx-c class=mjx-c1D411>𝐑</mjx-c></mjx-mi></mjx-texatom><mjx-break size=3> </mjx-break><mjx-mo data-latex=\cup><mjx-c class=mjx-c222A>∪</mjx-c></mjx-mo><mjx-mo data-latex=\{ space=3><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-break size=0> </mjx-break><mjx-mo data-latex=\pm><mjx-c class=mjx-cB1>±</mjx-c></mjx-mo><mjx-mi data-latex=\infty><mjx-c class=mjx-c221E>∞</mjx-c></mjx-mi><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\tilde v:\mathbf R^d\rightarrow \mathbf R\cup\{\pm\infty\}" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\tilde v" data-mjx-texclass=ORD><mover><mi data-latex=v>v</mi><mo stretchy=false>~</mo></mover></mrow><mo data-latex=:>:</mo><msup data-latex="\mathbf R^d"><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mi data-latex=d>d</mi></msup><mo data-latex=\rightarrow stretchy=false>→</mo><mrow data-latex="\mathbf R" data-mjx-texclass=ORD><mi data-latex=R mathvariant=bold>R</mi></mrow><mo data-latex=\cup>∪</mo><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=\pm>±</mo><mi data-latex=\infty mathvariant=normal>∞</mi><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img title="\tilde v:\mathbf R^d\rightarrow \mathbf R\cup\{\pm\infty\}" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container>，也就是说 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 是 <strong>可凸延拓的</strong>（convex-extensible）。为行文方便，正文中仍然用 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 表示延拓后的函数。几何直观上，这相当于说点集 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=\{(y,v(y))\}><mjx-mo data-latex=\{><mjx-c class=mjx-c7B>{</mjx-c></mjx-mo><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=v space=2><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo><mjx-mo data-latex=\}><mjx-c class=mjx-c7D>}</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=\{(y,v(y))\} xmlns=http://www.w3.org/1998/Math/MathML><mo data-latex=\{ fence=false stretchy=false>{</mo><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=,>,</mo><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo><mo data-latex=) stretchy=false>)</mo><mo data-latex=\} fence=false stretchy=false>}</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=\{(y,v(y))\}></mjx-container> 全部都位于它们的凸包的下凸壳上。对于一维的情形，这一条件利用代数语言 <a href=../slope-trick/#离散点集上的凸函数>很容易刻画</a>；但是，对于高维的情形，这稍微有些复杂，<a href=https://kzmurota.fpark.tmu.ac.jp/paper/HIMSummerSchool15Murota.pdf target=_blank>这份讲义</a> 中提供了一些简单的充分条件。 <a title="Jump back to footnote 1 in the text" class=footnote-backref href=#fnref:high-d-convex>↩</a></p></li><li id=fn:other-conditions><p>定理中提供的条件看似比凸函数更强一些，但是，对于算法竞赛能够遇到的情形，特别是 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=X><mjx-mi data-latex=X><mjx-c class=mjx-c1D44B>𝑋</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=X xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=X>X</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=X></mjx-container> 为有限集合时，仅强调凸函数就已经足够。由离散集合上的正常凸函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v></mjx-container> 延拓而来的函数 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math data-latex="\tilde v" aria-hidden=true class=NCM-N><mjx-texatom data-latex="\tilde v" texclass=ORD><mjx-mover><mjx-over style=margin-bottom:-.556em;padding-bottom:.105em;padding-left:.293em><mjx-mo style=width:0;margin-left:-.25em><mjx-c class=mjx-c2DC>˜</mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex="\tilde v" xmlns=http://www.w3.org/1998/Math/MathML><mrow data-latex="\tilde v" data-mjx-texclass=ORD><mover><mi data-latex=v>v</mi><mo stretchy=false>~</mo></mover></mrow></math></mjx-assistive-mml><img title="\tilde v" src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7></mjx-container> 必然是下半连续的凸函数，因为有限多个点的凸包必然是闭凸包，而所谓下半连续的凸函数，就等价于它的上境图是闭凸包。至于正常凸函数中的「正常」一词，只要 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=v(y)><mjx-mi data-latex=v><mjx-c class=mjx-c1D463>𝑣</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=y><mjx-c class=mjx-c1D466>𝑦</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=v(y) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=v>v</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=y>y</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=v(y)></mjx-container> 在至少一个点处取得有限值且是凸函数，就可以保证。 <a title="Jump back to footnote 2 in the text" class=footnote-backref href=#fnref:other-conditions>↩</a></p></li><li id=fn:mst><p>最小生成树问题有两种常见的写成线性规划问题的 <a href=https://math.arizona.edu/~glickenstein/math443f14/golari.pdf target=_blank>方法</a>：子回路消除模型（subtour-elimination formulation）和基于割集的模型（cut-based formulation）。只有前一种建模方式能够保证得到的线性规划问题和原问题是等价的。 <a title="Jump back to footnote 3 in the text" class=footnote-backref href=#fnref:mst>↩</a></p></li><li id=fn:edge-swap><p>这一引理对于一般的 <a href=../../../math/matroid/>拟阵</a> 也是成立的。它称为 <strong>对称基交换性质</strong>（symmetric base-exchange property），相关资料可以参考 <a href=https://en.wikipedia.org/wiki/Basis_of_a_matroid target=_blank>Wikipedia 页面</a>。因此，本题关于凸性的结论可以推广到一般的拟阵上。 <a title="Jump back to footnote 4 in the text" class=footnote-backref href=#fnref:edge-swap>↩</a></p></li><li id=fn:conv-int><p>当然，<mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 和它限制在整点上得到的函数的凸包并不相同，因为 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 可能存在非整数位置处的极点。这说明，并不能将定义域为实数的 <mjx-container class=MathJax jax=CHTML overflow=scroll style=position:relative><mjx-math aria-hidden=true class=NCM-N data-latex=f(a,m)><mjx-mi data-latex=f><mjx-c class=mjx-c1D453>𝑓</mjx-c></mjx-mi><mjx-mo data-latex=(><mjx-c class=mjx-c28>(</mjx-c></mjx-mo><mjx-mi data-latex=a><mjx-c class=mjx-c1D44E>𝑎</mjx-c></mjx-mi><mjx-mo data-latex=,><mjx-c class=mjx-c2C>,</mjx-c></mjx-mo><mjx-mi data-latex=m space=2><mjx-c class=mjx-c1D45A>𝑚</mjx-c></mjx-mi><mjx-mo data-latex=)><mjx-c class=mjx-c29>)</mjx-c></mjx-mo></mjx-math><mjx-assistive-mml display=inline unselectable=on><math data-latex=f(a,m) xmlns=http://www.w3.org/1998/Math/MathML><mi data-latex=f>f</mi><mo data-latex=( stretchy=false>(</mo><mi data-latex=a>a</mi><mo data-latex=,>,</mo><mi data-latex=m>m</mi><mo data-latex=) stretchy=false>)</mo></math></mjx-assistive-mml><img src=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 title=f(a,m)></mjx-container> 直接用于本题的最优化问题中。 <a title="Jump back to footnote 5 in the text" class=footnote-backref href=#fnref:conv-int>↩</a></p></li></ol></div><hr><blockquote class=page-copyright><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"></path></svg></i>本页面最近更新：</span><span class=facts_modified>2025/9/27 00:48:44</span>，<a class=edit_history href=https://github.com/OI-wiki/OI-wiki/commits/master/docs/dp/opt/wqs-binary-search.md target=_blank>更新历史</a><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"></path></svg></i>发现错误？想一起完善？ <a href="https://oi-wiki.org/edit-landing/?ref=/dp/opt/wqs-binary-search.md" class=page_edit_url title=edit.link.title>在 GitHub 上编辑此页！</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 1 0 9 11a3.5 3.5 0 0 0 3.5-3.5m3.44 5.5A5.32 5.32 0 0 1 18 17v2h4v-2s0-3.63-6.06-4M15 4a3.4 3.4 0 0 0-1.93.59 5 5 0 0 1 0 5.82A3.4 3.4 0 0 0 15 11a3.5 3.5 0 0 0 0-7"></path></svg></i>本页面贡献者：</span><span class=page_contributors><a href=https://github.com/c-forrest target=_blank>c-forrest</a>, <a href=https://github.com/HeRaNO target=_blank>HeRaNO</a>, <a href=https://github.com/jyeric target=_blank>jyeric</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.4 1.4 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8"></path></svg></i>本页面的全部内容在 <strong><a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh target=_blank>CC BY-SA 4.0</a> 和 <a href=https://github.com/zTrix/sata-license target=_blank>SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span></blockquote><div class=giscus data-no-instant id=__comments></div><div id=__comments_script></div><script>var comments=document.createElement("script"),commentsTheme="slate"===document.body.dataset.mdColorScheme?"dark":"light";Object.entries({async:!0,src:"https://giscus.app/client.js",crossOrigin:"anonymous","data-repo":"OI-wiki/gitment","data-repo-id":"MDEwOlJlcG9zaXRvcnkxNDQzODg5NjU=","data-category":"评论","data-category-id":"DIC_kwDOCJszZc4CS54y","data-mapping":"specific","data-term":"WQS 二分","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":commentsTheme,"data-lang":"zh-CN","data-loading":"lazy"}).forEach((e=>comments.setAttribute(e[0],e[1]))),document.getElementById("__comments_script").replaceWith(comments)</script></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><script>function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script><button class=data-tip-left data-tip=回到顶部 id=myBtn onclick=topFunction()><svg class="Zi Zi--BackToTop data-tip-left" viewbox="0 0 24 24" data-tip=回到顶部 fill=currentColor height=24 width=24><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight>Copyright © 2016 - 2025 OI Wiki Team</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs <div id=miitbeian></div> </a></div><div class=build_date_utc style=float:right><a href=https://github.com/OI-wiki/OI-wiki target=_blank> 最近更新：0ac2710d5, 2025-11-01 </a></div><script>"oi-wiki.com"!=window.location.hostname&&"www.oi-wiki.com"!=window.location.hostname||(document.getElementById("miitbeian").innerHTML='<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>'),console.log("%c OI Wiki %c 0ac2710d5 %c","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),console.log("少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org")</script></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../../..", "features": ["content.action.edit", "navigation.tabs", "navigation.instant", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.931a43a5.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script><script src=../../../assets/javascripts/bundle.73202423.min.js></script><script src="../../../assets/javascripts/oiwiki-feedback-sys-frontend.js?v=b7bb7698a49b095a295eb49d4ab6f083"></script><script src="../../../_static/js/oiwiki-feedback-sys-frontend.js?v=f5daa8d20f468272c58defe5e7ffc5c0"></script><script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then((function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)})).catch((function(e){console.log("PWA Registration failed with "+e)}))</script></body></html>